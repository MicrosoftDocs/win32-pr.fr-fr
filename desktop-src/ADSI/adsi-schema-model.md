---
title: Modèle de schéma ADSI
description: Un schéma est semblable à un dictionnaire en ce qu’il contient la définition de chaque type d’objet connu d’un service d’annuaire.
ms.assetid: 70561a11-1560-4b1c-a999-e2a7b2002ab0
ms.tgt_platform: multiple
keywords:
- ADSI (modèle de schéma ADSI)
- ADSI ADSI, à propos de, schéma
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 23eec9264ae2692952106802cc06cbad937a42a9
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/21/2020
ms.locfileid: "103941359"
---
# <a name="adsi-schema-model"></a><span data-ttu-id="0dc3f-105">Modèle de schéma ADSI</span><span class="sxs-lookup"><span data-stu-id="0dc3f-105">ADSI Schema Model</span></span>

<span data-ttu-id="0dc3f-106">Un schéma est semblable à un dictionnaire en ce qu’il contient la définition de chaque type d’objet connu d’un service d’annuaire.</span><span class="sxs-lookup"><span data-stu-id="0dc3f-106">A schema is similar to a dictionary in that it holds the definition of every type of object known to a directory service.</span></span> <span data-ttu-id="0dc3f-107">Les applications clientes ADSI peuvent parcourir un schéma pour découvrir les fonctionnalités de toute implémentation ADSI donnée.</span><span class="sxs-lookup"><span data-stu-id="0dc3f-107">ADSI client applications can browse through a schema to discover the features of any given ADSI implementation.</span></span> <span data-ttu-id="0dc3f-108">En outre, ADSI fournit des interfaces de gestion de schéma qui peuvent être utilisées pour communiquer avec le schéma sous-jacent d’un service d’annuaire.</span><span class="sxs-lookup"><span data-stu-id="0dc3f-108">In addition, ADSI supplies schema management interfaces that can be used to communicate with a directory service's underlying schema.</span></span>

<span data-ttu-id="0dc3f-109">Certains schémas sont des fournisseurs extensibles et ADSI, ou des fournisseurs tiers peuvent choisir de publier de nouvelles interfaces ou des propriétés supplémentaires pour les interfaces existantes.</span><span class="sxs-lookup"><span data-stu-id="0dc3f-109">Some schemas are extensible and ADSI providers or third-party suppliers may choose to publish new interfaces or additional properties for existing interfaces there.</span></span> <span data-ttu-id="0dc3f-110">Les clients ADSI utilisent ces données pour déterminer les fonctionnalités prises en charge pour chaque service d’annuaire.</span><span class="sxs-lookup"><span data-stu-id="0dc3f-110">ADSI clients use this data to determine what features are supported for each directory service.</span></span>

<span data-ttu-id="0dc3f-111">Il existe trois types d’objets de schéma : les classes, les propriétés et les syntaxes, chacune prenant en charge les interfaces de gestion de schéma [**IADsClass**](/windows/desktop/api/Iads/nn-iads-iadsclass), [**IADsProperty**](/windows/desktop/api/Iads/nn-iads-iadsproperty)et [**IADsSyntax**](/windows/desktop/api/Iads/nn-iads-iadssyntax).</span><span class="sxs-lookup"><span data-stu-id="0dc3f-111">There are three kinds of schema objects: classes, properties, and syntaxes, each respectively supporting the schema management interfaces [**IADsClass**](/windows/desktop/api/Iads/nn-iads-iadsclass), [**IADsProperty**](/windows/desktop/api/Iads/nn-iads-iadsproperty), and [**IADsSyntax**](/windows/desktop/api/Iads/nn-iads-iadssyntax).</span></span>

> [!Note]  
> <span data-ttu-id="0dc3f-112">La classe est un terme surchargé.</span><span class="sxs-lookup"><span data-stu-id="0dc3f-112">Class is an overloaded term.</span></span> <span data-ttu-id="0dc3f-113">Il existe des classes C++, des classes Java, des classes COM et des classes ADSI.</span><span class="sxs-lookup"><span data-stu-id="0dc3f-113">There are C++ classes, Java classes, COM classes, and ADSI classes.</span></span> <span data-ttu-id="0dc3f-114">Dans ce document, la classe Word, sauf indication contraire, fait référence à une catégorie ou un type d’objet de schéma.</span><span class="sxs-lookup"><span data-stu-id="0dc3f-114">In this document, the word class, unless otherwise qualified, refers to a category or type of schema object.</span></span>

 

<span data-ttu-id="0dc3f-115">ADSI extrait le schéma de chaque service d’annuaire et le place dans chaque nœud racine de niveau supérieur dans l’objet **namespace** .</span><span class="sxs-lookup"><span data-stu-id="0dc3f-115">ADSI abstracts the schema of every directory service and places it in every top-level root node in the **Namespace** object.</span></span> <span data-ttu-id="0dc3f-116">Pour identifier les classes prises en charge par un service d’annuaire sur un nœud racine donné, vous devez énumérer l’objet de schéma et obtenir la liste des objets de classe, des objets de propriété et des objets de syntaxe.</span><span class="sxs-lookup"><span data-stu-id="0dc3f-116">To identify what classes a directory service supports on a given root-node, you enumerate the schema object and get a list of class objects, property objects, and syntax objects.</span></span> <span data-ttu-id="0dc3f-117">Pour plus d’informations, consultez [utilisation du schéma ADSI](using-the-adsi-schema.md).</span><span class="sxs-lookup"><span data-stu-id="0dc3f-117">For more information, see [Using the ADSI Schema](using-the-adsi-schema.md).</span></span>

## <a name="adsi-ldap-provider-schema-cache"></a><span data-ttu-id="0dc3f-118">Cache du schéma du fournisseur LDAP ADSI</span><span class="sxs-lookup"><span data-stu-id="0dc3f-118">ADSI LDAP Provider Schema Cache</span></span>

<span data-ttu-id="0dc3f-119">Le fournisseur LDAP pour ADSI tente de mettre en cache les données de schéma sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="0dc3f-119">The LDAP provider for ADSI attempts to cache schema data to the local computer.</span></span> <span data-ttu-id="0dc3f-120">Un sous-schéma est identifié par un nom unique stocké dans l’attribut [**subSchemaSubEntry**](/windows/desktop/ADSchema/a-subschemasubentry) situé à la racine du RootDSE (Directory Service Enterprise).</span><span class="sxs-lookup"><span data-stu-id="0dc3f-120">A subschema is identified by a distinguished name stored in the [**subSchemaSubEntry**](/windows/desktop/ADSchema/a-subschemasubentry) attribute located in the root of the directory service enterprise (rootDSE).</span></span> <span data-ttu-id="0dc3f-121">En plus de fournir les données de sous-schéma, les serveurs LDAP v3 doivent exposer un attribut [**modifyTimeStamp**](/windows/desktop/ADSchema/a-modifytimestamp) utilisé pour déterminer l’heure de la dernière modification du schéma.</span><span class="sxs-lookup"><span data-stu-id="0dc3f-121">In addition to providing the subschema data, LDAP v3 servers should expose a [**modifyTimeStamp**](/windows/desktop/ADSchema/a-modifytimestamp) attribute that is used to determine the last time the schema was modified.</span></span>

<span data-ttu-id="0dc3f-122">Lorsque l’interface ADSI est liée pour la première fois au serveur LDAP, elle récupère les données de sous-schéma à l’aide de l’attribut [**subSchemaSubEntry**](/windows/desktop/ADSchema/a-subschemasubentry) .</span><span class="sxs-lookup"><span data-stu-id="0dc3f-122">When ADSI first binds to the LDAP server, it retrieves the subschema data using the [**subSchemaSubEntry**](/windows/desktop/ADSchema/a-subschemasubentry) attribute.</span></span> <span data-ttu-id="0dc3f-123">Si ADSI parvient à trouver l’objet de sous-schéma, il stocke un pointeur vers les données du Registre sur l’ordinateur qui se connecte au serveur LDAP.</span><span class="sxs-lookup"><span data-stu-id="0dc3f-123">If ADSI succeeds in finding the subschema object, it stores a pointer to the data in the registry on the computer that is connecting to the LDAP server.</span></span> <span data-ttu-id="0dc3f-124">Pour plus d’informations sur l’emplacement exact où ces valeurs sont stockées dans le registre, consultez [ADSI et contrôle de compte d’utilisateur](adsi-and-uac.md).</span><span class="sxs-lookup"><span data-stu-id="0dc3f-124">For information on exactly where these values are stored in the registry, see [ADSI and User Account Control](adsi-and-uac.md).</span></span>

<span data-ttu-id="0dc3f-125">ADSI tente ensuite de traiter les données de schéma et lit l’attribut [**modifyTimeStamp**](/windows/desktop/ADSchema/a-modifytimestamp) .</span><span class="sxs-lookup"><span data-stu-id="0dc3f-125">ADSI then attempts to process the schema data and reads the [**modifyTimeStamp**](/windows/desktop/ADSchema/a-modifytimestamp) attribute.</span></span> <span data-ttu-id="0dc3f-126">Si l’attribut **modifyTimeStamp** existe et que l’interface ADSI traite correctement le schéma, ADSI écrit le sous-schéma sur le disque et crée les deux valeurs de Registre suivantes sous la clé.</span><span class="sxs-lookup"><span data-stu-id="0dc3f-126">If the **modifyTimeStamp** attribute exists and ADSI successfully processes the schema, ADSI writes the subschema to disk and creates the two following registry values under the key.</span></span> <span data-ttu-id="0dc3f-127">Si les données de sous-schéma existent, mais ne peuvent pas être traitées, aucune de ces valeurs de Registre n’est créée :</span><span class="sxs-lookup"><span data-stu-id="0dc3f-127">If the subschema data exists, but cannot be processed, neither of these registry values is created:</span></span>

-   <span data-ttu-id="0dc3f-128">Valeur d' **heure** , qui contient l’attribut [**modifyTimeStamp**](/windows/desktop/ADSchema/a-modifytimestamp) .</span><span class="sxs-lookup"><span data-stu-id="0dc3f-128">A **Time** value, which contains the [**modifyTimeStamp**](/windows/desktop/ADSchema/a-modifytimestamp) attribute.</span></span> <span data-ttu-id="0dc3f-129">Cette valeur est utilisée pour garantir que les données de schéma sont actuelles et empêche le rechargement constant des données de schéma.</span><span class="sxs-lookup"><span data-stu-id="0dc3f-129">This value is used to ensure that the schema data is current and prevents the constant reloading of the schema data.</span></span>
-   <span data-ttu-id="0dc3f-130">Valeur de **fichier** qui contient le chemin d’accès à l’emplacement où ADSI stocke les données de schéma dans le système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="0dc3f-130">A **File** value, which contains the path to where ADSI stores the schema data in the file system.</span></span> <span data-ttu-id="0dc3f-131">Par défaut, ADSI met en cache le sous-schéma dans le <systemroot> \\ répertoire SchCache avec un nom de fichier correspondant au nom du serveur LDAP.</span><span class="sxs-lookup"><span data-stu-id="0dc3f-131">By default, ADSI caches the subschema in the <systemroot>\\SchCache directory with a file name corresponding to the name of the LDAP server.</span></span>

<span data-ttu-id="0dc3f-132">Si les données de sous-schéma peuvent être traitées, mais qu’aucun attribut [**modifyTimeStamp**](/windows/desktop/ADSchema/a-modifytimestamp) n’est exposé, les données de schéma sont mises en cache en mémoire, mais elles ne sont pas écrites sur le disque.</span><span class="sxs-lookup"><span data-stu-id="0dc3f-132">If the subschema data can be processed, but no [**modifyTimeStamp**](/windows/desktop/ADSchema/a-modifytimestamp) attribute is exposed, the schema data is cached in memory, but not written to disk.</span></span> <span data-ttu-id="0dc3f-133">Si un serveur LDAP v3 a été contacté par le biais d’ADSI sur l’ordinateur local et qu’un sous-schéma mis en cache n’est pas présent, il est très probable pour l’une des raisons suivantes :</span><span class="sxs-lookup"><span data-stu-id="0dc3f-133">If an LDAP v3 server has been contacted through ADSI on the local computer and a cached subschema is not present, it is most likely for one of the following reasons:</span></span>

-   <span data-ttu-id="0dc3f-134">Le serveur n’a pas exposé les propriétés correctes.</span><span class="sxs-lookup"><span data-stu-id="0dc3f-134">The server did not expose the correct properties.</span></span>
-   <span data-ttu-id="0dc3f-135">ADSI n’a pas pu traiter le schéma.</span><span class="sxs-lookup"><span data-stu-id="0dc3f-135">ADSI was unable to process the schema.</span></span>
-   <span data-ttu-id="0dc3f-136">ADSI n’a pas pu écrire le fichier dans le système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="0dc3f-136">ADSI was unable to write the file to the file system.</span></span>

 

 