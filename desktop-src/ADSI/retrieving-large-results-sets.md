---
title: Récupération de jeux de résultats volumineux
description: Lorsque le jeu de résultats qui sera renvoyé peut contenir plus de 1000 éléments, vous devez utiliser une recherche paginée.
ms.assetid: 1439d6b8-50dd-4d37-bcc9-dd0f63af865f
ms.tgt_platform: multiple
keywords:
- Récupération des ensembles de résultats volumineux (ADSI)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 78f8902d25010690953cfae8a03ff9e500b4ebda
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "106512633"
---
# <a name="retrieving-large-results-sets"></a><span data-ttu-id="9876c-104">Récupération de jeux de résultats volumineux</span><span class="sxs-lookup"><span data-stu-id="9876c-104">Retrieving Large Results Sets</span></span>

<span data-ttu-id="9876c-105">Lorsque le jeu de résultats qui sera renvoyé peut contenir plus de 1000 éléments, vous devez utiliser une recherche paginée.</span><span class="sxs-lookup"><span data-stu-id="9876c-105">When there is the possibility that the result set that will be returned will contain more than 1000 items, you must use a paged search.</span></span> <span data-ttu-id="9876c-106">Les recherches de Active Directory effectuées sans pagination sont limitées au fait de retourner un maximum de 1000 premiers enregistrements.</span><span class="sxs-lookup"><span data-stu-id="9876c-106">Searches of Active Directory performed without paging are limited to returning a maximum of the first 1000 records.</span></span> <span data-ttu-id="9876c-107">Avec une recherche paginée, le jeu de résultats est présenté sous la forme de pages individuelles, chacune contenant un nombre prédéterminé d’entrées de résultat.</span><span class="sxs-lookup"><span data-stu-id="9876c-107">With a paged search, the result set is presented as individual pages, each containing a predetermined number of result entries.</span></span> <span data-ttu-id="9876c-108">Avec ce type de recherche, de nouvelles pages d’entrées de résultats sont retournées jusqu’à ce que la fin du jeu de résultats soit atteinte.</span><span class="sxs-lookup"><span data-stu-id="9876c-108">With this type of search, new pages of result entries are returned until the end of the result set is reached.</span></span>

<span data-ttu-id="9876c-109">Par défaut, le serveur qui répond à une demande de requête calcule complètement un jeu de résultats avant de retourner des données.</span><span class="sxs-lookup"><span data-stu-id="9876c-109">By default, the server that responds to a query request completely calculates a result set before returning data.</span></span> <span data-ttu-id="9876c-110">Dans un jeu de résultats volumineux, la mémoire du serveur doit être utilisée lors de l’acquisition du jeu de résultats, et la bande passante réseau lorsque le résultat important est retourné.</span><span class="sxs-lookup"><span data-stu-id="9876c-110">In a large result set, this requires server memory as the result set is acquired, and network bandwidth when the large result is returned.</span></span> <span data-ttu-id="9876c-111">La définition d’une taille de page permet au serveur d’envoyer les données dans des pages au fur et à mesure que les pages sont générées.</span><span class="sxs-lookup"><span data-stu-id="9876c-111">Setting a page size allows the server to send the data in pages as the pages are being built.</span></span> <span data-ttu-id="9876c-112">Le client met ensuite en cache ces données et fournit un curseur au code au niveau de l’application.</span><span class="sxs-lookup"><span data-stu-id="9876c-112">The client then caches this data and provides a cursor to the application level code.</span></span> <span data-ttu-id="9876c-113">La pagination est définie en définissant le nombre de lignes que le serveur calcule avant que les données ne soient retournées sur le réseau au client.</span><span class="sxs-lookup"><span data-stu-id="9876c-113">Paging is set by defining how many rows the server calculates before the data is returned over the network to the client.</span></span>

<span data-ttu-id="9876c-114">La recherche paginée offre des avantages au client et au serveur.</span><span class="sxs-lookup"><span data-stu-id="9876c-114">Paged searching offers benefits to both the client and the server.</span></span> <span data-ttu-id="9876c-115">Par exemple, le client peut être plus réactif dans la présentation des résultats aux utilisateurs finaux.</span><span class="sxs-lookup"><span data-stu-id="9876c-115">For example, the client can be more responsive in presenting the results to end users.</span></span> <span data-ttu-id="9876c-116">Cela est particulièrement utile pour les outils d’interface utilisateur graphique qui peuvent afficher des données alors qu’un autre thread reçoit simultanément plus de données du serveur.</span><span class="sxs-lookup"><span data-stu-id="9876c-116">This is especially relevant for graphical user interface tools that can display data while another thread concurrently receives more data from the server.</span></span>

<span data-ttu-id="9876c-117">Quand vous configurez votre requête, si vous spécifiez un ordre de tri pour votre jeu de résultats, le serveur doit entièrement calculer le jeu de résultats avant de renvoyer les données au client, ce qui a un impact sur le temps de réponse de la requête.</span><span class="sxs-lookup"><span data-stu-id="9876c-117">When you set up your query, if you specify a sort order for your result set, then the server must completely calculate the result set before returning the data to the client, which impacts the response time for the query.</span></span>

<span data-ttu-id="9876c-118">Côté serveur, la recherche paginée rend l’opération évolutive.</span><span class="sxs-lookup"><span data-stu-id="9876c-118">On the server side, paged searching makes the operation scalable.</span></span> <span data-ttu-id="9876c-119">Par exemple, si les clients 100 émettent des demandes de recherche simultanément et, en moyenne, chaque client est renvoyé 200 objets, si la taille de page n’est pas spécifiée, le serveur doit disposer de suffisamment de mémoire pour contenir le jeu de résultats complet de 20 000 entrées.</span><span class="sxs-lookup"><span data-stu-id="9876c-119">For example, if one hundred clients issue search requests simultaneously and, on the average, each client is returned two hundred objects, if page size is not specified, the server must have sufficient memory to hold the complete result set of 20,000 entries.</span></span> <span data-ttu-id="9876c-120">Sinon, si chaque client a spécifié une taille de page de dix objets, les besoins en mémoire sur le serveur seront réduits de 20.</span><span class="sxs-lookup"><span data-stu-id="9876c-120">Alternately, if each client specified a page size of ten objects, the memory requirements on the server would be reduced by a factor of 20.</span></span>

> [!Note]  
> <span data-ttu-id="9876c-121">Tous les services d’annuaire ne prennent pas en charge les recherches paginées.</span><span class="sxs-lookup"><span data-stu-id="9876c-121">Not all directory services support paged searches.</span></span> <span data-ttu-id="9876c-122">Active Directory implémente l’architecture de taille de page.</span><span class="sxs-lookup"><span data-stu-id="9876c-122">Active Directory implements page size architecture.</span></span>

 

<span data-ttu-id="9876c-123">De nombreux serveurs d’annuaire spécifient une limite administrative pour le nombre maximal d’objets qu’ils peuvent retourner si un client ne spécifie pas la taille de la page.</span><span class="sxs-lookup"><span data-stu-id="9876c-123">Many directory servers specify an Administrative Limit for the maximum number of objects they can return if a client does not specify the page size.</span></span> <span data-ttu-id="9876c-124">Lorsque la limite administrative est atteinte, ADSI génère l’erreur Win32 **\_ \_ administration \_ Limit \_ a dépassé** Win32 Error.</span><span class="sxs-lookup"><span data-stu-id="9876c-124">When the Administrative Limit is reached, ADSI generates the **ERROR\_DS\_ADMIN\_LIMIT\_EXCEEDED** Win32 error.</span></span>

<span data-ttu-id="9876c-125">Côté client, une recherche paginée permet à un client d’arrêter l’opération pendant qu’elle est toujours en cours.</span><span class="sxs-lookup"><span data-stu-id="9876c-125">On the client side, a paged search allows a client to stop the operation while it is still in progress.</span></span> <span data-ttu-id="9876c-126">En revanche, dans une recherche non paginée, le client est bloqué jusqu’à ce que les données soient entièrement retournées, ou qu’une erreur se produise.</span><span class="sxs-lookup"><span data-stu-id="9876c-126">By contrast, in a non-paged search, the client is blocked until the data is completely returned, or an error occurs.</span></span> <span data-ttu-id="9876c-127">Cela peut avoir un impact sur les performances du réseau si le jeu de résultats est plus grand et prend plus de temps que prévu.</span><span class="sxs-lookup"><span data-stu-id="9876c-127">This could impact network performance if the result set turns out to be larger and takes more time than expected.</span></span>

<span data-ttu-id="9876c-128">Pour le compte du client, ADSI gère la taille de page en toute transparence.</span><span class="sxs-lookup"><span data-stu-id="9876c-128">On behalf of the client, ADSI handles the page size transparently.</span></span> <span data-ttu-id="9876c-129">Le client n’a pas besoin de compter le nombre d’objets en cours.</span><span class="sxs-lookup"><span data-stu-id="9876c-129">The client does not have to count the number of objects in progress.</span></span> <span data-ttu-id="9876c-130">ADSI encapsule l’interaction du serveur pour le client.</span><span class="sxs-lookup"><span data-stu-id="9876c-130">ADSI encapsulates the server interaction for the client.</span></span> <span data-ttu-id="9876c-131">Du point de vue du client, la recherche retourne un jeu de résultats complet.</span><span class="sxs-lookup"><span data-stu-id="9876c-131">From the client perspective, the search returns a complete result set.</span></span>

<span data-ttu-id="9876c-132">Pour plus d’informations sur l’utilisation de l’option de délai de recherche avec une interface de recherche spécifique, consultez :</span><span class="sxs-lookup"><span data-stu-id="9876c-132">For more information about using the search time out option with a specific search interface, see:</span></span>

-   [<span data-ttu-id="9876c-133">Pagination avec IDirectorySearch</span><span class="sxs-lookup"><span data-stu-id="9876c-133">Paging with IDirectorySearch</span></span>](paging-with-idirectorysearch.md)
-   [<span data-ttu-id="9876c-134">Recherche avec ActiveX Data Objects</span><span class="sxs-lookup"><span data-stu-id="9876c-134">Searching with ActiveX Data Objects</span></span>](searching-with-activex-data-objects-ado.md)
-   [<span data-ttu-id="9876c-135">Recherche avec OLE DB</span><span class="sxs-lookup"><span data-stu-id="9876c-135">Searching with OLE DB</span></span>](searching-with-ole-db.md)

<span data-ttu-id="9876c-136">Une recherche paginée est transparente pour votre application, car l’interface ADSI continue à récupérer des pages de résultats supplémentaires jusqu’à ce qu’elle atteigne la fin du jeu de résultats ou la fin de la limite de temps que vous avez définie.</span><span class="sxs-lookup"><span data-stu-id="9876c-136">A paged search is transparent to your application because ADSI automatically continues to retrieve additional pages of results until it reaches the end of the result set or the end of the time limit that you set.</span></span> <span data-ttu-id="9876c-137">Lorsque vous utilisez une recherche paginée, la limite de taille ne remplace pas la taille de la page.</span><span class="sxs-lookup"><span data-stu-id="9876c-137">When you use a paged search, the size limit does not override page size.</span></span> <span data-ttu-id="9876c-138">La limite de taille peut être utilisée uniquement lorsque vous récupérez un jeu de résultats qui contient moins de 1000 entrées.</span><span class="sxs-lookup"><span data-stu-id="9876c-138">Size limit can only be used when you retrieve a result set that contains fewer than 1000 entries.</span></span>

 

 




