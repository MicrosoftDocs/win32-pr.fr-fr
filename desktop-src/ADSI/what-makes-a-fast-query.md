---
title: Qu’est-ce qui fait une requête rapide ?
description: Cette rubrique répertorie les méthodes de programmation par défaut à utiliser lors de l’interrogation d’un répertoire.
ms.assetid: d96f330f-3c57-4edc-9fd2-970f908b54c2
ms.tgt_platform: multiple
keywords:
- Ce qui rend une requête ADSI rapide
- interroge ADSI, ce qui effectue une requête rapide
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 883db1e9de7b7b7a1179c814d6f66f774685083e
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/21/2020
ms.locfileid: "103842730"
---
# <a name="what-makes-a-fast-query"></a><span data-ttu-id="a7c9a-105">Qu’est-ce qui fait une requête rapide ?</span><span class="sxs-lookup"><span data-stu-id="a7c9a-105">What Makes a Fast Query?</span></span>

<span data-ttu-id="a7c9a-106">Tenez compte des concepts d’amélioration des performances suivants lors de l’exécution d’une requête :</span><span class="sxs-lookup"><span data-stu-id="a7c9a-106">Consider the following performance enhancement concepts when executing a query:</span></span>

-   <span data-ttu-id="a7c9a-107">Si possible, filtrez uniquement sur les attributs indexés.</span><span class="sxs-lookup"><span data-stu-id="a7c9a-107">If possible, filter on indexed attributes only.</span></span> <span data-ttu-id="a7c9a-108">Utilisez les attributs d’index dont vous vous attendez à générer le plus petit nombre d’accès.</span><span class="sxs-lookup"><span data-stu-id="a7c9a-108">Use index attributes that you expect will generate the fewest number of hits.</span></span> <span data-ttu-id="a7c9a-109">Pour plus d’informations et pour obtenir une liste complète des attributs indexés pour Windows, consultez [Active Directory schéma](/windows/desktop/ADSchema/active-directory-schema).</span><span class="sxs-lookup"><span data-stu-id="a7c9a-109">For more information and a comprehensive list of indexed attributes for Windows, see [Active Directory Schema](/windows/desktop/ADSchema/active-directory-schema).</span></span>
-   <span data-ttu-id="a7c9a-110">Recherchez **objectCategory** au lieu de **objectClass** , car **objectClass** n’est pas une propriété indexée.</span><span class="sxs-lookup"><span data-stu-id="a7c9a-110">Search on **objectCategory** instead of **objectClass** because **objectClass** is not an indexed property.</span></span>
-   <span data-ttu-id="a7c9a-111">Tenez compte des références.</span><span class="sxs-lookup"><span data-stu-id="a7c9a-111">Be aware of referrals.</span></span> <span data-ttu-id="a7c9a-112">Envisagez de rechercher le catalogue global si vos attributs sont répertoriés en tant que GC répliqué.</span><span class="sxs-lookup"><span data-stu-id="a7c9a-112">Consider searching the global catalog if your attributes are listed as GC replicated.</span></span>
-   <span data-ttu-id="a7c9a-113">Évitez de rechercher du texte au milieu et à la fin d’une chaîne.</span><span class="sxs-lookup"><span data-stu-id="a7c9a-113">Avoid searching for text in the middle and at the end of a string.</span></span> <span data-ttu-id="a7c9a-114">Par exemple, « CN = \* Hill \* » ou « CN = \* larouse ».</span><span class="sxs-lookup"><span data-stu-id="a7c9a-114">For example, "cn=\*hille\*" or "cn=\*larouse".</span></span>
-   <span data-ttu-id="a7c9a-115">Supposons qu’une recherche de sous-arborescence retourne un jeu de résultats volumineux.</span><span class="sxs-lookup"><span data-stu-id="a7c9a-115">Assume that a subtree search will return a large result set.</span></span> <span data-ttu-id="a7c9a-116">Utilisez la pagination lorsque vous effectuez des recherches sous-arborescences.</span><span class="sxs-lookup"><span data-stu-id="a7c9a-116">Use paging when performing subtree searches.</span></span> <span data-ttu-id="a7c9a-117">Le serveur sera ensuite en mesure de diffuser un grand jeu de résultats dans des segments pour réduire les ressources de mémoire côté serveur.</span><span class="sxs-lookup"><span data-stu-id="a7c9a-117">The server will then be able to stream a large result set in chunks reducing the server-side memory resources.</span></span> <span data-ttu-id="a7c9a-118">Cela aplanit efficacement l’utilisation du réseau et réduit le besoin d’envoyer des blocs de données extrêmement volumineux sur le réseau.</span><span class="sxs-lookup"><span data-stu-id="a7c9a-118">This effectively flattens out network usage and reduces the need for sending extremely large chunks of data over the network.</span></span>
-   <span data-ttu-id="a7c9a-119">Exposez correctement vos recherches afin de ne pas récupérer plus que nécessaire.</span><span class="sxs-lookup"><span data-stu-id="a7c9a-119">Properly scope your searches so as to not retrieve more than is necessary.</span></span>
-   <span data-ttu-id="a7c9a-120">Effectuez une recherche complexe sur plusieurs attributs, car elle est moins gourmande en performances que l’exécution de plusieurs recherches.</span><span class="sxs-lookup"><span data-stu-id="a7c9a-120">Perform a complex search on multiple attributes, because it is less performance intensive than performing multiple searches.</span></span> <span data-ttu-id="a7c9a-121">L’une des recherches d’un objet qui lit deux attributs est plus efficace que deux pour le même objet, chacun retournant un attribut.</span><span class="sxs-lookup"><span data-stu-id="a7c9a-121">One search for an object that reads two attributes is more efficient than two searches for the same object, each returning one attribute.</span></span>
-   <span data-ttu-id="a7c9a-122">Pour la lecture d’un attribut avec un grand nombre de valeurs, utilisez des limites de plage pour réduire la taille de la recherche afin de pouvoir lire quelques milliers de membres à la fois.</span><span class="sxs-lookup"><span data-stu-id="a7c9a-122">For reading attribute with a large number of values, use range limits to minimize the search size so that you can read a few thousand members at a time.</span></span> <span data-ttu-id="a7c9a-123">Pour plus d’informations sur la spécification des limites de plage d’attributs, consultez [récupération de plage d’attributs](attribute-range-retrieval.md).</span><span class="sxs-lookup"><span data-stu-id="a7c9a-123">For more information about specifying attribute range limits, see [Attribute Range Retrieval](attribute-range-retrieval.md).</span></span>
-   <span data-ttu-id="a7c9a-124">La liaison à un objet contient le handle de liaison pour le reste de votre session.</span><span class="sxs-lookup"><span data-stu-id="a7c9a-124">Bind to an object hold the binding handle for the remainder of your session.</span></span> <span data-ttu-id="a7c9a-125">Ne pas lier et annuler la liaison pour chaque appel.</span><span class="sxs-lookup"><span data-stu-id="a7c9a-125">Do not bind and unbind for each call.</span></span> <span data-ttu-id="a7c9a-126">Si vous utilisez ADO ou OLE DB, ne créez pas de nombreux objets de connexion.</span><span class="sxs-lookup"><span data-stu-id="a7c9a-126">If you are using ADO or OLE DB, do not create many connection objects.</span></span>
-   <span data-ttu-id="a7c9a-127">Lisez le rootDSE une fois et rappelez son contenu pour le reste de votre session.</span><span class="sxs-lookup"><span data-stu-id="a7c9a-127">Read the rootDSE once and remember its contents for the remainder of your session.</span></span>

 

 