---
title: Création et suppression d’objets
description: Avec ADSI, les objets sont créés et supprimés à l’aide de l’interface IADsContainer ou IDirectoryObject.
ms.assetid: 4d1f7ac5-48d3-4ea9-91e4-0cd4bb2ec9f8
ms.tgt_platform: multiple
keywords:
- Création et suppression d’objets ADSI
- ADSI, création et suppression d’objets
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4730c4cc6a95ad37bfd3953474d3d488fcf05abb
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/21/2020
ms.locfileid: "104463703"
---
# <a name="creating-and-deleting-objects"></a><span data-ttu-id="7b5c3-105">Création et suppression d’objets</span><span class="sxs-lookup"><span data-stu-id="7b5c3-105">Creating and Deleting Objects</span></span>

<span data-ttu-id="7b5c3-106">Avec ADSI, les objets sont créés et supprimés à l’aide de l’interface [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) ou [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) .</span><span class="sxs-lookup"><span data-stu-id="7b5c3-106">With ADSI, objects are created and deleted using either the [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) or [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) interface.</span></span>

## <a name="creating-an-object-with-iadscontainer"></a><span data-ttu-id="7b5c3-107">Création d’un objet avec IADsContainer</span><span class="sxs-lookup"><span data-stu-id="7b5c3-107">Creating an Object with IADsContainer</span></span>

<span data-ttu-id="7b5c3-108">**Pour créer un objet avec l’interface IADsContainer**</span><span class="sxs-lookup"><span data-stu-id="7b5c3-108">**To create an object with the IADsContainer interface**</span></span>

1.  <span data-ttu-id="7b5c3-109">Créez une liaison avec le conteneur qui contiendra l’objet à créer et obtenez l’interface [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) .</span><span class="sxs-lookup"><span data-stu-id="7b5c3-109">Bind to the container that will contain the object to be created and obtain the [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) interface.</span></span>
2.  <span data-ttu-id="7b5c3-110">Utilisez la méthode [**IADsContainer. Create**](/windows/desktop/api/Iads/nf-iads-iadscontainer-create) pour créer un nouvel objet dans le conteneur.</span><span class="sxs-lookup"><span data-stu-id="7b5c3-110">Use the [**IADsContainer.Create**](/windows/desktop/api/Iads/nf-iads-iadscontainer-create) method to create a new object in the container.</span></span>
3.  <span data-ttu-id="7b5c3-111">Définissez les valeurs de tous les attributs requis pour l’objet à l’aide de la méthode [**IADs. put**](/windows/desktop/api/Iads/nf-iads-iads-put) ou [**IADs.**](/windows/desktop/api/Iads/nf-iads-iads-putex) placent.</span><span class="sxs-lookup"><span data-stu-id="7b5c3-111">Set the values for all of the required attributes for the object using the [**IADs.Put**](/windows/desktop/api/Iads/nf-iads-iads-put) or [**IADs.PutEx**](/windows/desktop/api/Iads/nf-iads-iads-putex) method.</span></span> <span data-ttu-id="7b5c3-112">Les attributs requis pour créer un objet dépendent du service d’annuaire et du type d’objet créé.</span><span class="sxs-lookup"><span data-stu-id="7b5c3-112">The attributes required to create an object will depend on the directory service and the type of object created.</span></span> <span data-ttu-id="7b5c3-113">Pour plus d’informations sur la création d’objets Active Directory, consultez [création et suppression](/windows/desktop/AD/creating-and-deleting-objects-in-active-directory-domain-services)d’objets Active Directory.</span><span class="sxs-lookup"><span data-stu-id="7b5c3-113">For more information about creating Active Directory objects, see [Creating and Deleting Active Directory Objects](/windows/desktop/AD/creating-and-deleting-objects-in-active-directory-domain-services).</span></span>
4.  <span data-ttu-id="7b5c3-114">Définissez les valeurs de tous les attributs facultatifs souhaités pour l’objet à l’aide de la méthode [**IADs. put**](/windows/desktop/api/Iads/nf-iads-iads-put) ou [**IADs.**](/windows/desktop/api/Iads/nf-iads-iads-putex) préférences.</span><span class="sxs-lookup"><span data-stu-id="7b5c3-114">Set the values for all of the desired optional attributes for the object using the [**IADs.Put**](/windows/desktop/api/Iads/nf-iads-iads-put) or [**IADs.PutEx**](/windows/desktop/api/Iads/nf-iads-iads-putex) method.</span></span>
5.  <span data-ttu-id="7b5c3-115">Appelez la méthode [**IADs. setinfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) pour valider l’objet et ses attributs.</span><span class="sxs-lookup"><span data-stu-id="7b5c3-115">Call the [**IADs.SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) method to commit the object and its attributes.</span></span> <span data-ttu-id="7b5c3-116">Le nouvel objet n’est pas réellement créé dans le service d’annuaire sous-jacent tant que la méthode **IADs. setinfo** n’a pas été appelée pour valider les attributs.</span><span class="sxs-lookup"><span data-stu-id="7b5c3-116">The new object is not actually created in the underlying directory service until the **IADs.SetInfo** method is called to commit the attributes.</span></span>

## <a name="creating-an-object-with-idirectoryobject"></a><span data-ttu-id="7b5c3-117">Création d’un objet avec IDirectoryObject</span><span class="sxs-lookup"><span data-stu-id="7b5c3-117">Creating an Object with IDirectoryObject</span></span>

<span data-ttu-id="7b5c3-118">**Pour créer un objet avec l’interface IDirectoryObject**</span><span class="sxs-lookup"><span data-stu-id="7b5c3-118">**To create an object with the IDirectoryObject interface**</span></span>

1.  <span data-ttu-id="7b5c3-119">Créez une liaison avec le conteneur qui contiendra l’objet à créer et obtenez l’interface [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) .</span><span class="sxs-lookup"><span data-stu-id="7b5c3-119">Bind to the container that will contain the object to be created and obtain the [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) interface.</span></span>
2.  <span data-ttu-id="7b5c3-120">Allouez un tableau de structures d' [**\_ \_ informations attr ADS**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) qui contient une structure pour chaque attribut à définir lors de la création de l’objet.</span><span class="sxs-lookup"><span data-stu-id="7b5c3-120">Allocate an array of [**ADS\_ATTR\_INFO**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) structures that contains one structure for each attribute to be set when the object is created.</span></span>
3.  <span data-ttu-id="7b5c3-121">Remplissez une structure [**d' \_ \_ informations attr ADS**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) pour chaque attribut requis de l’objet.</span><span class="sxs-lookup"><span data-stu-id="7b5c3-121">Fill in an [**ADS\_ATTR\_INFO**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) structure for each required attribute for the object.</span></span> <span data-ttu-id="7b5c3-122">Les attributs requis pour créer un objet dépendent du service d’annuaire et du type d’objet créé.</span><span class="sxs-lookup"><span data-stu-id="7b5c3-122">The attributes required to create an object will depend on the directory service and the type of object created.</span></span> <span data-ttu-id="7b5c3-123">Pour plus d’informations sur la création d’objets Active Directory, consultez [création et suppression](/windows/desktop/AD/creating-and-deleting-objects-in-active-directory-domain-services)d’objets Active Directory.</span><span class="sxs-lookup"><span data-stu-id="7b5c3-123">For more information about creating Active Directory objects, see [Creating and Deleting Active Directory Objects](/windows/desktop/AD/creating-and-deleting-objects-in-active-directory-domain-services).</span></span>
4.  <span data-ttu-id="7b5c3-124">Remplissez une structure [**d' \_ \_ informations attr ADS**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) pour chaque attribut facultatif de l’objet.</span><span class="sxs-lookup"><span data-stu-id="7b5c3-124">Fill in an [**ADS\_ATTR\_INFO**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) structure for each optional attribute for the object.</span></span>
5.  <span data-ttu-id="7b5c3-125">Utilisez la méthode [**IDirectoryObject :: CreateDSObject**](/windows/desktop/api/Iads/nf-iads-idirectoryobject-createdsobject) pour créer l’objet dans le conteneur.</span><span class="sxs-lookup"><span data-stu-id="7b5c3-125">Use the [**IDirectoryObject::CreateDSObject**](/windows/desktop/api/Iads/nf-iads-idirectoryobject-createdsobject) method to create the object in the container.</span></span> <span data-ttu-id="7b5c3-126">Cette méthode valide également l’objet dans le service d’annuaire sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="7b5c3-126">This method also commits the object to the underlying directory service.</span></span> <span data-ttu-id="7b5c3-127">Si le tableau d' [**\_ \_ informations attr ADS**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) ne contient pas tous les attributs requis pour l’objet, **IDirectoryObject :: CreateDSObject** échoue.</span><span class="sxs-lookup"><span data-stu-id="7b5c3-127">If the [**ADS\_ATTR\_INFO**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) array does not contain all of the required attributes for the object, **IDirectoryObject::CreateDSObject** will fail.</span></span>

## <a name="deleting-an-object"></a><span data-ttu-id="7b5c3-128">Suppression d’un objet</span><span class="sxs-lookup"><span data-stu-id="7b5c3-128">Deleting an Object</span></span>

<span data-ttu-id="7b5c3-129">Pour supprimer un objet, utilisez la méthode [**IADsContainer ::D supprim**](/windows/desktop/api/Iads/nf-iads-iadscontainer-delete) ou [**IDirectoryObject ::D eletedsobject**](/windows/desktop/api/Iads/nf-iads-idirectoryobject-deletedsobject) .</span><span class="sxs-lookup"><span data-stu-id="7b5c3-129">To delete an object use the [**IADsContainer::Delete**](/windows/desktop/api/Iads/nf-iads-iadscontainer-delete) or the [**IDirectoryObject::DeleteDSObject**](/windows/desktop/api/Iads/nf-iads-idirectoryobject-deletedsobject) method.</span></span> <span data-ttu-id="7b5c3-130">Ces méthodes échouent si l’objet supprimé contient des objets enfants.</span><span class="sxs-lookup"><span data-stu-id="7b5c3-130">These methods will fail if the deleted object contains any child objects.</span></span> <span data-ttu-id="7b5c3-131">Utilisez la méthode [**IADsDeleteOps ::D eleteobject**](/windows/desktop/api/Iads/nf-iads-iadsdeleteops-deleteobject) pour supprimer un conteneur et tous les objets enfants du conteneur.</span><span class="sxs-lookup"><span data-stu-id="7b5c3-131">Use the [**IADsDeleteOps::DeleteObject**](/windows/desktop/api/Iads/nf-iads-iadsdeleteops-deleteobject) method to delete a container and all of the container's child objects.</span></span>

<span data-ttu-id="7b5c3-132">Ce qui arrive à un objet supprimé dépend du service d’annuaire sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="7b5c3-132">What happens to a deleted object depends on the underlying directory service.</span></span> <span data-ttu-id="7b5c3-133">Pour plus d’informations sur la suppression d’objets Active Directory, consultez [création et suppression](/windows/desktop/AD/creating-and-deleting-objects-in-active-directory-domain-services)d’objets Active Directory.</span><span class="sxs-lookup"><span data-stu-id="7b5c3-133">For more information about deleting Active Directory objects, see [Creating and Deleting Active Directory Objects](/windows/desktop/AD/creating-and-deleting-objects-in-active-directory-domain-services).</span></span>

 

 