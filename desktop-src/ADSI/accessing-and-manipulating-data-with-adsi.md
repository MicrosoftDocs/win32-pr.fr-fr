---
title: Accès et manipulation de données avec ADSI
description: Tous les objets ont des propriétés.
ms.assetid: 366a1fbc-3089-406a-9819-cf2ba7636c5f
ms.tgt_platform: multiple
keywords:
- ADSI ADSI, accès et manipulation des données
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b3291db7490c79aae6363f619582ed24339fb83d
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/21/2020
ms.locfileid: "106511713"
---
# <a name="accessing-and-manipulating-data-with-adsi"></a><span data-ttu-id="e06c0-104">Accès et manipulation de données avec ADSI</span><span class="sxs-lookup"><span data-stu-id="e06c0-104">Accessing and Manipulating Data with ADSI</span></span>

<span data-ttu-id="e06c0-105">Tous les objets ont des propriétés.</span><span class="sxs-lookup"><span data-stu-id="e06c0-105">All objects have properties.</span></span> <span data-ttu-id="e06c0-106">Tous les objets COM de l’interface de service Active Directory (ADSI) possèdent une ou plusieurs interfaces avec des méthodes qui récupèrent les propriétés de l’objet d’annuaire représenté par l’objet COM.</span><span class="sxs-lookup"><span data-stu-id="e06c0-106">All Active Directory Service Interface (ADSI) COM objects have one or more interfaces with methods that retrieve the properties of the directory object that the COM object represents.</span></span> <span data-ttu-id="e06c0-107">Vous pouvez lire les propriétés d’un objet de plusieurs façons :</span><span class="sxs-lookup"><span data-stu-id="e06c0-107">There are a number of ways you can read properties from an object:</span></span>

-   <span data-ttu-id="e06c0-108">Obtenir une propriété spécifique par nom : l’interface [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) a deux méthodes [**IADs :: obten**](/windows/desktop/api/Iads/nf-iads-iads-get) et [**IADs :: GETEX**](/windows/desktop/api/Iads/nf-iads-iads-getex) pour lire une propriété spécifique.</span><span class="sxs-lookup"><span data-stu-id="e06c0-108">Get a specific property by name: The [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) interface has two methods [**IADs::Get**](/windows/desktop/api/Iads/nf-iads-iads-get) and [**IADs::GetEx**](/windows/desktop/api/Iads/nf-iads-iads-getex) to read a specific property.</span></span> <span data-ttu-id="e06c0-109">Chaque objet COM ADSI a une interface **IADs** .</span><span class="sxs-lookup"><span data-stu-id="e06c0-109">Every ADSI COM object has an **IADs** interface.</span></span>
-   <span data-ttu-id="e06c0-110">Obtient une liste de propriétés spécifiée : l’interface [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) a la méthode [**IDirectoryObject :: GetObjectAttributes**](/windows/desktop/api/Iads/nf-iads-idirectoryobject-getobjectattributes) qui vous permet de spécifier une liste contenant les noms des propriétés à lire et de retourner un tableau de structures contenant les valeurs de propriété demandées.</span><span class="sxs-lookup"><span data-stu-id="e06c0-110">Get a specified list of properties: The [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) interface has the method [**IDirectoryObject::GetObjectAttributes**](/windows/desktop/api/Iads/nf-iads-idirectoryobject-getobjectattributes) that allows you to specify a list containing the names of the properties to read and returns an array of structures containing the requested property values.</span></span>
-   <span data-ttu-id="e06c0-111">Énumérer toutes les propriétés de l’objet : l’interface [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist) vous permet d’énumérer toutes les propriétés sur un objet.</span><span class="sxs-lookup"><span data-stu-id="e06c0-111">Enumerate all properties on the object: The [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist) interface allows you to enumerate all the properties on an object.</span></span>
-   <span data-ttu-id="e06c0-112">Obtenir des propriétés spéciales : les interfaces d’automatisation ([**IADs**](/windows/desktop/api/Iads/nn-iads-iads) \* ) ont des méthodes de propriété qui vous permettent d’obtenir des propriétés spéciales qui ne sont pas stockées dans un objet.</span><span class="sxs-lookup"><span data-stu-id="e06c0-112">Get special properties: The Automation interfaces ([**IADs**](/windows/desktop/api/Iads/nn-iads-iads)\*) have property methods that allow you to get special properties that are not stored in an object.</span></span> <span data-ttu-id="e06c0-113">Ou les méthodes de propriété peuvent vous permettre d’obtenir une propriété d’objet dans un format de données qui diffère du type de données réel stocké.</span><span class="sxs-lookup"><span data-stu-id="e06c0-113">Or the property methods may allow you to get an object property in a data format that differs from the actual data type stored.</span></span> <span data-ttu-id="e06c0-114">Par exemple, l’interface **IADs** a des méthodes de propriété telles que [**IADs :: obtenir le \_ nom**](iads-property-methods.md), qui récupère le nom unique relatif (RDN) d’un objet ; **IADs :: obtient \_ Classe**, qui récupère la classe d’un objet et **IADs :: obtenir le \_ parent**, qui récupère l’ADsPath sur le parent de l’objet.</span><span class="sxs-lookup"><span data-stu-id="e06c0-114">For example, the **IADs** interface has property methods such as [**IADs::get\_Name**](iads-property-methods.md), which retrieves an object's relative distinguished name (RDN); **IADs::get\_Class**, which retrieves an object's class, and **IADs::get\_Parent**, which retrieves the ADsPath to the object's parent.</span></span>

<span data-ttu-id="e06c0-115">ADSI vous permet de mettre en cache les propriétés localement après qu’elles ont été lues à partir du serveur d’annuaire.</span><span class="sxs-lookup"><span data-stu-id="e06c0-115">ADSI allows you to cache properties locally after they have been read from the directory server.</span></span> <span data-ttu-id="e06c0-116">Cela vous permet de choisir de lire les propriétés à partir du cache de propriétés local ou de récupérer les propriétés directement à partir du serveur d’annuaire.</span><span class="sxs-lookup"><span data-stu-id="e06c0-116">This allows you a choice of reading the properties from the local property cache or retrieving the properties directly from the directory server.</span></span> <span data-ttu-id="e06c0-117">ADSI possède également des méthodes pour mettre à jour le cache et spécifier si toutes les propriétés d’un objet sont mises en cache ou uniquement celles que vous avez spécifiées.</span><span class="sxs-lookup"><span data-stu-id="e06c0-117">ADSI also has methods to update the cache as well as specifying whether all properties for an object are cached or just those you have specified.</span></span>

<span data-ttu-id="e06c0-118">Une fois que vous avez récupéré une propriété, vous devez lire sa valeur.</span><span class="sxs-lookup"><span data-stu-id="e06c0-118">After you have retrieved a property, you read its value.</span></span> <span data-ttu-id="e06c0-119">Le type de données d’une propriété dépend de la définition de la propriété (également appelée attribut) dans le schéma Active Directory.</span><span class="sxs-lookup"><span data-stu-id="e06c0-119">The data type of a property depends on the definition of the property (also known as an attribute) in the Active Directory schema.</span></span> <span data-ttu-id="e06c0-120">Pour chaque type de propriété qui peut exister dans Active Directory, il existe un objet **attributeSchema** dans le schéma Active Directory.</span><span class="sxs-lookup"><span data-stu-id="e06c0-120">For each type of property that can exist in Active Directory, there is an **attributeSchema** object in the Active Directory schema.</span></span> <span data-ttu-id="e06c0-121">Un objet **attributeSchema** définit les caractéristiques de l’attribut.</span><span class="sxs-lookup"><span data-stu-id="e06c0-121">An **attributeSchema** object defines the characteristics of the attribute.</span></span> <span data-ttu-id="e06c0-122">L’une de ces caractéristiques est la syntaxe de l’attribut, qui détermine le type de données des valeurs de l’attribut.</span><span class="sxs-lookup"><span data-stu-id="e06c0-122">One of these characteristics is the attribute's syntax, which determines the data type of the attribute's values.</span></span> <span data-ttu-id="e06c0-123">Pour plus d’informations, consultez [caractéristiques des attributs](/windows/desktop/AD/characteristics-of-attributes) et des [syntaxes pour les attributs Active Directory](/windows/desktop/AD/syntaxes-for-attributes-in-active-directory-domain-services).</span><span class="sxs-lookup"><span data-stu-id="e06c0-123">For more information, see [Characteristics of Attributes](/windows/desktop/AD/characteristics-of-attributes) and [Syntaxes for Active Directory Attributes](/windows/desktop/AD/syntaxes-for-attributes-in-active-directory-domain-services).</span></span>

<span data-ttu-id="e06c0-124">Les interfaces d’automatisation ([**IADs**](/windows/desktop/api/Iads/nn-iads-iads) \* ) retournent une valeur de propriété sous la forme d’un [**Variant**](/windows/win32/api/oaidl/ns-oaidl-variant) ou d’un pointeur vers une interface Automation sur un objet com qui représente la propriété.</span><span class="sxs-lookup"><span data-stu-id="e06c0-124">The Automation interfaces ([**IADs**](/windows/desktop/api/Iads/nn-iads-iads)\*) return a property value as a [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) or a pointer to an Automation interface on a COM object that represents the property.</span></span> <span data-ttu-id="e06c0-125">Les interfaces [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) et [**IDirectorySearch**](/windows/desktop/api/Iads/nn-iads-idirectorysearch) retournent une propriété en tant que pointeur vers une structure contenant une valeur de propriété typée ou un pointeur vers une chaîne d’octets.</span><span class="sxs-lookup"><span data-stu-id="e06c0-125">The [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) and [**IDirectorySearch**](/windows/desktop/api/Iads/nn-iads-idirectorysearch) interfaces return a property as a pointer to a structure containing a typed property value or a pointer to a string of bytes.</span></span> <span data-ttu-id="e06c0-126">En outre, **IDirectoryObject** et **IDirectorySearch** récupèrent les propriétés directement à partir du serveur d’annuaire au lieu d’utiliser un cache de propriétés local.</span><span class="sxs-lookup"><span data-stu-id="e06c0-126">In addition, **IDirectoryObject** and **IDirectorySearch** retrieve properties directly from the directory server instead of using a local property cache.</span></span>

<span data-ttu-id="e06c0-127">Cette section décrit les rubriques suivantes :</span><span class="sxs-lookup"><span data-stu-id="e06c0-127">This section describes the following topics:</span></span>

-   [<span data-ttu-id="e06c0-128">Les interfaces IADs et IDirectoryObject</span><span class="sxs-lookup"><span data-stu-id="e06c0-128">The IADs and IDirectoryObject Interfaces</span></span>](the-iads-and-idirectoryobject-interfaces.md)
-   [<span data-ttu-id="e06c0-129">Accès aux attributs avec ADSI</span><span class="sxs-lookup"><span data-stu-id="e06c0-129">Accessing Attributes with ADSI</span></span>](accessing-attributes-with-adsi.md)
-   [<span data-ttu-id="e06c0-130">Modification d’attributs avec ADSI</span><span class="sxs-lookup"><span data-stu-id="e06c0-130">Modifying Attributes with ADSI</span></span>](modifying-attributes-with-adsi.md)
-   [<span data-ttu-id="e06c0-131">Accès au cache de propriété directement avec les interfaces IADsProperty</span><span class="sxs-lookup"><span data-stu-id="e06c0-131">Accessing the Property Cache Directly with the IADsProperty Interfaces</span></span>](accessing-the-property-cache-directly-with-the-iadsproperty-interfaces.md)
-   [<span data-ttu-id="e06c0-132">Syntaxe d’attribut ADSI</span><span class="sxs-lookup"><span data-stu-id="e06c0-132">ADSI Attribute Syntax</span></span>](adsi-attribute-syntax.md)

 

 