---
title: Problèmes d’implémentation pour les fournisseurs ADSI
description: Problèmes d’implémentation pour les fournisseurs ADSI
ms.assetid: 0be772aa-e7d8-4d34-b55a-162abfb0bfd4
ms.tgt_platform: multiple
keywords:
- Problèmes d’implémentation pour les fournisseurs ADSI ADSI
- fournisseurs ADSI, implémenter
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c4c362b04244580e448e7bb7bd78889e66db12fe
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/21/2020
ms.locfileid: "104382876"
---
# <a name="implementation-issues-for-adsi-providers"></a><span data-ttu-id="2360c-105">Problèmes d’implémentation pour les fournisseurs ADSI</span><span class="sxs-lookup"><span data-stu-id="2360c-105">Implementation Issues for ADSI Providers</span></span>

<span data-ttu-id="2360c-106">Pour implémenter des interfaces ADSI, commencez par implémenter l’interface COM [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject).</span><span class="sxs-lookup"><span data-stu-id="2360c-106">To implement ADSI interfaces, first implement the COM interface [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject).</span></span> <span data-ttu-id="2360c-107">En fournissant cette interface comme couche de surcharge minimale, vous fournissez aux applications clientes le contrôle requis pour accéder aux objets d’annuaire directement à partir de l’annuaire plutôt que via le cache ADSI, ce qui optimise les performances du réseau.</span><span class="sxs-lookup"><span data-stu-id="2360c-107">By providing this interface as a minimal overhead layer, you supply client applications the control required to access directory objects directly from the directory rather than through the ADSI cache, which optimizes network performance.</span></span> <span data-ttu-id="2360c-108">L’utilisation de cette interface fournira également votre propre implémentation avec la plus grande flexibilité.</span><span class="sxs-lookup"><span data-stu-id="2360c-108">Using this interface will also supply your own implementation with the most flexibility.</span></span>

<span data-ttu-id="2360c-109">Ensuite, implémentez les interfaces ADSI fondamentales, [**IADs**](/windows/desktop/api/Iads/nn-iads-iads), [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer), [**IADsCollection**](/windows/desktop/api/Iads/nn-iads-iadscollection)et les interfaces du cache de propriétés [**IADsPropertyValue**](/windows/desktop/api/Iads/nn-iads-iadspropertyvalue), [**IADsPropertyEntry**](/windows/desktop/api/Iads/nn-iads-iadspropertyentry), [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist) .</span><span class="sxs-lookup"><span data-stu-id="2360c-109">Second, implement the fundamental ADSI interfaces, [**IADs**](/windows/desktop/api/Iads/nn-iads-iads), [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer), [**IADsCollection**](/windows/desktop/api/Iads/nn-iads-iadscollection), and the [**IADsPropertyValue**](/windows/desktop/api/Iads/nn-iads-iadspropertyvalue), [**IADsPropertyEntry**](/windows/desktop/api/Iads/nn-iads-iadspropertyentry), [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist) property cache interfaces.</span></span> <span data-ttu-id="2360c-110">[**IADsGroup**](/windows/desktop/api/Iads/nn-iads-iadsgroup) et [**IADsMembers**](/windows/desktop/api/Iads/nn-iads-iadsmembers) sont également des interfaces fréquemment sollicitées par les logiciels d’administration de système.</span><span class="sxs-lookup"><span data-stu-id="2360c-110">[**IADsGroup**](/windows/desktop/api/Iads/nn-iads-iadsgroup) and [**IADsMembers**](/windows/desktop/api/Iads/nn-iads-iadsmembers) are also interfaces in frequent demand by system administration software.</span></span>

<span data-ttu-id="2360c-111">Troisièmement, implémentez les interfaces de gestion de schéma si votre service d’annuaire a un schéma sous-jacent : [**IADsClass**](/windows/desktop/api/Iads/nn-iads-iadsclass), [**IADsProperty**](/windows/desktop/api/Iads/nn-iads-iadsproperty), [**IADsSyntax**](/windows/desktop/api/Iads/nn-iads-iadssyntax).</span><span class="sxs-lookup"><span data-stu-id="2360c-111">Third, implement the schema management interfaces if your directory service has an underlying schema: [**IADsClass**](/windows/desktop/api/Iads/nn-iads-iadsclass), [**IADsProperty**](/windows/desktop/api/Iads/nn-iads-iadsproperty), [**IADsSyntax**](/windows/desktop/api/Iads/nn-iads-iadssyntax).</span></span> <span data-ttu-id="2360c-112">S’il n’existe pas de schéma sous-jacent, utilisez ces interfaces pour extraire les classes et les propriétés utilisées par le service d’annuaire.</span><span class="sxs-lookup"><span data-stu-id="2360c-112">If there is no underlying schema, use these interfaces to abstract the classes and properties used by the directory service.</span></span> <span data-ttu-id="2360c-113">Les schémas peuvent être utilisés pour publier les fonctionnalités de votre service d’annuaire sur les clients ADSI.</span><span class="sxs-lookup"><span data-stu-id="2360c-113">Schemas can be used to publish the features of your directory service to ADSI clients.</span></span>

## <a name="collections"></a><span data-ttu-id="2360c-114">Regroupements</span><span class="sxs-lookup"><span data-stu-id="2360c-114">Collections</span></span>

<span data-ttu-id="2360c-115">Les composants du fournisseur ADSI peuvent suivre l’un des trois modèles pour la mise en cache des collections pendant l’énumération.</span><span class="sxs-lookup"><span data-stu-id="2360c-115">ADSI provider components can follow one of three models for caching collections during enumeration.</span></span> <span data-ttu-id="2360c-116">Le choix d’un modèle de mise en cache détermine le comportement d’ADSI lorsqu’un objet d’une collection est supprimé du service d’annuaire sous-jacent externe à ADSI.</span><span class="sxs-lookup"><span data-stu-id="2360c-116">The choice of a caching model determines the behavior of ADSI when an object in a collection is deleted from the underlying directory service external to ADSI.</span></span>

<span data-ttu-id="2360c-117">Les modèles de mise en cache sont les suivants :</span><span class="sxs-lookup"><span data-stu-id="2360c-117">The caching models include:</span></span>

-   <span data-ttu-id="2360c-118">Collections mises en cache à l’avance.</span><span class="sxs-lookup"><span data-stu-id="2360c-118">Collections cached in advance.</span></span> <span data-ttu-id="2360c-119">La collection d’instances d’objet est récupérée à partir du service d’annuaire sous-jacent dans son intégralité quand [**IADsCollection :: obtenir \_ \_ NewEnum**](/windows/desktop/api/Iads/nf-iads-iadscollection-get__newenum) est appelé pour créer un nouvel objet énumérateur.</span><span class="sxs-lookup"><span data-stu-id="2360c-119">The collection of object instances is retrieved from the underlying directory service in its entirety when [**IADsCollection::get\_\_NewEnum**](/windows/desktop/api/Iads/nf-iads-iadscollection-get__newenum) is called to create a new enumerator object.</span></span> <span data-ttu-id="2360c-120">Si l’objet source d’une instance d’objet Active Directory dans la collection Récupérée est supprimé du service d’annuaire sous-jacent, le client ne reconnaît pas la suppression tant qu’un [**IADs :: GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) ou [**IADs :: setinfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) ne tente pas d’accéder à la collection.</span><span class="sxs-lookup"><span data-stu-id="2360c-120">If the source object for an Active Directory object instance in the retrieved collection is deleted from the underlying directory service, the client does not recognize the deletion until a [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) or [**IADs::SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) attempts to access the collection.</span></span>
-   <span data-ttu-id="2360c-121">Collections mises en cache de façon incrémentielle.</span><span class="sxs-lookup"><span data-stu-id="2360c-121">Collections incrementally cached.</span></span> <span data-ttu-id="2360c-122">La collection est récupérée à partir du service d’annuaire sous-jacent, un objet à la fois lorsque [**IEnumVARIANT :: Next**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-next) est appelé.</span><span class="sxs-lookup"><span data-stu-id="2360c-122">The collection is retrieved from the underlying directory service one object at a time when [**IEnumVARIANT::Next**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-next) is called.</span></span> <span data-ttu-id="2360c-123">[**IEnumVARIANT :: Reset**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-reset) retourne au début de la collection dans le cache et **IEnumVARIANT :: Next** retourne les objets mis en cache jusqu’à ce que la fin du cache soit atteinte. les nouveaux objets sont alors ajoutés à partir du magasin sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="2360c-123">[**IEnumVARIANT::Reset**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-reset) will return to the beginning of the collection in the cache and **IEnumVARIANT::Next** will return cached objects until the end of the cache is reached, at which point new objects will be added from the underlying store.</span></span> <span data-ttu-id="2360c-124">Lorsqu’une instance d’objet Active Directory se trouve dans le cache, le client ne prend pas connaissance de sa suppression du service d’annuaire sous-jacent jusqu’à ce qu’un [**IADs :: GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) ou [**IADs :: setinfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) tente d’accéder à l’objet.</span><span class="sxs-lookup"><span data-stu-id="2360c-124">When an Active Directory object instance is in the cache the client will not become aware of its deletion from the underlying directory service until an [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) or [**IADs::SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) attempts to access the object.</span></span>
-   <span data-ttu-id="2360c-125">Collections non mises en cache.</span><span class="sxs-lookup"><span data-stu-id="2360c-125">Collections not cached.</span></span> <span data-ttu-id="2360c-126">La collection est récupérée à partir du service d’annuaire sous-jacent, un objet à la fois lorsque [**IEnumVARIANT :: Next**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-next) est appelé.</span><span class="sxs-lookup"><span data-stu-id="2360c-126">The collection is retrieved from the underlying directory service one object at a time when [**IEnumVARIANT::Next**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-next) is called.</span></span> <span data-ttu-id="2360c-127">[**IEnumVARIANT :: Reset**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-reset) retourne au début de la collection dans le magasin sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="2360c-127">[**IEnumVARIANT::Reset**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-reset) will return to the beginning of the collection in the underlying store.</span></span> <span data-ttu-id="2360c-128">**IEnumVARIANT :: Next** et **IEnumVARIANT :: Reset** Operations ne peuvent pas récupérer les objets supprimés, car les objets sont récupérés à la demande à partir du service d’annuaire sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="2360c-128">**IEnumVARIANT::Next** and **IEnumVARIANT::Reset** operations cannot retrieve deleted objects, because the objects are retrieved on-demand from the underlying directory service.</span></span> <span data-ttu-id="2360c-129">Seul l’objet actuel est mis en cache ; Si l’objet actuel est supprimé, le client ne prend pas connaissance de sa suppression du service d’annuaire sous-jacent jusqu’à ce qu’un [**IADs :: GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) ou [**IADs :: setinfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) tente d’accéder à l’objet.</span><span class="sxs-lookup"><span data-stu-id="2360c-129">Only the current object is cached; if the current object is deleted, the client will not become aware of its deletion from the underlying directory service until a [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) or [**IADs::SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) attempts to access the object.</span></span>

<span data-ttu-id="2360c-130">Quel que soit le modèle de mise en cache, sachez que l’énumération ADSI retourne Active Directory interfaces de service à l’appelant.</span><span class="sxs-lookup"><span data-stu-id="2360c-130">Regardless of the caching model, be aware that ADSI enumeration returns Active Directory service interfaces to the caller.</span></span> <span data-ttu-id="2360c-131">Pour éviter la surcharge liée à l’obtention d’un nouveau pointeur d’interface, les applications ADSI doivent mettre en cache les pointeurs d’interface renvoyés pour les objets qu’ils envisagent de manipuler.</span><span class="sxs-lookup"><span data-stu-id="2360c-131">To avoid the overhead of obtaining a new interface pointer, ADSI applications should cache the returned interface pointers for objects that they intend to manipulate.</span></span> <span data-ttu-id="2360c-132">Par exemple, une Visual Basic application qui énumère un conteneur et remplit une zone de liste avec des noms peut mettre en cache les pointeurs d’interface associés aux noms pour une utilisation ultérieure.</span><span class="sxs-lookup"><span data-stu-id="2360c-132">For example, a Visual Basic application that enumerates a container and populates a list box with names can cache the interface pointers associated with the names for later use.</span></span> <span data-ttu-id="2360c-133">Cette approche offre de meilleures performances que le remplissage de la zone de liste pendant l’énumération et l’obtention d’un nouveau pointeur d’interface lorsque l’utilisateur effectue une sélection.</span><span class="sxs-lookup"><span data-stu-id="2360c-133">This approach will provide greater performance than populating the list box during enumeration and obtaining a new interface pointer when the user makes a selection.</span></span>

## <a name="about-dispatch-ids"></a><span data-ttu-id="2360c-134">À propos des ID de dispatch</span><span class="sxs-lookup"><span data-stu-id="2360c-134">About Dispatch IDs</span></span>

<span data-ttu-id="2360c-135">[**IDispatch**](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface) est une interface d’automatisation définie par com pour les contrôleurs qui n’utilisent pas directement les interfaces com.</span><span class="sxs-lookup"><span data-stu-id="2360c-135">[**IDispatch**](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface) is an Automation interface defined by COM for controllers that do not use COM interfaces directly.</span></span> <span data-ttu-id="2360c-136">L’accès à un objet via **IDispatch** est appelé accès lié au nom ou à liaison tardive, car il se produit au moment de l’exécution (« tardif ») et utilise des noms de chaîne de propriétés et de méthodes pour résoudre les références (« Name »).</span><span class="sxs-lookup"><span data-stu-id="2360c-136">Accessing an object through **IDispatch** is called name-bound or late-bound access, because it occurs at run time ("late") and uses string names of properties and methods to resolve references ("name").</span></span> <span data-ttu-id="2360c-137">Au moment de l’exécution, les clients transmettent le nom de chaîne de la propriété ou de la méthode qu’ils souhaitent appeler dans la méthode [**IDispatch :: GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames)().</span><span class="sxs-lookup"><span data-stu-id="2360c-137">At run time, clients pass the string name of the property or method they wish to call into the [**IDispatch::GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames)() method.</span></span> <span data-ttu-id="2360c-138">Si la propriété ou la méthode existe sur l’objet, l’identificateur de dispatch (dispID) de la fonction correspondante est récupéré.</span><span class="sxs-lookup"><span data-stu-id="2360c-138">If the property or method exists on the object, the dispatch identifier (dispID) of the corresponding function is retrieved.</span></span> <span data-ttu-id="2360c-139">Le dispID est ensuite utilisé pour exécuter la fonction par le biais de [**IDispatch :: Invoke**](/windows/win32/api/oaidl/nf-oaidl-idispatch-invoke)().</span><span class="sxs-lookup"><span data-stu-id="2360c-139">The dispID is then used to execute the function through [**IDispatch::Invoke**](/windows/win32/api/oaidl/nf-oaidl-idispatch-invoke)().</span></span> <span data-ttu-id="2360c-140">L’utilisation de **IDispatch**, les propriétés et les méthodes sur les interfaces exposées par un objet unique s’affichent sous la forme d’une liste plate.</span><span class="sxs-lookup"><span data-stu-id="2360c-140">Using **IDispatch**, properties and methods on the interfaces exposed by a single object appear as a flat list.</span></span> <span data-ttu-id="2360c-141">Étant donné que l’accès lié au nom requiert deux appels de fonction, il est moins efficace que l’utilisation directe d’une interface COM.</span><span class="sxs-lookup"><span data-stu-id="2360c-141">Because name-bound access requires two function calls, it is less efficient than using a COM interface directly.</span></span> <span data-ttu-id="2360c-142">Les clients sont encouragés à utiliser les interfaces COM ADSI sur les objets lorsque les performances sont à prendre en compte.</span><span class="sxs-lookup"><span data-stu-id="2360c-142">Clients are encouraged to use the ADSI COM interfaces on the objects when performance is a consideration.</span></span> <span data-ttu-id="2360c-143">Les contrôleurs Automation avancés tels que Visual Basic 4,0 peuvent appeler d’autres interfaces COM et **IDispatch**, si les interfaces sont conformes aux contraintes d’automatisation pour les types de données et le passage de paramètres.</span><span class="sxs-lookup"><span data-stu-id="2360c-143">Advanced Automation controllers such as Visual Basic 4.0 can call other COM interfaces as well as **IDispatch**, if the interfaces comply with the Automation constraints for data types and parameter passing.</span></span>

<span data-ttu-id="2360c-144">Les fournisseurs ADSI génèrent des DISPID de manière dynamique pour chaque objet Active Directory.</span><span class="sxs-lookup"><span data-stu-id="2360c-144">ADSI providers generate dispIDs dynamically for each Active Directory object.</span></span> <span data-ttu-id="2360c-145">Les DISPID récupérés par le biais de [**IDispatch :: GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames) pour un objet donné sont les valeurs générées, mais pas les valeurs qui se trouvent dans le IDL de l’objet.</span><span class="sxs-lookup"><span data-stu-id="2360c-145">The dispIDs retrieved through [**IDispatch::GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames) for a given object are the generated values, but not the values that are in the IDL for the object.</span></span> <span data-ttu-id="2360c-146">Les utilisateurs [**IDispatch**](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface) doivent appeler **GetIDsOfNames** pour obtenir des DISPID valides au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="2360c-146">[**IDispatch**](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface) users must call **GetIDsOfNames** to obtain valid dispIDs at run time.</span></span>

## <a name="type-information-and-type-libraries"></a><span data-ttu-id="2360c-147">Informations de type et bibliothèques de types</span><span class="sxs-lookup"><span data-stu-id="2360c-147">Type Information and Type Libraries</span></span>

<span data-ttu-id="2360c-148">Le kit de développement logiciel (SDK) ADSI fournit une bibliothèque de types, activeds. tlb, qui documente toutes les interfaces standard prises en charge par ADSI.</span><span class="sxs-lookup"><span data-stu-id="2360c-148">The ADSI SDK supplies a type library, Activeds.tlb, that documents all the standard interfaces supported by ADSI.</span></span> <span data-ttu-id="2360c-149">Un fournisseur doit fournir une bibliothèque de types similaire pour toutes les interfaces trouvées dans activeds. tlb, ainsi que toutes les données de type supplémentaires pour les interfaces implémentées dans le composant du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="2360c-149">A provider must supply a similar type library for all interfaces found in Activeds.tlb, plus any additional type data for the interfaces implemented within the provider component.</span></span>

<span data-ttu-id="2360c-150">Voici un exemple de code IDL.</span><span class="sxs-lookup"><span data-stu-id="2360c-150">The following is an IDL code example.</span></span>

``` syntax
[ object, uuid(IID_IADsXYZ), oleautomation, dual ]
interface IADsXYZ: IDispatch
{
// Read-only properties.
[propget]
HRESULT AReadOnlyProp ([out, retval]BSTR *pbstrAReadOnlyProp);
 
// Read/write properties.
[propget]
HRESULT AReadWriteProp ([out, retval]long *plAReadWriteProp);
[propput]
HRESULT AReadWriteProp ([in]long lAReadWriteProp);
 
// Methods.
HRESULT AMethod ([in]DATE dateInParameter,
[out, retval]BSTR *pbstrReturnValue);
};
```

## <a name="thread-safety"></a><span data-ttu-id="2360c-151">Cohérence de thread</span><span class="sxs-lookup"><span data-stu-id="2360c-151">Thread Safety</span></span>

<span data-ttu-id="2360c-152">Le modèle COM (Component Object Model) décrit les trois modèles de threads suivants.</span><span class="sxs-lookup"><span data-stu-id="2360c-152">The Component Object Model (COM) describes the following three threading models.</span></span> <span data-ttu-id="2360c-153">Les applications COM indiquent quel modèle est en cours d’utilisation lors de l’initialisation de la bibliothèque COM à l’aide des fonctions [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) et [**CoInitializeEx**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializeex) :</span><span class="sxs-lookup"><span data-stu-id="2360c-153">COM applications indicate which model is in use when initializing the COM library using the [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) and [**CoInitializeEx**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializeex) functions:</span></span>

-   <span data-ttu-id="2360c-154">Thread unique.</span><span class="sxs-lookup"><span data-stu-id="2360c-154">Single threading.</span></span> <span data-ttu-id="2360c-155">Le modèle à thread unique suppose un seul thread d’exécution dans un processus, en supposant que les structures de données COM d’un processus n’ont pas besoin de sérialisation d’accès.</span><span class="sxs-lookup"><span data-stu-id="2360c-155">The single threaded model assumes a single thread of execution in a process, further assuming that COM data structures in a process need no access serialization.</span></span>
-   <span data-ttu-id="2360c-156">Threads cloisonnés.</span><span class="sxs-lookup"><span data-stu-id="2360c-156">Apartment threading.</span></span> <span data-ttu-id="2360c-157">Un objet COM est associé au thread qui l’a créé.</span><span class="sxs-lookup"><span data-stu-id="2360c-157">A COM object is associated with the thread that created it.</span></span> <span data-ttu-id="2360c-158">Les appels à un objet sur un autre thread doivent être exécutés par le thread qui a créé cet objet.</span><span class="sxs-lookup"><span data-stu-id="2360c-158">Calls to an object on another thread must be executed by the thread that created that object.</span></span> <span data-ttu-id="2360c-159">Pour ce faire, le thread source appelle un proxy client qui organise l’appel de méthode et le remet à une fonction de stub serveur dans le thread de destination via la file d’attente de messages Win32 associée au thread de destination.</span><span class="sxs-lookup"><span data-stu-id="2360c-159">To accomplish this, the source thread invokes a client proxy which arranges the method call and delivers it to a server stub function in the destination thread through the Win32 message queue associated with the destination thread.</span></span>
-   <span data-ttu-id="2360c-160">Threading libre.</span><span class="sxs-lookup"><span data-stu-id="2360c-160">Free threading.</span></span> <span data-ttu-id="2360c-161">Les objets COM sont supposés être thread-safe.</span><span class="sxs-lookup"><span data-stu-id="2360c-161">COM objects are assumed to be thread safe.</span></span> <span data-ttu-id="2360c-162">Plusieurs threads sont autorisés à accéder à n’importe quel objet dans le processus sans aucune sérialisation imposée.</span><span class="sxs-lookup"><span data-stu-id="2360c-162">Multiple threads are allowed access to any object in the process with no serialization imposed.</span></span>

<span data-ttu-id="2360c-163">ADSI ne prend pas en part un modèle de thread particulier.</span><span class="sxs-lookup"><span data-stu-id="2360c-163">ADSI does not assume any particular threading model.</span></span> <span data-ttu-id="2360c-164">Les rédacteurs des composants fournisseurs doivent assumer le modèle de thread libre et garantir la cohérence de leurs structures de données internes en les protégeant des threads non sécurisés, c’est-à-dire, des mises à jour non coordonnées via l’utilisation d’objets de synchronisation, tels que des sections critiques ou des sémaphores.</span><span class="sxs-lookup"><span data-stu-id="2360c-164">Writers of provider components should assume the free threading model and guarantee the consistency of their internal data structures by protecting them from thread-unsafe, that is, uncoordinated, updates through the use of synchronization objects such as critical sections or semaphores.</span></span>

## <a name="object-locking"></a><span data-ttu-id="2360c-165">Verrouillage d’objet</span><span class="sxs-lookup"><span data-stu-id="2360c-165">Object Locking</span></span>

<span data-ttu-id="2360c-166">ADSI n’impose pas ou ne définit pas de schéma de verrouillage d’objets.</span><span class="sxs-lookup"><span data-stu-id="2360c-166">ADSI does not impose or define an object-locking scheme.</span></span> <span data-ttu-id="2360c-167">Les fournisseurs pour les espaces de noms qui prennent en charge la sérialisation de l’accès à l’aide du verrouillage peuvent exposer le schéma de verrouillage sous-jacent via des extensions spécifiques du fournisseur à ADSI.</span><span class="sxs-lookup"><span data-stu-id="2360c-167">Providers for namespaces that support access serialization using locking can expose the underlying locking scheme through provider-specific extensions to ADSI.</span></span>

## <a name="property-names-within-a-schema"></a><span data-ttu-id="2360c-168">Noms de propriétés dans un schéma</span><span class="sxs-lookup"><span data-stu-id="2360c-168">Property Names Within a Schema</span></span>

<span data-ttu-id="2360c-169">ADSI représente des propriétés en tant qu’objets de propriété dans le conteneur de schéma ADSI.</span><span class="sxs-lookup"><span data-stu-id="2360c-169">ADSI represents properties as property objects within the ADSI schema container.</span></span> <span data-ttu-id="2360c-170">Cela requiert que les noms de propriété soient uniques dans chaque conteneur de schéma.</span><span class="sxs-lookup"><span data-stu-id="2360c-170">This requires that property names be unique within each schema container.</span></span> <span data-ttu-id="2360c-171">Le fournisseur doit s’assurer qu’il n’y a pas de collisions de noms.</span><span class="sxs-lookup"><span data-stu-id="2360c-171">The provider must ensure that there are no name collisions.</span></span>

## <a name="primary-interface"></a><span data-ttu-id="2360c-172">Interface principale</span><span class="sxs-lookup"><span data-stu-id="2360c-172">Primary Interface</span></span>

<span data-ttu-id="2360c-173">Lorsqu’un fournisseur ne peut pas identifier l’interface qui doit être retournée en tant qu’interface principale, les **\_ IAD IID** doivent être retournées.</span><span class="sxs-lookup"><span data-stu-id="2360c-173">When a provider cannot identify which interface should be returned as the primary interface, **IID\_IADs** should be returned.</span></span> <span data-ttu-id="2360c-174">Cela fournit un accès lié au nom à toutes les propriétés d’un objet via [**IDispatch**](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface) et les méthodes [**IADs :: obten**](/windows/desktop/api/Iads/nf-iads-iads-get), [**IADs :: GETEX**](/windows/desktop/api/Iads/nf-iads-iads-getex), [**iads ::P ut**](/windows/desktop/api/Iads/nf-iads-iads-put)et [**IADs ::P Utex**](/windows/desktop/api/Iads/nf-iads-iads-putex) .</span><span class="sxs-lookup"><span data-stu-id="2360c-174">This provides name-bound access to all properties of an object through [**IDispatch**](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface) and the [**IADs::Get**](/windows/desktop/api/Iads/nf-iads-iads-get), [**IADs::GetEx**](/windows/desktop/api/Iads/nf-iads-iads-getex), [**IADs::Put**](/windows/desktop/api/Iads/nf-iads-iads-put), and [**IADs::PutEx**](/windows/desktop/api/Iads/nf-iads-iads-putex) methods.</span></span>

 

 