---
title: Implémentation principale
description: 'Un fournisseur ADSI prend en charge les fonctionnalités suivantes :'
ms.assetid: 39798237-a181-43b4-8441-ac711f923d4d
ms.tgt_platform: multiple
keywords:
- implémentation principale d’ADSI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f62068bd77553f89e222422431811da1ef251ccd
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/21/2020
ms.locfileid: "104031859"
---
# <a name="core-implementation"></a><span data-ttu-id="b036f-104">Implémentation principale</span><span class="sxs-lookup"><span data-stu-id="b036f-104">Core Implementation</span></span>

<span data-ttu-id="b036f-105">Un fournisseur ADSI prend en charge les fonctionnalités suivantes :</span><span class="sxs-lookup"><span data-stu-id="b036f-105">An ADSI provider supports the following features:</span></span>

-   <span data-ttu-id="b036f-106">Chaînes ADsPath à la fois dans les formats COM et URL.</span><span class="sxs-lookup"><span data-stu-id="b036f-106">ADsPath strings in both COM and URL format.</span></span> <span data-ttu-id="b036f-107">Par définition, vous pouvez récupérer un objet Active Directory à l’aide d’un ADsPath.</span><span class="sxs-lookup"><span data-stu-id="b036f-107">By definition, you can retrieve an Active Directory object using an ADsPath.</span></span> <span data-ttu-id="b036f-108">Les fournisseurs prennent en charge la syntaxe requise par le service d’annuaire à l’aide de l’implémentation **ParseDisplayName** .</span><span class="sxs-lookup"><span data-stu-id="b036f-108">Providers support the syntax that their directory service requires using the **ParseDisplayName** implementation.</span></span>
-   <span data-ttu-id="b036f-109">Un objet d’espace de noms de niveau supérieur qui prend en charge [**IParseDisplayName ::P arsedisplayname**](/windows/win32/api/oleidl/nf-oleidl-iparsedisplayname-parsedisplayname) et [**IADsOpenDSObject**](/windows/desktop/api/Iads/nn-iads-iadsopendsobject).</span><span class="sxs-lookup"><span data-stu-id="b036f-109">A top-level Namespace object that supports [**IParseDisplayName::ParseDisplayName**](/windows/win32/api/oleidl/nf-oleidl-iparsedisplayname-parsedisplayname) and [**IADsOpenDSObject**](/windows/desktop/api/Iads/nn-iads-iadsopendsobject).</span></span> <span data-ttu-id="b036f-110">Cet objet contient les nœuds racines de cet espace de noms.</span><span class="sxs-lookup"><span data-stu-id="b036f-110">This object contains the root nodes for this namespace.</span></span> <span data-ttu-id="b036f-111">Une partie de l’implémentation de **ParseDisplayName** doit inclure un analyseur qui recherche les erreurs de syntaxe pour son propre espace de noms.</span><span class="sxs-lookup"><span data-stu-id="b036f-111">Part of the **ParseDisplayName** implementation must include a parser that checks for syntax errors for its own namespace.</span></span> <span data-ttu-id="b036f-112">Cet objet doit également prendre en charge [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) et **IADsOpenDSObject**.</span><span class="sxs-lookup"><span data-stu-id="b036f-112">This object must also support [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) and **IADsOpenDSObject**.</span></span>
-   <span data-ttu-id="b036f-113">Interface [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) .</span><span class="sxs-lookup"><span data-stu-id="b036f-113">The [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) interface.</span></span> <span data-ttu-id="b036f-114">Cela comprend une implémentation de cache de propriété simple via [**IADs :: GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) et [**IADs :: setinfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo).</span><span class="sxs-lookup"><span data-stu-id="b036f-114">This includes a simple property cache implementation through [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) and [**IADs::SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo).</span></span> <span data-ttu-id="b036f-115">Les opérations qui obtiennent ou définissent des propriétés d’objet se produisent en mode mis en cache.</span><span class="sxs-lookup"><span data-stu-id="b036f-115">Operations that get or set object properties occur in cached mode.</span></span> <span data-ttu-id="b036f-116">Les valeurs de cache sont écrites dans le magasin d’annuaires sous-jacent pendant **IADs :: setinfo**.</span><span class="sxs-lookup"><span data-stu-id="b036f-116">Cache values are written to the underlying directory store during **IADs::SetInfo**.</span></span> <span data-ttu-id="b036f-117">Toutefois, une méthode ADSI n’est pas mise en cache, mais s’exécute immédiatement.</span><span class="sxs-lookup"><span data-stu-id="b036f-117">An ADSI method, however, is not cached, but executes immediately.</span></span>
-   <span data-ttu-id="b036f-118">Interfaces [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist), [**IADsPropertyEntry**](/windows/desktop/api/Iads/nn-iads-iadspropertyentry) et [**IADsPropertyValue**](/windows/desktop/api/Iads/nn-iads-iadspropertyvalue) pour accéder directement aux propriétés dans le cache de propriétés et les énumérer.</span><span class="sxs-lookup"><span data-stu-id="b036f-118">The [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist), [**IADsPropertyEntry**](/windows/desktop/api/Iads/nn-iads-iadspropertyentry) and [**IADsPropertyValue**](/windows/desktop/api/Iads/nn-iads-iadspropertyvalue) interfaces for directly accessing and enumerating the properties in the property cache.</span></span> <span data-ttu-id="b036f-119">Pour les services d’annuaire qui n’exposent pas de schéma, cette interface vous permet de manipuler les propriétés d’un objet.</span><span class="sxs-lookup"><span data-stu-id="b036f-119">For directory services that do not expose a schema, this interface allows you to manipulate the properties of an object.</span></span>
-   <span data-ttu-id="b036f-120">Interface [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) pour les clients non-Automation.</span><span class="sxs-lookup"><span data-stu-id="b036f-120">The [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) interface for non-Automation clients.</span></span> <span data-ttu-id="b036f-121">Cela utilise le protocole Out-The-Wire pour des performances maximales et contourne le cache de propriétés.</span><span class="sxs-lookup"><span data-stu-id="b036f-121">This uses over-the-wire protocol for maximum performance and bypasses the property cache.</span></span>
-   <span data-ttu-id="b036f-122">Interface [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) .</span><span class="sxs-lookup"><span data-stu-id="b036f-122">The [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) interface.</span></span> <span data-ttu-id="b036f-123">Chaque objet Active Directory a un conteneur parent qui contrôle sa durée de vie.</span><span class="sxs-lookup"><span data-stu-id="b036f-123">Every Active Directory object has a parent container that controls its lifetime.</span></span> <span data-ttu-id="b036f-124">N’oubliez pas que pour les objets conteneur ADs, [**IADs :: GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) affecte uniquement les propriétés de conteneur et non son contenu.</span><span class="sxs-lookup"><span data-stu-id="b036f-124">Be aware that for ADs container objects, [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) affects only the container properties and not its contents.</span></span> <span data-ttu-id="b036f-125">SetInfo sur les objets de conteneur ADs affecte uniquement les propriétés de conteneur et n’affecte pas les objets ou objets nouvellement créés qui existent déjà dans le conteneur.</span><span class="sxs-lookup"><span data-stu-id="b036f-125">SetInfo on ADs container objects affects only the container properties and does not affect newly created objects or objects that already exist within the container.</span></span>
-   <span data-ttu-id="b036f-126">Interface [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) .</span><span class="sxs-lookup"><span data-stu-id="b036f-126">The [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) interface.</span></span> <span data-ttu-id="b036f-127">Il s’agit de l’interface d’automatisation pour les langages tels que Visual Basic Scripting Edition, qui n’utilisent pas la liaison au moment de la compilation.</span><span class="sxs-lookup"><span data-stu-id="b036f-127">This is the Automation interface for languages like Visual Basic Scripting Edition, that do not use compile-time binding.</span></span> <span data-ttu-id="b036f-128">Il s’agit des données de bibliothèque de types que doit fournir un fournisseur.</span><span class="sxs-lookup"><span data-stu-id="b036f-128">Related to this is the type library data that a provider must supply.</span></span> <span data-ttu-id="b036f-129">Pour plus d’informations, consultez [problèmes d’implémentation pour les fournisseurs ADSI](implementation-issues-for-adsi-providers.md).</span><span class="sxs-lookup"><span data-stu-id="b036f-129">For more information, see [Implementation Issues for ADSI Providers](implementation-issues-for-adsi-providers.md).</span></span>
-   <span data-ttu-id="b036f-130">Un objet conteneur de classe de schéma et les objets de syntaxe, de propriété et de classe de schéma appropriés qui prennent en charge respectivement [**IADsSyntax**](/windows/desktop/api/Iads/nn-iads-iadssyntax), [**IADsProperty**](/windows/desktop/api/Iads/nn-iads-iadsproperty)et [**IADsClass**](/windows/desktop/api/Iads/nn-iads-iadsclass) .</span><span class="sxs-lookup"><span data-stu-id="b036f-130">A schema class container object and the appropriate syntax, property, and schema class objects that support [**IADsSyntax**](/windows/desktop/api/Iads/nn-iads-iadssyntax), [**IADsProperty**](/windows/desktop/api/Iads/nn-iads-iadsproperty), and [**IADsClass**](/windows/desktop/api/Iads/nn-iads-iadsclass) respectively.</span></span> <span data-ttu-id="b036f-131">Au minimum, chaque nœud racine doit contenir son propre objet conteneur de classe de schéma.</span><span class="sxs-lookup"><span data-stu-id="b036f-131">At a minimum, each root node must contain its own schema class container object.</span></span>
-   <span data-ttu-id="b036f-132">L’interface [**IADsMembers**](/windows/desktop/api/Iads/nn-iads-iadsmembers) , si des attributs pris en charge sont des collections d’objets ADSI, tels que des groupes de sécurité.</span><span class="sxs-lookup"><span data-stu-id="b036f-132">The [**IADsMembers**](/windows/desktop/api/Iads/nn-iads-iadsmembers) interface, if any supported attributes are collections of ADSI objects, such as security groups.</span></span>
-   <span data-ttu-id="b036f-133">L’interface [**IADsCollection**](/windows/desktop/api/Iads/nn-iads-iadscollection) , si des attributs pris en charge sont des collections du même type d’élément de répertoire avec [**IADsCollection :: Add**](/windows/desktop/api/Iads/nf-iads-iadscollection-add) et [**IADsCollection :: Remove**](/windows/desktop/api/Iads/nf-iads-iadscollection-remove) , fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="b036f-133">The [**IADsCollection**](/windows/desktop/api/Iads/nn-iads-iadscollection) interface, if any supported attributes are collections of the same directory element type with [**IADsCollection::Add**](/windows/desktop/api/Iads/nf-iads-iadscollection-add) and [**IADsCollection::Remove**](/windows/desktop/api/Iads/nf-iads-iadscollection-remove) capability.</span></span>
-   <span data-ttu-id="b036f-134">L’énumération **IEnumXXXX** prend en charge tous les objets énumérateur spécifiques.</span><span class="sxs-lookup"><span data-stu-id="b036f-134">The **IEnumXXXX** enumeration supports all specific enumerator objects.</span></span>
-   <span data-ttu-id="b036f-135">Routines pour mapper la syntaxe et convertir les données natives en type de données [**Variant**](/windows/win32/api/oaidl/ns-oaidl-variant) .</span><span class="sxs-lookup"><span data-stu-id="b036f-135">Routines to map syntax and convert native data to the [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) data type.</span></span>
-   <span data-ttu-id="b036f-136">Suivez les conventions ADSI pour les objets ADSI fournis par le fournisseur.</span><span class="sxs-lookup"><span data-stu-id="b036f-136">Follow ADSI conventions for provider-supplied ADSI objects.</span></span> <span data-ttu-id="b036f-137">Incluez les fichiers d’aide et les bibliothèques de types documentant les propriétés et les méthodes de l’interface.</span><span class="sxs-lookup"><span data-stu-id="b036f-137">Include help files and type libraries documenting the interface properties and methods.</span></span>

<span data-ttu-id="b036f-138">Comme pour toute implémentation COM, les appels à [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) doivent retourner **e \_ nointerface** pour les interfaces non implémentées, **e \_ NOTIMPL** pour les méthodes non implémentées des interfaces qui, sinon, sont implémentées et retournent la **\_ propriété e ADS \_ \_ non \_ prise en charge** pour les propriétés non implémentées.</span><span class="sxs-lookup"><span data-stu-id="b036f-138">As with any COM implementation, calls to [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) must return **E\_NOINTERFACE** for unimplemented interfaces, **E\_NOTIMPL** for unimplemented methods of interfaces that are otherwise implemented and return **E\_ADS\_PROPERTY\_NOT\_SUPPORTED** for unimplemented properties.</span></span> <span data-ttu-id="b036f-139">Pour plus d’informations sur les interfaces doubles et sur leur impact sur l’implémentation des propriétés, consultez [interfaces doubles](dual-interfaces.md).</span><span class="sxs-lookup"><span data-stu-id="b036f-139">For more information about dual interfaces and how they affect property implementation, see [Dual Interfaces](dual-interfaces.md).</span></span>

 

 