---
title: Architecture d’extension ADSI
description: Les extensions ADSI sont basées sur le modèle d’agrégation COM avec plusieurs améliorations. Les extensions doivent adhérer à toutes les règles COM. Pour plus d’informations, consultez la spécification COM.
ms.assetid: 59e39273-1f66-4bdd-89ed-31947a268d1f
ms.tgt_platform: multiple
keywords:
- extensions ADSI, architecture d’extension
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 377409f4b9ac36d72d6885e89860b9e6e680b103
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/21/2020
ms.locfileid: "103730285"
---
# <a name="adsi-extension-architecture"></a><span data-ttu-id="abe35-106">Architecture d’extension ADSI</span><span class="sxs-lookup"><span data-stu-id="abe35-106">ADSI Extension Architecture</span></span>

<span data-ttu-id="abe35-107">Les extensions ADSI sont basées sur le modèle d’agrégation COM avec plusieurs améliorations.</span><span class="sxs-lookup"><span data-stu-id="abe35-107">ADSI extensions are based on the COM aggregation model with several enhancements.</span></span> <span data-ttu-id="abe35-108">Les extensions doivent adhérer à toutes les règles COM.</span><span class="sxs-lookup"><span data-stu-id="abe35-108">Extensions must adhere to all COM rules.</span></span> <span data-ttu-id="abe35-109">Pour plus d’informations, consultez la spécification COM.</span><span class="sxs-lookup"><span data-stu-id="abe35-109">For more information, see the COM specification.</span></span>

<span data-ttu-id="abe35-110">Voici un aperçu du modèle d’agrégation COM.</span><span class="sxs-lookup"><span data-stu-id="abe35-110">Here is a review of the COM aggregation model.</span></span>

![modèle d’agrégation com](images/comagmod.png)

<span data-ttu-id="abe35-112">Un agrégat, également connu sous le nom d’objet interne, est un objet créé par une agrégation.</span><span class="sxs-lookup"><span data-stu-id="abe35-112">An aggregate, also known as an inner object, is an object that an aggregator creates.</span></span> <span data-ttu-id="abe35-113">Votre objet d’extension est un agrégat.</span><span class="sxs-lookup"><span data-stu-id="abe35-113">Your extension object is an aggregate.</span></span>

<span data-ttu-id="abe35-114">Un agrégateur, également appelé objet externe, est un objet qui crée un agrégat.</span><span class="sxs-lookup"><span data-stu-id="abe35-114">An aggregator, also known as an outer object, is an object that creates an aggregate.</span></span> <span data-ttu-id="abe35-115">ADSI est une agrégation.</span><span class="sxs-lookup"><span data-stu-id="abe35-115">ADSI is an aggregator.</span></span>

<span data-ttu-id="abe35-116">L’objet interne délègue son [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) à l' **IUnknown** de l’agrégateur.</span><span class="sxs-lookup"><span data-stu-id="abe35-116">The inner object delegates its [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) to the aggregator's **IUnknown**.</span></span>

<span data-ttu-id="abe35-117">Les extensions ADSI ajoutent les améliorations suivantes à l’agrégation COM pour répondre à ses exigences :</span><span class="sxs-lookup"><span data-stu-id="abe35-117">ADSI extensions add the following enhancements to COM aggregation to satisfy its requirements:</span></span>

-   <span data-ttu-id="abe35-118">Permet à chaque enregistreur d’extension d’étendre des objets ADSI.</span><span class="sxs-lookup"><span data-stu-id="abe35-118">Enables each extension writer to extend ADSI objects.</span></span> <span data-ttu-id="abe35-119">Un enregistreur d’extensions peut inscrire son extension auprès d’ADSI et ne pas être affecté par l’existence d’autres extensions.</span><span class="sxs-lookup"><span data-stu-id="abe35-119">An extension writer can register its extension with ADSI and not be affected by the existence of other extensions.</span></span> <span data-ttu-id="abe35-120">Dans le modèle d’agrégation COM, l’agrégation doit avoir le CLSID de l’agrégat.</span><span class="sxs-lookup"><span data-stu-id="abe35-120">In the COM aggregation model, the aggregator must have the aggregate's CLSID.</span></span> <span data-ttu-id="abe35-121">ADSI assouplit cette exigence en faisant lui-même Office d’agrégation pour toutes les extensions.</span><span class="sxs-lookup"><span data-stu-id="abe35-121">ADSI relaxes this requirement by making itself act as the aggregator for all extensions.</span></span> <span data-ttu-id="abe35-122">Par conséquent, au lieu de former une couche de composants imbriqués, les extensions sont au même niveau.</span><span class="sxs-lookup"><span data-stu-id="abe35-122">Therefore, instead of forming a layer of nested components, extensions are at the same level.</span></span>
-   <span data-ttu-id="abe35-123">Autorise un objet, un IDispatch.</span><span class="sxs-lookup"><span data-stu-id="abe35-123">Allows one object, one IDispatch.</span></span> <span data-ttu-id="abe35-124">La prise en charge d’Automation est l’une des fonctionnalités les plus importantes d’ADSI.</span><span class="sxs-lookup"><span data-stu-id="abe35-124">Automation support is one of the most important features of ADSI.</span></span> <span data-ttu-id="abe35-125">La prise en charge de l’automatisation est obtenue, car ADSI prend en charge l’interface [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) .</span><span class="sxs-lookup"><span data-stu-id="abe35-125">Automation support is achieved because ADSI supports the [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) interface.</span></span> <span data-ttu-id="abe35-126">Les rédacteurs d’extensions sont encouragés à prendre en charge l’interface **IDispatch** .</span><span class="sxs-lookup"><span data-stu-id="abe35-126">Extension writers are encouraged to support the **IDispatch** interface.</span></span> <span data-ttu-id="abe35-127">Toutefois, il ne doit y avoir qu’une seule interface **IDispatch** sur un objet donné.</span><span class="sxs-lookup"><span data-stu-id="abe35-127">However, there should be only one **IDispatch** interface on a given object.</span></span> <span data-ttu-id="abe35-128">ADSI intègre et collecte les nombreuses interfaces **IDispatch** de différentes extensions et les présente comme un **IDispatch** cohérent au contrôleur Automation.</span><span class="sxs-lookup"><span data-stu-id="abe35-128">ADSI integrates and collects the many **IDispatch** interfaces from different extensions and presents them as one consistent **IDispatch** to the Automation controller.</span></span> <span data-ttu-id="abe35-129">Chaque extension, quand elle est agrégée, doit réacheminer ses appels **IDispatch** vers le **IDISPATCH** fourni par ADSI.</span><span class="sxs-lookup"><span data-stu-id="abe35-129">Each extension, when aggregated, must re-route its **IDispatch** calls to the **IDispatch** provided by ADSI.</span></span>

<span data-ttu-id="abe35-130">Toutes ces solutions sont possibles en raison des services fournis par le gestionnaire d’objets ADSI, qui résident sur chaque fournisseur ADSI.</span><span class="sxs-lookup"><span data-stu-id="abe35-130">All these solutions are possible because of services that the ADSI Object Manager provides, which reside on each ADSI provider.</span></span>

<span data-ttu-id="abe35-131">L’illustration suivante montre l’architecture du modèle d’extension ADSI.</span><span class="sxs-lookup"><span data-stu-id="abe35-131">The following figure shows the ADSI Extension Model architecture.</span></span>

![architecture du modèle d’extension ADSI](images/adsiexmo.png)

<span data-ttu-id="abe35-133">ADSI prend en charge deux niveaux d’extension :</span><span class="sxs-lookup"><span data-stu-id="abe35-133">ADSI supports two levels of extension:</span></span>

-   <span data-ttu-id="abe35-134">Prise en charge de la liaison précoce.</span><span class="sxs-lookup"><span data-stu-id="abe35-134">Early Binding Support.</span></span> <span data-ttu-id="abe35-135">Il s’agit du premier niveau de l’extension.</span><span class="sxs-lookup"><span data-stu-id="abe35-135">This is the first level of extension.</span></span> <span data-ttu-id="abe35-136">Une extension doit prendre en charge l’inscription et implémenter de nouvelles interfaces.</span><span class="sxs-lookup"><span data-stu-id="abe35-136">An extension must support registration and implement new interfaces.</span></span> <span data-ttu-id="abe35-137">Les consommateurs d’extension doivent utiliser des outils ou des hôtes de script qui prennent en charge la liaison précoce, par exemple Visual C++, Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="abe35-137">The extension consumers must use tools or scripting hosts that support early binding, for example, Visual C++ , Visual Basic.</span></span>
-   <span data-ttu-id="abe35-138">Prise en charge de la liaison tardive.</span><span class="sxs-lookup"><span data-stu-id="abe35-138">Late Binding Support.</span></span> <span data-ttu-id="abe35-139">Cela se produit lorsqu’une extension satisfait à toutes les exigences de liaison précoce, et implémente une interface supplémentaire, [**IADsExtension**](/windows/desktop/api/Iads/nn-iads-iadsextension).</span><span class="sxs-lookup"><span data-stu-id="abe35-139">This happens when an extension satisfies all early binding requirements, and implements an additional interface, [**IADsExtension**](/windows/desktop/api/Iads/nn-iads-iadsextension).</span></span> <span data-ttu-id="abe35-140">Les implémenteurs d’extension peuvent utiliser n’importe quel outil qui fonctionne comme un contrôleur Automation, tel que Windows Script Host, Active Server pages ou HTML avec VBScript.</span><span class="sxs-lookup"><span data-stu-id="abe35-140">Extension implementers can use any tool that operates as an Automation controller, such as the Windows Script Host, Active Server Pages, or HTML with VBScript.</span></span>

 

 