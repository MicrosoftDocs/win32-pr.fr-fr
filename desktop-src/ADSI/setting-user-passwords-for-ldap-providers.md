---
title: Définition et modification des mots de passe utilisateur à l’aide du fournisseur LDAP
description: Pour définir le mot de passe d’un utilisateur, utilisez la méthode IADsUser. SetPassword.
ms.assetid: da3d9861-dd04-406c-9356-db1e4ff0eebc
ms.tgt_platform: multiple
keywords:
- ADSI fournisseur LDAP, objet utilisateur, définition des mots de passe
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5488146de271ac1108a904cd85163fad9d7dd205
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/21/2020
ms.locfileid: "104316445"
---
# <a name="setting-and-changing-user-passwords-with-the-ldap-provider"></a><span data-ttu-id="30a29-104">Définition et modification des mots de passe utilisateur à l’aide du fournisseur LDAP</span><span class="sxs-lookup"><span data-stu-id="30a29-104">Setting and Changing User Passwords with the LDAP Provider</span></span>

<span data-ttu-id="30a29-105">Pour définir le mot de passe d’un utilisateur, utilisez la méthode [**IADsUser. SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword) .</span><span class="sxs-lookup"><span data-stu-id="30a29-105">To a set a user password, use the [**IADsUser.SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword) method.</span></span>

<span data-ttu-id="30a29-106">Le fournisseur LDAP pour Active Directory utilise l’un des trois processus pour définir le mot de passe (les annuaires LDAP tiers tels que iPlanet n’utilisent pas ce processus d’authentification par mot de passe).</span><span class="sxs-lookup"><span data-stu-id="30a29-106">The LDAP provider for Active Directory uses one of three processes to set the password (third-party LDAP directories such as iPlanet do not use this password authentication process).</span></span> <span data-ttu-id="30a29-107">La méthode peut varier en fonction de la configuration du réseau.</span><span class="sxs-lookup"><span data-stu-id="30a29-107">The method may vary according to the network configuration.</span></span> <span data-ttu-id="30a29-108">Les méthodes Set Password se produisent dans l’ordre suivant :</span><span class="sxs-lookup"><span data-stu-id="30a29-108">The set password methods occur in the following order:</span></span>

-   <span data-ttu-id="30a29-109">Tout d’abord, le fournisseur LDAP tente d’utiliser le protocole LDAP sur une connexion SSL 128 bits.</span><span class="sxs-lookup"><span data-stu-id="30a29-109">First, the LDAP provider attempts to use LDAP over a 128-bit SSL connection.</span></span> <span data-ttu-id="30a29-110">Pour que le protocole SSL LDAP fonctionne correctement, le serveur LDAP doit disposer du certificat d’authentification serveur approprié et les clients qui exécutent le code ADSI doivent approuver l’autorité qui a émis ces certificats.</span><span class="sxs-lookup"><span data-stu-id="30a29-110">For LDAP SSL to operate successfully, the LDAP server must have the appropriate server authentication certificate installed and the clients running the ADSI code must trust the authority that issued those certificates.</span></span> <span data-ttu-id="30a29-111">Le serveur et le client doivent prendre en charge le chiffrement 128 bits.</span><span class="sxs-lookup"><span data-stu-id="30a29-111">Both the server and the client must support 128-bit encryption.</span></span>
-   <span data-ttu-id="30a29-112">Deuxièmement, si la connexion SSL échoue, le fournisseur LDAP tente d’utiliser Kerberos.</span><span class="sxs-lookup"><span data-stu-id="30a29-112">Second, if the SSL connection is unsuccessful, the LDAP provider attempts to use Kerberos.</span></span> <span data-ttu-id="30a29-113">Sur Windows 2000, Kerberos peut ne pas prendre en charge l’authentification inter-forêts.</span><span class="sxs-lookup"><span data-stu-id="30a29-113">On Windows 2000, Kerberos may not support cross-forest authentication.</span></span> <span data-ttu-id="30a29-114">Les améliorations ultérieures de Kerberos prennent en charge l’authentification inter-forêts.</span><span class="sxs-lookup"><span data-stu-id="30a29-114">Later enhancements to Kerberos support cross-forest authentication.</span></span>
-   <span data-ttu-id="30a29-115">Troisièmement, si Kerberos échoue, le fournisseur LDAP tente un appel d’API [**NetUserSetInfo**](/windows/desktop/api/lmaccess/nf-lmaccess-netusersetinfo) .</span><span class="sxs-lookup"><span data-stu-id="30a29-115">Third, if Kerberos is unsuccessful, the LDAP provider attempts a [**NetUserSetInfo**](/windows/desktop/api/lmaccess/nf-lmaccess-netusersetinfo) API call.</span></span> <span data-ttu-id="30a29-116">Dans les versions précédentes, ADSI a appelé **NetUserSetInfo** dans le contexte de sécurité dans lequel le thread était en cours d’exécution, et non dans le contexte de sécurité spécifié dans l’appel à [**IADsOpenDSObject. OpenDSObject**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) ou [**ADsOpenObject**](/windows/desktop/api/Adshlp/nf-adshlp-adsopenobject).</span><span class="sxs-lookup"><span data-stu-id="30a29-116">In previous releases, ADSI called **NetUserSetInfo** in the security context in which the thread was running, and not the security context specified in the call to [**IADsOpenDSObject.OpenDSObject**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) or [**ADsOpenObject**](/windows/desktop/api/Adshlp/nf-adshlp-adsopenobject).</span></span> <span data-ttu-id="30a29-117">Dans les versions ultérieures, cela a été modifié afin que le fournisseur LDAP ADSI emprunte l’identité de l’utilisateur spécifié dans l’appel **OpenDSObject** lorsqu’il appelle **NetUserSetInfo**.</span><span class="sxs-lookup"><span data-stu-id="30a29-117">In later releases, this was changed so that the ADSI LDAP provider would impersonate the user specified in the **OpenDSObject** call when it calls **NetUserSetInfo**.</span></span>

<span data-ttu-id="30a29-118">Pour modifier le mot de passe d’un utilisateur, utilisez la méthode [**IADsUser. ChangePassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-changepassword) .</span><span class="sxs-lookup"><span data-stu-id="30a29-118">To change a user password, use the [**IADsUser.ChangePassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-changepassword) method.</span></span> <span data-ttu-id="30a29-119">Comme [**SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword), cette méthode peut utiliser plusieurs processus pour modifier le mot de passe.</span><span class="sxs-lookup"><span data-stu-id="30a29-119">Like [**SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword), this method can use multiple processes to change the password.</span></span> <span data-ttu-id="30a29-120">Les méthodes de modification de mot de passe se produisent dans l’ordre suivant :</span><span class="sxs-lookup"><span data-stu-id="30a29-120">The change password methods occur in the following order:</span></span>

-   <span data-ttu-id="30a29-121">Tout d’abord, le fournisseur LDAP tente d’utiliser le protocole LDAP sur une connexion SSL 128 bits.</span><span class="sxs-lookup"><span data-stu-id="30a29-121">First, the LDAP provider tries to use LDAP over a 128-bit SSL connection.</span></span>
-   <span data-ttu-id="30a29-122">Deuxièmement, si la connexion 128-SSL échoue, le fournisseur LDAP tente un appel d’API [**NetUserChangePassword**](/windows/desktop/api/lmaccess/nf-lmaccess-netuserchangepassword) .</span><span class="sxs-lookup"><span data-stu-id="30a29-122">Second, if the 128-SSL connection is unsuccessful, the LDAP provider tries a [**NetUserChangePassword**](/windows/desktop/api/lmaccess/nf-lmaccess-netuserchangepassword) API call.</span></span> <span data-ttu-id="30a29-123">Comme [**SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword), dans les versions antérieures, le fournisseur LDAP ADSI emprunte l’identité des informations d’identification de l’utilisateur transmises à l’aide de la méthode [**IADsOpenDSObject. OpenDSObject**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) ou de la fonction [**ADsOpenObject**](/windows/desktop/api/Adshlp/nf-adshlp-adsopenobject) .</span><span class="sxs-lookup"><span data-stu-id="30a29-123">Like [**SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword), in earlier releases, the ADSI LDAP provider impersonates the user credentials passed using the [**IADsOpenDSObject.OpenDSObject**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) method or the [**ADsOpenObject**](/windows/desktop/api/Adshlp/nf-adshlp-adsopenobject) function.</span></span>

 

 