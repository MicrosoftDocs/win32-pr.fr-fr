---
title: Définition des droits d’accès sur un objet
description: Cette rubrique explique comment créer un ACE pour un droit d’accès et définir cette entrée de contrôle d’accès sur la liste DACL d’un objet.
ms.assetid: c0b45709-4652-46c7-8d52-44076802d109
ms.tgt_platform: multiple
keywords:
- Définition des droits d’accès sur un objet AD
- Objets AD, définition des droits d’accès sur un objet
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2bcf54de381dab2af1dab4ea44654fb0a5682f06
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/17/2020
ms.locfileid: "104462819"
---
# <a name="setting-access-rights-on-an-object"></a><span data-ttu-id="22497-105">Définition des droits d’accès sur un objet</span><span class="sxs-lookup"><span data-stu-id="22497-105">Setting Access Rights on an Object</span></span>

<span data-ttu-id="22497-106">Lorsque vous utilisez les objets COM ADSI [**IADsSecurityDescriptor**](/windows/desktop/api/iads/nn-iads-iadssecuritydescriptor) (descripteur de sécurité), [**IADsAccessControlList**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrollist) (DACL et SACL) et [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) (ACE) pour ajouter une entrée de contrôle d’accès à une liste de contrôle d’accès, vous apportez des modifications à la propriété **ntSecurityDescriptor** de l’objet spécifié dans le cache de propriétés.</span><span class="sxs-lookup"><span data-stu-id="22497-106">When using the ADSI COM objects [**IADsSecurityDescriptor**](/windows/desktop/api/iads/nn-iads-iadssecuritydescriptor) (security descriptor), [**IADsAccessControlList**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrollist) (DACLs and SACLs), and [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) (ACE) to add an ACE to a ACL, you are making changes to the **nTSecurityDescriptor** property of the specified object in the property cache.</span></span> <span data-ttu-id="22497-107">Cela signifie placer les méthodes sur les objets qui contiennent la nouvelle entrée du contrôle d’accès et la méthode [**IADs. setinfo**](/windows/desktop/api/iads/nf-iads-iads-setinfo) doit être appelée pour écrire le descripteur de sécurité mis à jour dans le répertoire à partir du cache de propriétés.</span><span class="sxs-lookup"><span data-stu-id="22497-107">This means put methods on the objects that contain the new ACE and the [**IADs.SetInfo**](/windows/desktop/api/iads/nf-iads-iads-setinfo) method must be called in order to write the updated security descriptor to the directory from the property cache.</span></span>

<span data-ttu-id="22497-108">Pour plus d’informations et pour obtenir un exemple de code qui définit une entrée du contrôle d’accès sur un objet dans Active Directory Domain Services, consultez [exemple de code pour la définition d’une entrée du contrôle d’accès sur un objet d’annuaire](example-code-for-setting-an-ace-on-a-directory-object.md).</span><span class="sxs-lookup"><span data-stu-id="22497-108">For more information and a code example that sets an ACE on an object in Active Directory Domain Services, see [Example Code for Setting an ACE on a Directory Object](example-code-for-setting-an-ace-on-a-directory-object.md).</span></span>

<span data-ttu-id="22497-109">Utilisez le processus général suivant pour créer une entrée du contrôle d’accès pour un droit d’accès et définir cette entrée de contrôle d’accès sur la liste DACL d’un objet.</span><span class="sxs-lookup"><span data-stu-id="22497-109">Use the following general process to create an ACE for an access right and setting that ACE on the DACL of an object.</span></span>

1.  <span data-ttu-id="22497-110">Obtient un pointeur d’interface [**IADs**](/windows/desktop/api/iads/nn-iads-iads) vers l’objet.</span><span class="sxs-lookup"><span data-stu-id="22497-110">Get an [**IADs**](/windows/desktop/api/iads/nn-iads-iads) interface pointer to the object.</span></span>
2.  <span data-ttu-id="22497-111">Utilisez la méthode [**IADs. obten**](/windows/desktop/api/iads/nf-iads-iads-get) pour récupérer le descripteur de sécurité de l’objet.</span><span class="sxs-lookup"><span data-stu-id="22497-111">Use the [**IADs.Get**](/windows/desktop/api/iads/nf-iads-iads-get) method to get the security descriptor of the object.</span></span> <span data-ttu-id="22497-112">Le nom de la propriété contenant le descripteur de sécurité est **ntSecurityDescriptor**.</span><span class="sxs-lookup"><span data-stu-id="22497-112">The name of the property containing the security descriptor is **nTSecurityDescriptor**.</span></span> <span data-ttu-id="22497-113">La propriété est retournée en tant que [**Variant**](/windows/win32/api/oaidl/ns-oaidl-variant) contenant un pointeur [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) (le membre **VT** est **VT \_ Dispatch**).</span><span class="sxs-lookup"><span data-stu-id="22497-113">The property will be returned as a [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) containing an [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) pointer (the **vt** member is **VT\_DISPATCH**).</span></span> <span data-ttu-id="22497-114">Appelez **QueryInterface** sur ce pointeur **IDispatch** pour qu’une interface [**IADsSecurityDescriptor**](/windows/desktop/api/iads/nn-iads-iadssecuritydescriptor) utilise les méthodes sur cette interface pour accéder à la liste de contrôle d’accès du descripteur de sécurité.</span><span class="sxs-lookup"><span data-stu-id="22497-114">Call **QueryInterface** on that **IDispatch** pointer to get an [**IADsSecurityDescriptor**](/windows/desktop/api/iads/nn-iads-iadssecuritydescriptor) interface to use the methods on that interface to access the security descriptor's ACL.</span></span>
3.  <span data-ttu-id="22497-115">Utilisez la propriété [**IADsSecurityDescriptor. DiscretionaryAcl**](/windows/desktop/ADSI/iadssecuritydescriptor-property-methods) pour accéder à la liste DACL.</span><span class="sxs-lookup"><span data-stu-id="22497-115">Use the [**IADsSecurityDescriptor.DiscretionaryAcl**](/windows/desktop/ADSI/iadssecuritydescriptor-property-methods) property to get the DACL.</span></span> <span data-ttu-id="22497-116">La méthode retourne un pointeur [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) .</span><span class="sxs-lookup"><span data-stu-id="22497-116">The method returns an [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) pointer.</span></span> <span data-ttu-id="22497-117">Appelez **QueryInterface** sur ce pointeur **IDispatch** pour qu’une interface [**IADsAccessControlList**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrollist) utilise les méthodes sur cette interface pour accéder aux ACE individuelles dans la liste de contrôle d’accès.</span><span class="sxs-lookup"><span data-stu-id="22497-117">Call **QueryInterface** on that **IDispatch** pointer to get an [**IADsAccessControlList**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrollist) interface to use the methods on that interface to access the individual ACEs in the ACL.</span></span>
4.  <span data-ttu-id="22497-118">Utilisez [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) pour créer l’objet com ADSI pour la nouvelle entrée du contrôle d’accès et obtenir un pointeur d’interface [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) vers cet objet.</span><span class="sxs-lookup"><span data-stu-id="22497-118">Use [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) to create the ADSI COM object for the new ACE and get an [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) interface pointer to that object.</span></span> <span data-ttu-id="22497-119">N’oubliez pas que l’ID de classe est CLSID \_ AccessControlEntry.</span><span class="sxs-lookup"><span data-stu-id="22497-119">Be aware that the class ID is CLSID\_AccessControlEntry.</span></span>
5.  <span data-ttu-id="22497-120">Définissez les propriétés de l’entrée du contrôle d’accès à l’aide des méthodes [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) :</span><span class="sxs-lookup"><span data-stu-id="22497-120">Set the properties of the ACE using the [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) methods:</span></span>

    1.  <span data-ttu-id="22497-121">Utilisez [**IADsAccessControlEntry ::p le \_ tiers**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) de confiance pour définir le tiers de confiance auquel s’applique cette entrée du contrôle d’accès.</span><span class="sxs-lookup"><span data-stu-id="22497-121">Use [**IADsAccessControlEntry::put\_Trustee**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) to set the trustee to whom this ACE applies.</span></span> <span data-ttu-id="22497-122">Le tiers de confiance est un utilisateur, un groupe ou un autre principal de sécurité.</span><span class="sxs-lookup"><span data-stu-id="22497-122">The trustee is a user, group, or other security principal.</span></span> <span data-ttu-id="22497-123">Votre application doit utiliser la valeur de la propriété appropriée de l’objet utilisateur ou groupe du tiers de confiance auquel vous souhaitez appliquer l’entrée du contrôle d’accès.</span><span class="sxs-lookup"><span data-stu-id="22497-123">Your application should use the value from the appropriate property from the user or group object of the trustee to which you want to apply the ACE.</span></span> <span data-ttu-id="22497-124">Le tiers de confiance est spécifié en tant que **BSTR** et peut prendre les formes suivantes :</span><span class="sxs-lookup"><span data-stu-id="22497-124">The trustee is specified as a **BSTR** and can take the following forms:</span></span>
        -   <span data-ttu-id="22497-125">Compte de domaine (nom d’ouverture de session utilisé dans une version précédente de Windows NT) sous la forme « <domain> \\ <user account> », où « &lt; domaine &gt; » est le nom du domaine Windows NT qui contient l’utilisateur et « &lt; compte d’utilisateur &gt; » est la propriété **sAMAccountName** de l’utilisateur spécifié.</span><span class="sxs-lookup"><span data-stu-id="22497-125">Domain account (the logon name used in a previous version of Windows NT) of the form "<domain>\\<user account>" where "&lt;domain&gt;" is the name of the Windows NT domain that contains the user and "&lt;user account&gt;" is the **sAMAccountName** property of the specified user.</span></span> <span data-ttu-id="22497-126">Par exemple : « Fabrikam \\ JeffSmith ».</span><span class="sxs-lookup"><span data-stu-id="22497-126">For example: "fabrikam\\jeffsmith".</span></span>
        -   <span data-ttu-id="22497-127">Principal de sécurité connu qui représente des identités spéciales définies par le système de sécurité de Windows NT, telles que tout le monde, système local, Self-principal, utilisateur authentifié, propriétaire créateur, etc.</span><span class="sxs-lookup"><span data-stu-id="22497-127">Well-known security principal that represents special identities defined by the Windows NT security system, such as everyone, local system, principal self, authenticated user, creator owner, and so on.</span></span> <span data-ttu-id="22497-128">Les objets représentant les principaux de sécurité connus sont stockés dans le conteneur de principaux de sécurité connu sous le conteneur de configuration.</span><span class="sxs-lookup"><span data-stu-id="22497-128">The objects representing the well-known security principals are stored in the Well Known Security Principals container beneath the Configuration container.</span></span> <span data-ttu-id="22497-129">Par exemple, ouverture de session anonyme.</span><span class="sxs-lookup"><span data-stu-id="22497-129">For example, anonymous logon.</span></span>
        -   <span data-ttu-id="22497-130">Groupe intégré qui représente les groupes d’utilisateurs intégrés définis par le système de sécurité de Windows NT.</span><span class="sxs-lookup"><span data-stu-id="22497-130">Built-in group that represent the built-in user groups defined by the Windows NT security system.</span></span> <span data-ttu-id="22497-131">Il se présente sous la forme « BUILTIN \\ <group name> », où « &lt; nom &gt; de groupe » est le nom du groupe d’utilisateurs intégré.</span><span class="sxs-lookup"><span data-stu-id="22497-131">It has the form "BUILTIN\\<group name>" where "&lt;group name&gt;" is the name of the built-in user group.</span></span> <span data-ttu-id="22497-132">Les objets représentant les groupes prédéfinis sont stockés dans le conteneur Builtin sous le conteneur de domaine.</span><span class="sxs-lookup"><span data-stu-id="22497-132">The objects representing the built-in groups are stored in the Builtin container beneath the domain container.</span></span> <span data-ttu-id="22497-133">Par exemple, « \\ administrateurs BUILTIN ».</span><span class="sxs-lookup"><span data-stu-id="22497-133">For example, "BUILTIN\\Administrators".</span></span>
        -   <span data-ttu-id="22497-134">SID (format de chaîne) de l’utilisateur spécifié, qui est la propriété **objectSID** de l’utilisateur spécifié.</span><span class="sxs-lookup"><span data-stu-id="22497-134">SID (string format) of the specified user, which is the **objectSID** property of the specified user.</span></span> <span data-ttu-id="22497-135">Vous pouvez convertir au format de chaîne à l’aide de la fonction [**ConvertSidToStringSid a**](/windows/desktop/api/sddl/nf-sddl-convertsidtostringsida) dans l’API de sécurité Win32.</span><span class="sxs-lookup"><span data-stu-id="22497-135">You can convert to string form using the [**ConvertSidToStringSid**](/windows/desktop/api/sddl/nf-sddl-convertsidtostringsida) function in the Win32 Security API.</span></span> <span data-ttu-id="22497-136">Par exemple : « S-1-5-32-548 ».</span><span class="sxs-lookup"><span data-stu-id="22497-136">For example: "S-1-5-32-548".</span></span>
    2.  <span data-ttu-id="22497-137">Utilisez la propriété [**IADsAccessControlEntry. AccessMask**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) pour définir le masque qui spécifie le droit d’accès.</span><span class="sxs-lookup"><span data-stu-id="22497-137">Use the [**IADsAccessControlEntry.AccessMask**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) property to set the mask that specifies the access right.</span></span> <span data-ttu-id="22497-138">L’énumération de l’énumération des [**\_ \_ droits ADS**](/windows/win32/api/iads/ne-iads-ads_rights_enum) spécifie les droits d’accès que vous pouvez définir sur un objet d’annuaire.</span><span class="sxs-lookup"><span data-stu-id="22497-138">The [**ADS\_RIGHTS\_ENUM**](/windows/win32/api/iads/ne-iads-ads_rights_enum) enumeration specifies the access rights you can set on a directory object.</span></span>
    3.  <span data-ttu-id="22497-139">Utilisez la propriété [**IADsAccessControlEntry. AceType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) pour spécifier si vous souhaitez autoriser ou refuser les droits d’accès définis par **AccessMask**.</span><span class="sxs-lookup"><span data-stu-id="22497-139">Use the [**IADsAccessControlEntry.AceType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) property to specify whether to allow or deny the access rights set by **AccessMask**.</span></span> <span data-ttu-id="22497-140">Pour les droits standard, il peut s’agir de **publicités \_ ACETYPE \_ accès \_ autorisé** ou de **publicités \_ ACETYPE \_ accès \_ refusé**.</span><span class="sxs-lookup"><span data-stu-id="22497-140">For standard rights, this can be **ADS\_ACETYPE\_ACCESS\_ALLOWED** or **ADS\_ACETYPE\_ACCESS\_DENIED**.</span></span> <span data-ttu-id="22497-141">Pour les droits spécifiques aux objets (droits qui s’appliquent à une partie spécifique d’un objet ou à un type d’objet spécifique), utilisez les objets **ad \_ ACETYPE \_ Access \_ allowed \_ Object** ou **ad \_ ACETYPE \_ Access \_ denied \_**.</span><span class="sxs-lookup"><span data-stu-id="22497-141">For object-specific rights (rights that apply to a specific part of an object or to a specific type of object), use **ADS\_ACETYPE\_ACCESS\_ALLOWED\_OBJECT** or **ADS\_ACETYPE\_ACCESS\_DENIED\_OBJECT**.</span></span> <span data-ttu-id="22497-142">L’énumération d’énumérations [**\_ \_ ACETYPE ADS**](/windows/win32/api/iads/ne-iads-ads_acetype_enum) spécifie les types d’accès que vous pouvez définir sur une entrée du contrôle d’accès.</span><span class="sxs-lookup"><span data-stu-id="22497-142">The [**ADS\_ACETYPE\_ENUM**](/windows/win32/api/iads/ne-iads-ads_acetype_enum) enumeration specifies the access types you can set on an ACE.</span></span>
    4.  <span data-ttu-id="22497-143">Utilisez la propriété [**IADsAccessControlEntry. AceFlags**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) pour spécifier si d’autres conteneurs ou objets situés sous l’objet spécifié peuvent hériter de l’entrée du contrôle d’accès.</span><span class="sxs-lookup"><span data-stu-id="22497-143">Use the [**IADsAccessControlEntry.AceFlags**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) property to specify whether other containers or objects beneath the specified object can inherit the ACE.</span></span> <span data-ttu-id="22497-144">L’énumération d’énumérations [**\_ \_ ACEFLAG ADS**](/windows/win32/api/iads/ne-iads-ads_aceflag_enum) spécifie les indicateurs d’héritage que vous pouvez définir sur une entrée du contrôle d’accès.</span><span class="sxs-lookup"><span data-stu-id="22497-144">The [**ADS\_ACEFLAG\_ENUM**](/windows/win32/api/iads/ne-iads-ads_aceflag_enum) enumeration specifies the inheritance flags you can set on an ACE.</span></span>
    5.  <span data-ttu-id="22497-145">Utilisez la propriété [**IADsAccessControlEntry. Flags**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) pour spécifier si le droit s’applique à une partie spécifique de l’objet, un type d’objet hérité ou les deux.</span><span class="sxs-lookup"><span data-stu-id="22497-145">Use the [**IADsAccessControlEntry.Flags**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) property to specify whether the right applies to a specific part of the object, an inherited object type, or both.</span></span>
    6.  <span data-ttu-id="22497-146">Si la valeur **Flags** est définie sur le **\_ \_ type d’objet indicateur \_ \_ ADS**, définissez la propriété [**IADsAccessControlEntry. OBJECTTYPE**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) sur spécifiez une chaîne qui contient le GUID de la classe d’objet (pour les **publicités \_ Right \_ DS \_ Create \_ Child** ou **ADS Right supprimer un \_ \_ \_ \_ enfant**), Property, Property Set, valided Write ou Extended Right auquel s’applique l’entrée du contrôle d’accès.</span><span class="sxs-lookup"><span data-stu-id="22497-146">If **Flags** is set to **ADS\_FLAG\_OBJECT\_TYPE\_PRESENT**, set the [**IADsAccessControlEntry.ObjectType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) property o specify a string containing the GUID of the object class (for **ADS\_RIGHT\_DS\_CREATE\_CHILD** or **ADS\_RIGHT\_DS\_DELETE\_CHILD**), property, property set, validated write, or extended right that the ACE applies to.</span></span> <span data-ttu-id="22497-147">Le GUID doit être spécifié sous la forme d’une chaîne sous la forme produite par la fonction [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) dans la bibliothèque com.</span><span class="sxs-lookup"><span data-stu-id="22497-147">The GUID must be specified as a string of the form produced by the [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) function in the COM library.</span></span>
    7.  <span data-ttu-id="22497-148">Si **Flags** est défini sur ADS, le **\_ type d' \_ objet hérité est \_ \_ \_ présent**, définissez la propriété [**IADSACCESSCONTROLENTRY. InheritedObjectType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) pour spécifier une chaîne qui contient le GUID de la classe d’objet héritée à laquelle l’entrée du contrôle d’accès s’applique.</span><span class="sxs-lookup"><span data-stu-id="22497-148">If **Flags** is set to **ADS\_FLAG\_INHERITED\_OBJECT\_TYPE\_PRESENT**, set the [**IADsAccessControlEntry.InheritedObjectType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) property to specify a string that contains the GUID of the inherited object class that the ACE applies to.</span></span> <span data-ttu-id="22497-149">Le GUID doit être spécifié sous la forme d’une chaîne sous la forme produite par la fonction [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) dans la bibliothèque com.</span><span class="sxs-lookup"><span data-stu-id="22497-149">The GUID must be specified as a string of the form produced by the [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) function in the COM library.</span></span>

6.  <span data-ttu-id="22497-150">Utilisez la méthode **QueryInterface** sur l’objet [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) pour récupérer un pointeur [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) .</span><span class="sxs-lookup"><span data-stu-id="22497-150">Use the **QueryInterface** method on the [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) object to get an [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) pointer.</span></span> <span data-ttu-id="22497-151">La méthode [**IADsAccessControlList. AddAce**](/windows/desktop/api/iads/nf-iads-iadsaccesscontrollist-addace) requiert un pointeur d’interface **IDISPATCH** vers l’entrée du contrôle d’accès.</span><span class="sxs-lookup"><span data-stu-id="22497-151">The [**IADsAccessControlList.AddAce**](/windows/desktop/api/iads/nf-iads-iadsaccesscontrollist-addace) method requires an **IDispatch** interface pointer to the ACE.</span></span>
7.  <span data-ttu-id="22497-152">Utilisez [**IADsAccessControlList. AddAce**](/windows/desktop/api/iads/nf-iads-iadsaccesscontrollist-addace) pour ajouter la nouvelle entrée du contrôle d’accès à la liste DACL.</span><span class="sxs-lookup"><span data-stu-id="22497-152">Use [**IADsAccessControlList.AddAce**](/windows/desktop/api/iads/nf-iads-iadsaccesscontrollist-addace) to add the new ACE to the DACL.</span></span> <span data-ttu-id="22497-153">N’oubliez pas que l’ordre des ACE dans la liste de contrôle d’accès peut affecter l’évaluation de l’accès à l’objet.</span><span class="sxs-lookup"><span data-stu-id="22497-153">Be aware that the order of the ACEs within the ACL can affect the evaluation of access to the object.</span></span> <span data-ttu-id="22497-154">Pour un accès correct à l’objet, vous devrez peut-être créer une nouvelle liste de contrôle d’accès, ajouter les entrées du contrôle d’accès de l’ACL existante dans l’ordre approprié à la nouvelle liste de contrôle d’accès, puis remplacer l’ACL existante dans le descripteur de sécurité par la nouvelle liste de contrôle d’accès.</span><span class="sxs-lookup"><span data-stu-id="22497-154">The correct access to the object may require you to create an new ACL, add the ACEs from the existing ACL in the correct order to the new ACL, and then replace the existing ACL in the security descriptor with the new ACL.</span></span> <span data-ttu-id="22497-155">Pour plus d’informations, consultez [ordre des entrées de commande dans une liste DACL](/windows/desktop/SecAuthZ/order-of-aces-in-a-dacl).</span><span class="sxs-lookup"><span data-stu-id="22497-155">For more information, see [Order of ACEs in a DACL](/windows/desktop/SecAuthZ/order-of-aces-in-a-dacl).</span></span>
8.  <span data-ttu-id="22497-156">Utilisez la propriété [**IADsSecurityDescriptor. DiscretionaryAcl**](/windows/desktop/ADSI/iadssecuritydescriptor-property-methods) pour écrire la liste DACL contenant la nouvelle entrée du contrôle d’accès dans le descripteur de sécurité.</span><span class="sxs-lookup"><span data-stu-id="22497-156">Use the [**IADsSecurityDescriptor.DiscretionaryAcl**](/windows/desktop/ADSI/iadssecuritydescriptor-property-methods) property to write the DACL containing the new ACE to the security descriptor.</span></span> <span data-ttu-id="22497-157">Pour plus d’informations sur les DACL, consultez [DACL null et listes DACL vides](null-dacls-and-empty-dacls.md).</span><span class="sxs-lookup"><span data-stu-id="22497-157">For more information about DACLs, see [Null DACLs and Empty DACLs](null-dacls-and-empty-dacls.md).</span></span>
9.  <span data-ttu-id="22497-158">Utilisez la méthode [**IADs. put**](/windows/desktop/api/iads/nf-iads-iads-put) pour écrire le descripteur de sécurité dans la propriété **ntSecurityDescriptor** de l’objet dans le cache de propriétés.</span><span class="sxs-lookup"><span data-stu-id="22497-158">Use the [**IADs.Put**](/windows/desktop/api/iads/nf-iads-iads-put) method to write the security descriptor to the object's **nTSecurityDescriptor** property to the property cache.</span></span>
10. <span data-ttu-id="22497-159">Utilisez la méthode [**IADs. setinfo**](/windows/desktop/api/iads/nf-iads-iads-setinfo) pour mettre à jour la propriété sur l’objet dans le répertoire.</span><span class="sxs-lookup"><span data-stu-id="22497-159">Use the [**IADs.SetInfo**](/windows/desktop/api/iads/nf-iads-iads-setinfo) method to update the property on the object in the directory.</span></span>

 

 