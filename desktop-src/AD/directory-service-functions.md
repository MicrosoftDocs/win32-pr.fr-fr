---
title: Fonctions du service d’annuaire (AD DS)
description: Les fonctions de service d’annuaire fournissent un utilitaire permettant de localiser un contrôleur de domaine (DC) dans un domaine Windows NT ou Windows 2000.
ms.assetid: 7b519c81-5a6c-470a-a525-1894efd53305
ms.tgt_platform: multiple
keywords:
- Fonctions du service d’annuaire
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 75b071128806926e07cf61d62e53b823d8e7e1ac
ms.sourcegitcommit: 8ea1a82717bd3dbb3457be0697329aa37fb13f08
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/11/2019
ms.locfileid: "104030695"
---
# <a name="directory-service-functions-ad-ds"></a><span data-ttu-id="f0814-104">Fonctions du service d’annuaire (AD DS)</span><span class="sxs-lookup"><span data-stu-id="f0814-104">Directory Service Functions (AD DS)</span></span>

<span data-ttu-id="f0814-105">Les fonctions de service d’annuaire fournissent un utilitaire permettant de localiser un contrôleur de domaine (DC) dans un domaine Windows NT ou Windows 2000.</span><span class="sxs-lookup"><span data-stu-id="f0814-105">The directory service functions provide a utility for locating a domain controller (DC) in a Windows NT or Windows 2000 domain.</span></span> <span data-ttu-id="f0814-106">L’architecture interagit avec les clients ainsi que les serveurs dans toutes les versions de Windows NT et Windows 2000.</span><span class="sxs-lookup"><span data-stu-id="f0814-106">The architecture interacts with clients as well as servers in all versions of Windows NT and Windows 2000.</span></span> <span data-ttu-id="f0814-107">Les fonctions suivantes permettent aux développeurs de travailler avec le contrôleur de domaine et l’appartenance à un domaine dans le service d’annuaire :</span><span class="sxs-lookup"><span data-stu-id="f0814-107">The following functions enable developers to work with the domain controller and domain membership in the directory service:</span></span>

-   [<span data-ttu-id="f0814-108">**DsAddressToSiteNames**</span><span class="sxs-lookup"><span data-stu-id="f0814-108">**DsAddressToSiteNames**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsaddresstositenamesa)
-   [<span data-ttu-id="f0814-109">**DsAddressToSiteNamesEx**</span><span class="sxs-lookup"><span data-stu-id="f0814-109">**DsAddressToSiteNamesEx**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsaddresstositenamesexa)
-   [<span data-ttu-id="f0814-110">**DsDeregisterDnsHostRecords**</span><span class="sxs-lookup"><span data-stu-id="f0814-110">**DsDeregisterDnsHostRecords**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsderegisterdnshostrecordsa)
-   [<span data-ttu-id="f0814-111">**DsEnumerateDomainTrusts**</span><span class="sxs-lookup"><span data-stu-id="f0814-111">**DsEnumerateDomainTrusts**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsenumeratedomaintrustsa)
-   [<span data-ttu-id="f0814-112">**DsGetDcClose**</span><span class="sxs-lookup"><span data-stu-id="f0814-112">**DsGetDcClose**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsgetdcclosew)
-   [<span data-ttu-id="f0814-113">**DsGetDcName**</span><span class="sxs-lookup"><span data-stu-id="f0814-113">**DsGetDcName**</span></span>](/windows/desktop/api/DsGetDC/nf-dsgetdc-dsgetdcnamea)
-   [<span data-ttu-id="f0814-114">**DsGetDcNext**</span><span class="sxs-lookup"><span data-stu-id="f0814-114">**DsGetDcNext**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsgetdcnexta)
-   [<span data-ttu-id="f0814-115">**DsGetDcOpen**</span><span class="sxs-lookup"><span data-stu-id="f0814-115">**DsGetDcOpen**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsgetdcopena)
-   [<span data-ttu-id="f0814-116">**DsGetDcSiteCoverage**</span><span class="sxs-lookup"><span data-stu-id="f0814-116">**DsGetDcSiteCoverage**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsgetdcsitecoveragea)
-   [<span data-ttu-id="f0814-117">**DsGetForestTrustInformationW**</span><span class="sxs-lookup"><span data-stu-id="f0814-117">**DsGetForestTrustInformationW**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsgetforesttrustinformationw)
-   [<span data-ttu-id="f0814-118">**DsGetSiteName**</span><span class="sxs-lookup"><span data-stu-id="f0814-118">**DsGetSiteName**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsgetsitenamea)
-   [<span data-ttu-id="f0814-119">**DsMergeForestTrustInformationW**</span><span class="sxs-lookup"><span data-stu-id="f0814-119">**DsMergeForestTrustInformationW**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsmergeforesttrustinformationw)
-   [<span data-ttu-id="f0814-120">**DsRoleFreeMemory**</span><span class="sxs-lookup"><span data-stu-id="f0814-120">**DsRoleFreeMemory**</span></span>](/windows/desktop/api/Dsrole/nf-dsrole-dsrolefreememory)
-   [<span data-ttu-id="f0814-121">**DsRoleGetPrimaryDomainInformation**</span><span class="sxs-lookup"><span data-stu-id="f0814-121">**DsRoleGetPrimaryDomainInformation**</span></span>](/windows/desktop/api/Dsrole/nf-dsrole-dsrolegetprimarydomaininformation)
-   [<span data-ttu-id="f0814-122">**DsValidateSubnetName**</span><span class="sxs-lookup"><span data-stu-id="f0814-122">**DsValidateSubnetName**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsvalidatesubnetnamea)

<span data-ttu-id="f0814-123">Le localisateur de contrôleur de réseau, [**DsGetDcName**](/windows/desktop/api/DsGetDC/nf-dsgetdc-dsgetdcnamea), est implémenté par le service Netlogon.</span><span class="sxs-lookup"><span data-stu-id="f0814-123">The DC locator, [**DsGetDcName**](/windows/desktop/api/DsGetDC/nf-dsgetdc-dsgetdcnamea), is implemented by the Netlogon service.</span></span> <span data-ttu-id="f0814-124">Chaque contrôleur de domaine enregistre son nom DNS sur le serveur DNS et son nom NetBIOS à l’aide d’un mécanisme spécifique au transport, par exemple dans WINS.</span><span class="sxs-lookup"><span data-stu-id="f0814-124">Each DC registers its DNS name on the DNS server and its NetBIOS name using a transport-specific mechanism, for example, in WINS.</span></span> <span data-ttu-id="f0814-125">Le localisateur de contrôleur de périphérique recherche le nom, puis envoie un datagramme à, ou ping, au contrôleur de périphérique qui a enregistré le nom.</span><span class="sxs-lookup"><span data-stu-id="f0814-125">The DC locator looks up the name, then sends a datagram to, or pings, the DC that registered the name.</span></span> <span data-ttu-id="f0814-126">Pour les noms de domaine NetBIOS, le datagramme est un message mailslot.</span><span class="sxs-lookup"><span data-stu-id="f0814-126">For NetBIOS domain names, the datagram is a mailslot message.</span></span> <span data-ttu-id="f0814-127">Pour les noms de domaine DNS, le datagramme est une recherche UDP LDAP.</span><span class="sxs-lookup"><span data-stu-id="f0814-127">For DNS domain names, the datagram is an LDAP UDP search.</span></span> <span data-ttu-id="f0814-128">Chacun de ces DC répond, indiquant qu’il est en cours de fonctionnement.</span><span class="sxs-lookup"><span data-stu-id="f0814-128">Each such DC responds indicating that it is currently operational.</span></span> <span data-ttu-id="f0814-129">Le premier contrôleur de périphérique à répondre est retourné à l’appelant.</span><span class="sxs-lookup"><span data-stu-id="f0814-129">The first DC to respond is returned to the caller.</span></span>

<span data-ttu-id="f0814-130">Le contrôleur de périphérique retourné est mis en cache, de sorte que les appelants suivants n’ont pas besoin de répéter l’algorithme précédent et d’inciter tous les appelants à utiliser ce même contrôleur de périphérique.</span><span class="sxs-lookup"><span data-stu-id="f0814-130">The returned DC is cached, so that subsequent callers need not repeat the preceding algorithm, and to encourage all callers to use that same DC.</span></span> <span data-ttu-id="f0814-131">Cela garantit qu’un seul client dispose d’une vue cohérente du contenu du contrôleur de contenu.</span><span class="sxs-lookup"><span data-stu-id="f0814-131">This ensures that a single client has a consistent view of the contents of the DC.</span></span>

<span data-ttu-id="f0814-132">Lors de la recherche d’un contrôleur de domaine par nom de domaine DNS, le localisateur de contrôleur de domaine tente de trouver un contrôleur de domaine dans le site « le plus proche ».</span><span class="sxs-lookup"><span data-stu-id="f0814-132">When searching for a DC by DNS domain name, the DC locator attempts to find a DC in the "closest" site.</span></span> <span data-ttu-id="f0814-133">Chaque contrôleur de domaine inscrit des enregistrements DNS supplémentaires indiquant le site dans lequel se trouve le contrôleur de domaine et les sites inclus dans le contrôleur de domaine.</span><span class="sxs-lookup"><span data-stu-id="f0814-133">Each DC registers additional DNS records indicating what site that the DC is in and what sites the DC includes.</span></span> <span data-ttu-id="f0814-134">Le localisateur de contrôleur de domaine recherche d’abord cet enregistrement DNS spécifique au site avant de Rechercher l’enregistrement DNS qui n’est pas spécifique à un site, préférant donc un contrôleur de domaine de ce site.</span><span class="sxs-lookup"><span data-stu-id="f0814-134">The DC locator first searches for this site-specific DNS record before searching for the DNS record that is not site-specific, thus preferring a DC in that site.</span></span> <span data-ttu-id="f0814-135">Lorsque le localisateur de contrôleur de domaine envoie un datagramme au contrôleur de domaine, le contrôleur de domaine recherche l’adresse IP du client dans le conteneur Configuration/sites/sous-réseau du service d’annuaire pour trouver un objet de sous-réseau.</span><span class="sxs-lookup"><span data-stu-id="f0814-135">When the DC locator sends a datagram to the DC, the DC looks up the IP address of the client in the Configuration/Sites/Subnet container of the DS to find a subnet object.</span></span> <span data-ttu-id="f0814-136">La propriété **siteObject** de l’objet sous-réseau définit le nom du site qui contient le client.</span><span class="sxs-lookup"><span data-stu-id="f0814-136">The **siteObject** property of the subnet object defines the name of the site that contains the client.</span></span> <span data-ttu-id="f0814-137">Le contrôleur de site répond au test ping avec le nom du site qui contient le client, ainsi qu’un indicateur indiquant si ce contrôleur de site couvre ce site.</span><span class="sxs-lookup"><span data-stu-id="f0814-137">The DC responds to the ping with the name of the site that contains the client, along with an indicator of whether this DC covers that site.</span></span> <span data-ttu-id="f0814-138">Si le contrôleur de site n’inclut pas ce site et que le localisateur de contrôleur de site n’a pas encore trouvé de contrôleur de périphérique dans ce site, le localisateur de contrôleur de site tente à nouveau de trouver un contrôleur de site dans le site.</span><span class="sxs-lookup"><span data-stu-id="f0814-138">If the DC does not include that site and the DC locator has not yet attempted to find a DC in that site, the DC locator tries again to find a DC in the site.</span></span>

<span data-ttu-id="f0814-139">Pour rechercher le nom du site contenant le client, utilisez la fonction [**DsGetSiteName**](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsgetsitenamea) .</span><span class="sxs-lookup"><span data-stu-id="f0814-139">To find the name of the site containing the client, use the [**DsGetSiteName**](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsgetsitenamea) function.</span></span> <span data-ttu-id="f0814-140">Les noms des objets dans le conteneur Configuration/sites/sous-réseau doivent être des noms de sous-réseaux valides.</span><span class="sxs-lookup"><span data-stu-id="f0814-140">The names of the objects in the Configuration/Sites/Subnet container must be valid subnet names.</span></span> <span data-ttu-id="f0814-141">La fonction [**DsValidateSubnetName**](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsvalidatesubnetnamea) indique si un nom de sous-réseau spécifié est valide.</span><span class="sxs-lookup"><span data-stu-id="f0814-141">The [**DsValidateSubnetName**](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsvalidatesubnetnamea) function indicates whether a specified subnet name is valid.</span></span>

 

 




