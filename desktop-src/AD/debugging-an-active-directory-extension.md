---
title: Débogage d’une extension de Active Directory
description: La feuille de propriétés du service Microsoft Active Directory Directory, le menu contextuel et les extensions de l’Assistant Création d’objets documentées dans cette rubrique sont implémentées en tant que serveurs COM in-proc.
ms.assetid: 8c280084-fd2f-4d34-a119-d4e925a68a5c
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4fc8d9646f4ccc2e8c740a81ddb48422881744f5
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/17/2020
ms.locfileid: "104031026"
---
# <a name="debugging-an-active-directory-extension"></a><span data-ttu-id="fcc3d-103">Débogage d’une extension de Active Directory</span><span class="sxs-lookup"><span data-stu-id="fcc3d-103">Debugging an Active Directory Extension</span></span>

<span data-ttu-id="fcc3d-104">La feuille de propriétés du service Microsoft Active Directory Directory, le menu contextuel et les extensions de l’Assistant Création d’objets documentées dans cette rubrique sont implémentées en tant que serveurs COM in-proc.</span><span class="sxs-lookup"><span data-stu-id="fcc3d-104">The Microsoft Active Directory directory service property sheet, context menu, and object creation wizard extensions documented in this topic are implemented as COM in-proc servers.</span></span> <span data-ttu-id="fcc3d-105">Autrement dit, chaque extension est une DLL qui s’exécute dans le contexte du processus hôte.</span><span class="sxs-lookup"><span data-stu-id="fcc3d-105">That is, each extension is a DLL that runs in the context of the host process.</span></span> <span data-ttu-id="fcc3d-106">Pour déboguer l’extension, il est nécessaire d’associer l’extension à une application et d’exécuter l’application dans un débogueur.</span><span class="sxs-lookup"><span data-stu-id="fcc3d-106">To debug the extension, it is necessary to associate the extension with an application and run the application in a debugger.</span></span>

## <a name="debugging-active-directory-extensions-displayed-in-the-windows-shell"></a><span data-ttu-id="fcc3d-107">Débogage d’extensions de Active Directory affichées dans le shell Windows</span><span class="sxs-lookup"><span data-stu-id="fcc3d-107">Debugging Active Directory Extensions Displayed in the Windows Shell</span></span>

<span data-ttu-id="fcc3d-108">Les extensions de Active Directory affichées dans le shell Windows sont chargées dans le contexte du processus de Explorer.exe.</span><span class="sxs-lookup"><span data-stu-id="fcc3d-108">Active Directory extensions displayed in the Windows shell are loaded in the context of the Explorer.exe process.</span></span> <span data-ttu-id="fcc3d-109">Ces extensions peuvent être déboguées comme une extension d’interpréteur de commandes standard.</span><span class="sxs-lookup"><span data-stu-id="fcc3d-109">These extensions can be debugged like a standard shell extension.</span></span> <span data-ttu-id="fcc3d-110">Pour plus d’informations sur le débogage des extensions d’environnement, consultez [débogage avec l’interpréteur](/previous-versions/windows/desktop/legacy/cc144064(v=vs.85))de commandes.</span><span class="sxs-lookup"><span data-stu-id="fcc3d-110">For more information about debugging shell extensions, see [Debugging with the Shell](/previous-versions/windows/desktop/legacy/cc144064(v=vs.85)).</span></span>

## <a name="debugging-active-directory-extensions-displayed-in-the-active-directory-mmc-snap-ins"></a><span data-ttu-id="fcc3d-111">Débogage d’extensions de Active Directory affichées dans le Active Directory MMC Snap-Ins</span><span class="sxs-lookup"><span data-stu-id="fcc3d-111">Debugging Active Directory Extensions Displayed in the Active Directory MMC Snap-Ins</span></span>

<span data-ttu-id="fcc3d-112">Les extensions de Active Directory affichées dans les composants logiciels enfichables MMC d’administration de Active Directory sont chargées dans le contexte de la console MMC (Microsoft Management Console).</span><span class="sxs-lookup"><span data-stu-id="fcc3d-112">Active Directory extensions displayed in the Active Directory administrative MMC snap-ins are loaded in the context of the Microsoft Management Console.</span></span> <span data-ttu-id="fcc3d-113">Pour déboguer une extension, recherchez Mmc.exe sur le système local et définissez le débogueur pour l’utiliser en tant qu’application pour le débogage.</span><span class="sxs-lookup"><span data-stu-id="fcc3d-113">To debug an extension, locate Mmc.exe on the local system and set the debugger to use this as the application for debugging.</span></span> <span data-ttu-id="fcc3d-114">Sur la plupart des systèmes, Mmc.exe se trouve dans le répertoire système de Windows, par exemple, C : \\ winnt \\ system32.</span><span class="sxs-lookup"><span data-stu-id="fcc3d-114">On most systems, Mmc.exe is located in the Windows system directory, for example, C:\\WINNT\\System32.</span></span> <span data-ttu-id="fcc3d-115">Selon le débogueur, vous pouvez être amené à définir la DLL d’extension pour qu’elle soit également chargée par le débogueur.</span><span class="sxs-lookup"><span data-stu-id="fcc3d-115">Depending on the debugger, you may or may not have to set the extension DLL to also be loaded by the debugger.</span></span> <span data-ttu-id="fcc3d-116">De nombreux débogueurs vous permettent également d’attacher le débogueur à un processus MMC en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="fcc3d-116">Many debuggers also allow you to attach the debugger to a running MMC process.</span></span> <span data-ttu-id="fcc3d-117">Pour plus d’informations, consultez le Guide de l’utilisateur du débogueur.</span><span class="sxs-lookup"><span data-stu-id="fcc3d-117">For more information, see your debugger User's Guide.</span></span>

<span data-ttu-id="fcc3d-118">Il peut être commode de charger automatiquement MMC un composant logiciel enfichable spécifique.</span><span class="sxs-lookup"><span data-stu-id="fcc3d-118">It can be convenient to have MMC automatically load a specific snap-in.</span></span> <span data-ttu-id="fcc3d-119">Pour ce faire, définissez les arguments d’application sur le chemin d’accès et le nom de fichier d’un fichier MSC.</span><span class="sxs-lookup"><span data-stu-id="fcc3d-119">To do this, set the application arguments to the path and file name of an MSC file.</span></span> <span data-ttu-id="fcc3d-120">Il peut s’agir d’un fichier MSC installé par le système ou d’un fichier que vous créez.</span><span class="sxs-lookup"><span data-stu-id="fcc3d-120">This can either be a system-installed MSC file or one you create.</span></span> <span data-ttu-id="fcc3d-121">Vous pouvez créer un fichier MSC en procédant comme suit.</span><span class="sxs-lookup"><span data-stu-id="fcc3d-121">An MSC file can be created by following these steps.</span></span>

1.  <span data-ttu-id="fcc3d-122">Exécutez Mmc.exe.</span><span class="sxs-lookup"><span data-stu-id="fcc3d-122">Run Mmc.exe.</span></span>
2.  <span data-ttu-id="fcc3d-123">Chargez le composant logiciel enfichable souhaité en sélectionnant **fichier**  -  **Ajouter/supprimer un composant logiciel enfichable...** dans le menu MMC, puis sélectionnez le composant logiciel enfichable souhaité.</span><span class="sxs-lookup"><span data-stu-id="fcc3d-123">Load the desired snap-in by selecting **File** - **Add/Remove Snap-in...** in the MMC menu and select the desired snap-in.</span></span>
3.  <span data-ttu-id="fcc3d-124">Enregistrez le fichier MSC en sélectionnant **fichier**  -  **Enregistrer sous...** dans le menu MMC.</span><span class="sxs-lookup"><span data-stu-id="fcc3d-124">Save the MSC file by selecting **File** - **Save As...** in the MMC menu.</span></span>

<span data-ttu-id="fcc3d-125">Si vous ne définissez pas de fichier MSC de démarrage, vous devez charger manuellement le composant logiciel enfichable souhaité lorsque vous exécutez l’application dans le débogueur.</span><span class="sxs-lookup"><span data-stu-id="fcc3d-125">If you do not set a start-up MSC file, you must manually load the desired snap-in when you run the application in the debugger.</span></span>

<span data-ttu-id="fcc3d-126">Lorsque l’application hôte est exécutée dans le débogueur, le débogueur peut afficher un message d’avertissement indiquant que l’application en cours d’exécution ne contient pas de symboles de débogage.</span><span class="sxs-lookup"><span data-stu-id="fcc3d-126">When the host application is run in the debugger, the debugger may display a warning message stating that the application being run does not contain any debug symbols.</span></span> <span data-ttu-id="fcc3d-127">Cela est attendu et peut être ignoré en toute sécurité, car vous déboguez en fait la DLL, et non l’application hôte.</span><span class="sxs-lookup"><span data-stu-id="fcc3d-127">This is expected and can safely be ignored because you are actually debugging the DLL, not the host application.</span></span>

<span data-ttu-id="fcc3d-128">Dans la plupart des cas, l’extension n’est pas appelée tant que l’utilisateur n’a pas effectué une action qui entraîne le chargement et l’initialisation de l’extension.</span><span class="sxs-lookup"><span data-stu-id="fcc3d-128">In most cases, the extension will not be called until the user performs some action that causes the extension to be loaded and initialized.</span></span> <span data-ttu-id="fcc3d-129">Par exemple, si vous déboguez une extension de menu contextuel affichée pour les objets utilisateur, l’extension ne se chargera pas tant que le menu contextuel d’un objet utilisateur ne sera pas affiché pour la première fois.</span><span class="sxs-lookup"><span data-stu-id="fcc3d-129">For example, if you are debugging a context menu extension displayed for user objects, the extension will not load until the first time the context menu for a user object is displayed.</span></span>

<span data-ttu-id="fcc3d-130">Vous devez maintenant être en mesure de définir des points d’arrêt et d’afficher la sortie de débogage.</span><span class="sxs-lookup"><span data-stu-id="fcc3d-130">You should now be able to set breakpoints and view debug output.</span></span> <span data-ttu-id="fcc3d-131">Si l’extension n’apparaît pas pour le chargement, définissez un point d’arrêt dans la fonction [**DllGetClassObject**](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) de l’extension.</span><span class="sxs-lookup"><span data-stu-id="fcc3d-131">If the extension does not appear to load, set a breakpoint in the extension's [**DllGetClassObject**](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) function.</span></span> <span data-ttu-id="fcc3d-132">Si **DllGetClassObject** n’est pas appelé, l’extension n’est probablement pas inscrite correctement.</span><span class="sxs-lookup"><span data-stu-id="fcc3d-132">If **DllGetClassObject** is not called, the extension is probably not registered correctly.</span></span>

<span data-ttu-id="fcc3d-133">Une fois le débogage terminé, quittez la console MMC et le débogueur doit se décharger normalement.</span><span class="sxs-lookup"><span data-stu-id="fcc3d-133">When the debug is complete, exit MMC and the debugger should unload normally.</span></span>

 

 