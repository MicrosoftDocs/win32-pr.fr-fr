---
title: Inscription d’un élément de menu contextuel statique
description: Cette rubrique décrit l’inscription d’un élément de menu contextuel statique affiché pour des objets Active Directory.
ms.assetid: ed945812-3adb-4058-bdb6-8d9d34468265
ms.tgt_platform: multiple
keywords:
- Inscription d’un élément de menu contextuel statique AD
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 89e3ee5336061ca296e2c94f8907ebd385610494
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/17/2020
ms.locfileid: "106511481"
---
# <a name="registering-a-static-context-menu-item"></a><span data-ttu-id="dad73-104">Inscription d’un élément de menu contextuel statique</span><span class="sxs-lookup"><span data-stu-id="dad73-104">Registering a Static Context Menu Item</span></span>

<span data-ttu-id="dad73-105">Les composants logiciels enfichables MMC d’administration de Active Directory Domain Services et le shell Windows fournissent un mécanisme pour ajouter un élément au menu contextuel affiché pour les objets dans Active Directory Domain Services.</span><span class="sxs-lookup"><span data-stu-id="dad73-105">The administrative MMC snap-ins of Active Directory Domain Services and the Windows shell provide a mechanism to add an item to the context menu displayed for objects in Active Directory Domain Services.</span></span> <span data-ttu-id="dad73-106">Le menu contextuel peut appeler n’importe quel fichier pouvant être démarré avec l’API [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) , par exemple une URL d’application ou de page Web.</span><span class="sxs-lookup"><span data-stu-id="dad73-106">The context menu can invoke any file that can be started with the [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) API, such as an application or webpage URL.</span></span>

## <a name="registering-with-active-directory-domain-services"></a><span data-ttu-id="dad73-107">Inscription avec Active Directory Domain Services</span><span class="sxs-lookup"><span data-stu-id="dad73-107">Registering with Active Directory Domain Services</span></span>

<span data-ttu-id="dad73-108">L’inscription de l’extension du menu contextuel est spécifique à un paramètre régional.</span><span class="sxs-lookup"><span data-stu-id="dad73-108">Context menu extension registration is specific to one locale.</span></span> <span data-ttu-id="dad73-109">Si l’extension du menu contextuel s’applique à tous les paramètres régionaux, elle doit être inscrite dans l’objet [**displaySpecifier**](/windows/desktop/ADSchema/c-displayspecifier) de la classe d’objet dans tous les sous-conteneurs de paramètres régionaux dans le conteneur de spécificateurs d’affichage.</span><span class="sxs-lookup"><span data-stu-id="dad73-109">If the context menu extension applies to all locales, it must be registered in the object class [**displaySpecifier**](/windows/desktop/ADSchema/c-displayspecifier) object in all of the locale subcontainers in the Display Specifiers container.</span></span> <span data-ttu-id="dad73-110">Si l’extension de menu contextuel est localisée pour certains paramètres régionaux, elle doit être inscrite dans l’objet **displaySpecifier** de ce sous-conteneur de paramètres régionaux.</span><span class="sxs-lookup"><span data-stu-id="dad73-110">If the context menu extension is localized for a certain locale, it must be registered in the **displaySpecifier** object in that locale subcontainer.</span></span> <span data-ttu-id="dad73-111">Pour plus d’informations sur le conteneur et les paramètres régionaux des spécificateurs d’affichage, consultez [spécificateurs d’affichage](display-specifiers.md) et [conteneur DisplaySpecifiers](displayspecifiers-container.md).</span><span class="sxs-lookup"><span data-stu-id="dad73-111">For more information about the Display Specifiers container and locales, see [Display Specifiers](display-specifiers.md) and [DisplaySpecifiers Container](displayspecifiers-container.md).</span></span>

<span data-ttu-id="dad73-112">Il existe deux attributs de spécificateur d’affichage dans lesquels un élément de menu contextuel statique peut être inscrit, [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) et [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu).</span><span class="sxs-lookup"><span data-stu-id="dad73-112">There are two display specifier attributes that a static context menu item can be registered under, [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) and [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu).</span></span>

<span data-ttu-id="dad73-113">L’attribut [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) identifie les menus contextuels d’administration à afficher dans les composants logiciels enfichables d’administration de Active Directory Domain Services.</span><span class="sxs-lookup"><span data-stu-id="dad73-113">The [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) attribute identifies administrative context menus to display in the administrative snap-ins of Active Directory Domain Services.</span></span> <span data-ttu-id="dad73-114">Le menu contextuel s’affiche lorsque l’utilisateur affiche le menu contextuel des objets de la classe appropriée dans l’un des composants logiciels enfichables MMC d’administration.</span><span class="sxs-lookup"><span data-stu-id="dad73-114">The context menu appears when the user displays the context menu for objects of the appropriate class in one of the administrative MMC snap-ins.</span></span>

<span data-ttu-id="dad73-115">L’attribut [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) identifie les menus contextuels de l’utilisateur final à afficher dans le shell Windows.</span><span class="sxs-lookup"><span data-stu-id="dad73-115">The [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) attribute identifies end-user context menus to display in the Windows shell.</span></span> <span data-ttu-id="dad73-116">Le menu contextuel s’affiche lorsque l’utilisateur consulte le menu contextuel des objets de la classe appropriée dans l’Explorateur Windows.</span><span class="sxs-lookup"><span data-stu-id="dad73-116">The context menu appears when the user views the context menu for objects of the appropriate class in the Windows Explorer.</span></span> <span data-ttu-id="dad73-117">À partir de Windows Server 2003, l’interpréteur de commandes Windows n’affiche plus les objets qui proviennent de Active Directory Domain Services.</span><span class="sxs-lookup"><span data-stu-id="dad73-117">Beginning with Windows Server 2003, the Windows shell no longer displays objects that are from Active Directory Domain Services.</span></span>

<span data-ttu-id="dad73-118">Tous ces attributs sont à valeurs multiples.</span><span class="sxs-lookup"><span data-stu-id="dad73-118">All of these attributes are multi-valued.</span></span>

<span data-ttu-id="dad73-119">Lors de l’inscription d’un élément de menu contextuel statique, les valeurs des attributs [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) et [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) requièrent le format suivant.</span><span class="sxs-lookup"><span data-stu-id="dad73-119">When registering a static context menu item, the values for the [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) and [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) attributes require the following format.</span></span>


```C++
<order number>,<menu text>,<command>
```



<span data-ttu-id="dad73-120">« &lt; Order Number &gt; » est un nombre non signé qui représente la position de l’élément dans le menu contextuel.</span><span class="sxs-lookup"><span data-stu-id="dad73-120">The "&lt;order number&gt;" is an unsigned number that represents the item's position in the context menu.</span></span> <span data-ttu-id="dad73-121">Lorsqu’un menu contextuel s’affiche, les valeurs sont triées à l’aide d’une comparaison de la valeur « &lt; Order Number » de chaque valeur &gt; .</span><span class="sxs-lookup"><span data-stu-id="dad73-121">When a context menu is displayed, the values are sorted using a comparison of each value's "&lt;order number&gt;".</span></span> <span data-ttu-id="dad73-122">Si plusieurs valeurs ont le même « numéro de &lt; commande &gt; », ces extensions de menu contextuel sont chargées dans l’ordre dans lequel elles sont lues à partir du serveur de Active Directory.</span><span class="sxs-lookup"><span data-stu-id="dad73-122">If more than one value has the same "&lt;order number&gt;", those context menu extensions are loaded in the order they are read from the Active Directory server.</span></span> <span data-ttu-id="dad73-123">Si possible, utilisez un « numéro d’ordre » non existant &lt; &gt; , autrement dit un « numéro d’ordre » qui n’a pas été utilisé par d’autres valeurs de la propriété.</span><span class="sxs-lookup"><span data-stu-id="dad73-123">If possible, use a non-existing "&lt;order number&gt;", that is, one that has not been used by other values in the property.</span></span> <span data-ttu-id="dad73-124">Il n’y a pas de position de départ prescrite, et les espaces sont autorisés dans la &lt; séquence « Order Number &gt; ».</span><span class="sxs-lookup"><span data-stu-id="dad73-124">There is no prescribed starting position, and gaps are allowed in the "&lt;order number&gt;" sequence.</span></span>

<span data-ttu-id="dad73-125">Le « &lt; texte &gt; de menu » est la chaîne affichée dans le menu contextuel.</span><span class="sxs-lookup"><span data-stu-id="dad73-125">The "&lt;menu text&gt;" is the string displayed in the context menu.</span></span> <span data-ttu-id="dad73-126">Le « &lt; texte &gt; de menu » peut inclure un caractère « & » qui précède le caractère de raccourci clavier pour l’élément de menu.</span><span class="sxs-lookup"><span data-stu-id="dad73-126">The "&lt;menu text&gt;" can include one "&" character that precedes the keyboard shortcut character for the menu item.</span></span> <span data-ttu-id="dad73-127">Le caractère précédée est alors souligné.</span><span class="sxs-lookup"><span data-stu-id="dad73-127">This will cause the preceded character to be underlined.</span></span> <span data-ttu-id="dad73-128">Par exemple, si le « &lt; texte du menu &gt; » est « &fichier », le texte du menu s’affiche sous la forme « fichier », « f » est souligné et « f » est le raccourci clavier de l’élément de menu.</span><span class="sxs-lookup"><span data-stu-id="dad73-128">For example, if the "&lt;menu text&gt;" is "&File", the menu text will be displayed as "File", the "F" will be underlined and "F" will be the keyboard shortcut for the menu item.</span></span>

<span data-ttu-id="dad73-129">« &lt; Command &gt; » est le programme ou le fichier exécuté par le composant logiciel enfichable.</span><span class="sxs-lookup"><span data-stu-id="dad73-129">The "&lt;command&gt;" is the program or file executed by the snap-in.</span></span> <span data-ttu-id="dad73-130">Soit le chemin d’accès complet doit être spécifié, soit le fichier doit exister dans la variable d’environnement du chemin d’accès de l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="dad73-130">Either the full path must be specified or the file must exist in the computer path environment variable.</span></span> <span data-ttu-id="dad73-131">Le fichier est appelé à l’aide de la fonction [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) .</span><span class="sxs-lookup"><span data-stu-id="dad73-131">The file is invoked using the [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) function.</span></span> <span data-ttu-id="dad73-132">La « &lt; commande &gt; » ne peut pas contenir de paramètres supplémentaires, par exemple, Notepad.exe Myfile.txt.</span><span class="sxs-lookup"><span data-stu-id="dad73-132">The "&lt;command&gt;" cannot contain additional parameters, for example, Notepad.exe Myfile.txt.</span></span> <span data-ttu-id="dad73-133">Comme **ShellExecute** est utilisé, tout fichier ou adresse qui peut être passé à **ShellExecute** peut être utilisé pour « &lt; Command &gt; ».</span><span class="sxs-lookup"><span data-stu-id="dad73-133">Because **ShellExecute** is used, any file or address that can be passed to **ShellExecute** can be used for "&lt;command&gt;".</span></span> <span data-ttu-id="dad73-134">Par exemple, si « &lt; Command &gt; » contient « d : \\file.txt », d : \\file.txt sera ouvert avec l’application associée à l’extension. txt.</span><span class="sxs-lookup"><span data-stu-id="dad73-134">For example, if "&lt;command&gt;" contains "d:\\file.txt", d:\\file.txt will be opened with the application associated with the .txt extension.</span></span> <span data-ttu-id="dad73-135">De même, si « &lt; Command &gt; » contient « https://www.fabrikam.com », le navigateur Web par défaut s’ouvre et affiche la page Web spécifiée.</span><span class="sxs-lookup"><span data-stu-id="dad73-135">Likewise, if "&lt;command&gt;" contains "https://www.fabrikam.com", the default web browser is opened and will display the specified webpage.</span></span> <span data-ttu-id="dad73-136">Les chemins d’accès et les noms d’application avec des espaces sont autorisés.</span><span class="sxs-lookup"><span data-stu-id="dad73-136">Paths and application names with spaces are allowed.</span></span> <span data-ttu-id="dad73-137">Si « &lt; Command &gt; » est une application, l’ADsPath et la classe de l’objet sélectionné sont passés en tant qu’arguments de ligne de commande, séparés par un espace.</span><span class="sxs-lookup"><span data-stu-id="dad73-137">If "&lt;command&gt;" is an application, the selected object's ADsPath and class are passed as command line arguments, separated by a space.</span></span>

<span data-ttu-id="dad73-138">Dans le shell Windows, les éléments de menu contextuel à sélection multiple sont pris en charge.</span><span class="sxs-lookup"><span data-stu-id="dad73-138">In the Windows shell, multiple-selection context menu items are supported.</span></span> <span data-ttu-id="dad73-139">Dans ce cas, la « &lt; commande &gt; » est appelée pour chaque objet sélectionné.</span><span class="sxs-lookup"><span data-stu-id="dad73-139">In this case, the "&lt;command&gt;" is invoked for each selected object.</span></span> <span data-ttu-id="dad73-140">Dans Active Directory Domain Services composants logiciels enfichables d’administration, les éléments de menu contextuel statiques à sélection multiple ne sont pas pris en charge.</span><span class="sxs-lookup"><span data-stu-id="dad73-140">In Active Directory Domain Services' administrative snap-ins, multiple-selection static context menu items are not supported.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="dad73-141">Pour le shell Windows, les données du spécificateur d’affichage sont récupérées à l’ouverture de session de l’utilisateur et mises en cache pour la session de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="dad73-141">For the Windows shell, display specifier data is retrieved at user logon and cached for the user's session.</span></span> <span data-ttu-id="dad73-142">Pour les composants logiciels enfichables d’administration, les données du spécificateur d’affichage sont récupérées lorsque le composant logiciel enfichable est chargé et mis en cache pour la durée du processus.</span><span class="sxs-lookup"><span data-stu-id="dad73-142">For the administrative snap-ins, the display specifier data is retrieved when the snap-in is loaded and is cached for the duration of the process.</span></span> <span data-ttu-id="dad73-143">Pour le shell Windows, cela signifie que les modifications apportées aux spécificateurs d’affichage prennent effet une fois qu’un utilisateur se déconnecte puis de nouveau.</span><span class="sxs-lookup"><span data-stu-id="dad73-143">For the Windows shell, this means changes to display specifiers take effect after a user logs off and back on again.</span></span> <span data-ttu-id="dad73-144">Pour les composants logiciels enfichables d’administration, les modifications prennent effet lors du rechargement du composant logiciel enfichable ou de la console. autrement dit, si vous démarrez une nouvelle instance du fichier de console ou d’une nouvelle instance de Mmc.exe et que vous ajoutez le composant logiciel enfichable, les données du spécificateur d’affichage les plus récentes sont récupérées.</span><span class="sxs-lookup"><span data-stu-id="dad73-144">For the administrative snap-ins, changes take effect when the snap-in or console file is reloaded; that is, if you start a new instance of the console file or new Mmc.exe instance and add the snap-in, the latest display specifier data is retrieved.</span></span>

 

<span data-ttu-id="dad73-145">Pour plus d’informations et pour obtenir un exemple de code, consultez [exemple de code pour l’installation d’un élément de menu contextuel statique](example-code-for-installing-a-static-context-menu-item.md).</span><span class="sxs-lookup"><span data-stu-id="dad73-145">For more information, and a code example, see [Example Code for Installing a Static Context Menu Item](example-code-for-installing-a-static-context-menu-item.md).</span></span>

 

 