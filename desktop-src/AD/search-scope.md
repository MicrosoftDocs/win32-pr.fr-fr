---
title: Spécification de l’étendue de recherche
description: Vous pouvez spécifier l’étendue d’une recherche sous la forme d’une recherche de base, d’un niveau ou d’une sous-arborescence.
ms.assetid: b02354c2-7b95-4911-8ae3-4a261d3ca2d3
ms.tgt_platform: multiple
keywords:
- Spécification de l’étendue de recherche Active Directory
- Active Directory, recherche, spécification de l’étendue de recherche
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c7ff076e0410088c69eace25f204241c1c51c6fb
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/17/2020
ms.locfileid: "103724436"
---
# <a name="specifying-the-search-scope"></a><span data-ttu-id="5d6f2-105">Spécification de l’étendue de recherche</span><span class="sxs-lookup"><span data-stu-id="5d6f2-105">Specifying the Search Scope</span></span>

<span data-ttu-id="5d6f2-106">Vous pouvez spécifier l’étendue d’une recherche sous la forme d’une recherche de base, d’un niveau ou d’une sous-arborescence.</span><span class="sxs-lookup"><span data-stu-id="5d6f2-106">You can specify the scope of a search as either a base, one-level, or subtree search.</span></span> <span data-ttu-id="5d6f2-107">Utilisez l’indicateur de la **\_ \_ \_ portée de recherche SEARCHPREF ADS** avec les valeurs de l’énumération [**\_ SCOPEENUM ADS**](/windows/win32/api/iads/ne-iads-ads_scopeenum) pour spécifier l’étendue de recherche.</span><span class="sxs-lookup"><span data-stu-id="5d6f2-107">Use the **ADS\_SEARCHPREF\_SEARCH\_SCOPE** flag with the values of the [**ADS\_SCOPEENUM**](/windows/win32/api/iads/ne-iads-ads_scopeenum) enumeration to specify the search scope.</span></span> <span data-ttu-id="5d6f2-108">La liste suivante contient les descriptions des types de recherche :</span><span class="sxs-lookup"><span data-stu-id="5d6f2-108">The following list includes descriptions of the search types:</span></span>

-   <span data-ttu-id="5d6f2-109">De **base**.</span><span class="sxs-lookup"><span data-stu-id="5d6f2-109">**Base**.</span></span> <span data-ttu-id="5d6f2-110">Une recherche de base limite la recherche à l’objet de base.</span><span class="sxs-lookup"><span data-stu-id="5d6f2-110">A base search limits the search to the base object.</span></span> <span data-ttu-id="5d6f2-111">Le nombre maximal d’objets retournés est toujours un.</span><span class="sxs-lookup"><span data-stu-id="5d6f2-111">The maximum number of objects returned is always one.</span></span> <span data-ttu-id="5d6f2-112">Cette recherche est utile pour vérifier l’existence d’un objet pour la récupération de l’appartenance à un groupe.</span><span class="sxs-lookup"><span data-stu-id="5d6f2-112">This search is useful to verify the existence of an object for retrieving group membership.</span></span> <span data-ttu-id="5d6f2-113">Par exemple, si vous avez un nom unique d’objet et que vous devez vérifier l’existence de l’objet en fonction du chemin d’accès, vous pouvez utiliser une recherche à un niveau.</span><span class="sxs-lookup"><span data-stu-id="5d6f2-113">For example, if you have an object distinguished name, and you must verify the object's existence based on the path, you can use a one-level search.</span></span> <span data-ttu-id="5d6f2-114">Si la recherche échoue, vous pouvez supposer que l’objet a peut-être été renommé ou déplacé vers un autre emplacement, ou que vous avez reçu des informations incorrectes sur l’objet.</span><span class="sxs-lookup"><span data-stu-id="5d6f2-114">If the search fails, you can assume that the object may have been renamed or moved to a different location, or you were given the wrong information about the object.</span></span> <span data-ttu-id="5d6f2-115">N’oubliez pas que vous devez stocker l’identificateur global unique (GUID) de l’objet à la place du nom unique, si vous souhaitez revisiter un objet.</span><span class="sxs-lookup"><span data-stu-id="5d6f2-115">Be aware that you should store the globally unique identifier (GUID) of the object instead of the distinguished name, if you wish to revisit an object.</span></span> <span data-ttu-id="5d6f2-116">Le GUID fait toujours référence au même objet, quel que soit l’emplacement de l’objet dans la hiérarchie de répertoires.</span><span class="sxs-lookup"><span data-stu-id="5d6f2-116">The GUID will always reference the same object, regardless of where the object is located within the directory hierarchy.</span></span>
-   <span data-ttu-id="5d6f2-117">**Un niveau**.</span><span class="sxs-lookup"><span data-stu-id="5d6f2-117">**One-level**.</span></span> <span data-ttu-id="5d6f2-118">Une recherche à un niveau est limitée aux enfants immédiats d’un objet de base, mais exclut l’objet de base lui-même.</span><span class="sxs-lookup"><span data-stu-id="5d6f2-118">A one-level search is restricted to the immediate children of a base object, but excludes the base object itself.</span></span> <span data-ttu-id="5d6f2-119">Ce paramètre peut effectuer une recherche ciblée d’objets enfants immédiats d’un objet parent.</span><span class="sxs-lookup"><span data-stu-id="5d6f2-119">This setting can perform a targeted search for immediate child objects of a parent object.</span></span> <span data-ttu-id="5d6f2-120">Par exemple, considérez un objet parent P1 et ses enfants immédiats : C1, C2 et C3.</span><span class="sxs-lookup"><span data-stu-id="5d6f2-120">For example, consider a parent object P1 and its immediate children: C1, C2, and C3.</span></span> <span data-ttu-id="5d6f2-121">Une recherche à un niveau évalue C1, C2 et C3 par rapport aux critères de recherche, mais n’évalue pas P1.</span><span class="sxs-lookup"><span data-stu-id="5d6f2-121">A one-level search evaluates C1, C2, and C3 against the search criteria, but does not evaluate P1.</span></span> <span data-ttu-id="5d6f2-122">Utilisez une recherche à un niveau pour énumérer tous les enfants d’un objet.</span><span class="sxs-lookup"><span data-stu-id="5d6f2-122">Use a one-level search to enumerate all children of an object.</span></span> <span data-ttu-id="5d6f2-123">Une énumération [**IADsContainer**](/windows/desktop/api/iads/nn-iads-iadscontainer) se traduit par une recherche à un niveau.</span><span class="sxs-lookup"><span data-stu-id="5d6f2-123">An [**IADsContainer**](/windows/desktop/api/iads/nn-iads-iadscontainer) enumeration translates to a one-level search.</span></span>
-   <span data-ttu-id="5d6f2-124">**Sous-arborescence**.</span><span class="sxs-lookup"><span data-stu-id="5d6f2-124">**Subtree**.</span></span> <span data-ttu-id="5d6f2-125">Une recherche de sous-arborescence (ou une recherche profonde) comprend tous les objets enfants, ainsi que l’objet de base.</span><span class="sxs-lookup"><span data-stu-id="5d6f2-125">A subtree search (or a deep search) includes all child objects as well as the base object.</span></span> <span data-ttu-id="5d6f2-126">Vous pouvez demander au fournisseur LDAP de débusquer les références à d’autres services d’annuaire LDAP, y compris d’autres domaines ou forêts d’annuaire.</span><span class="sxs-lookup"><span data-stu-id="5d6f2-126">You can request the LDAP provider to chase referrals to other LDAP directory services, including other directory domains or forests.</span></span>

 

 