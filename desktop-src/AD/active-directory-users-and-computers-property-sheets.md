---
title: Active Directory les utilisateurs et les feuilles de propriétés des ordinateurs
description: Le composant logiciel enfichable MMC utilisateurs et ordinateurs Active Directory est conçu pour afficher une feuille de propriétés pour différents objets dans un serveur Active Directory.
ms.assetid: 38032d89-9549-475c-90aa-dac5cfe11084
ms.tgt_platform: multiple
keywords:
- Active Directory les feuilles de propriétés des utilisateurs et ordinateurs Active Directory
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 30ea24f34e86f21af178e975852accb667bb69e4
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/17/2020
ms.locfileid: "103724668"
---
# <a name="active-directory-users-and-computers-property-sheets"></a><span data-ttu-id="4944d-104">Active Directory les utilisateurs et les feuilles de propriétés des ordinateurs</span><span class="sxs-lookup"><span data-stu-id="4944d-104">Active Directory Users and Computers Property Sheets</span></span>

<span data-ttu-id="4944d-105">Le composant logiciel enfichable MMC utilisateurs et ordinateurs Active Directory est conçu pour afficher une feuille de propriétés pour différents objets dans un serveur Active Directory.</span><span class="sxs-lookup"><span data-stu-id="4944d-105">The Active Directory Users and Computers MMC snap-in is designed to display a property sheet for various objects in an Active Directory server.</span></span> <span data-ttu-id="4944d-106">La feuille de propriétés contient une ou plusieurs pages utilisées pour afficher et modifier les données de l’objet.</span><span class="sxs-lookup"><span data-stu-id="4944d-106">The property sheet contains one or more pages that are used to view and modify object data.</span></span> <span data-ttu-id="4944d-107">Différents types d’objets ont des ensembles de pages différents affichés pour eux.</span><span class="sxs-lookup"><span data-stu-id="4944d-107">Different object types have different sets of pages displayed for them.</span></span> <span data-ttu-id="4944d-108">Le composant logiciel enfichable MMC Active Directory les utilisateurs et les ordinateurs permet également aux fournisseurs tiers d’ajouter des pages personnalisées à la feuille de propriétés pour un type d’objet spécifique.</span><span class="sxs-lookup"><span data-stu-id="4944d-108">The Active Directory Users and Computers MMC snap-in also enables third party vendors to add custom pages to the property sheet for a specific type of object.</span></span> <span data-ttu-id="4944d-109">Pour plus d’informations, consultez [pages de propriétés à utiliser avec les spécificateurs d’affichage](property-pages-for-use-with-display-specifiers.md).</span><span class="sxs-lookup"><span data-stu-id="4944d-109">For more information, see [Property Pages for Use with Display Specifiers](property-pages-for-use-with-display-specifiers.md).</span></span>

<span data-ttu-id="4944d-110">Certaines applications, autres que le composant logiciel enfichable MMC utilisateurs et ordinateurs Active Directory, doivent fournir à l’utilisateur la possibilité d’afficher et de modifier les attributs d’un objet dans un serveur Active Directory.</span><span class="sxs-lookup"><span data-stu-id="4944d-110">Some applications, other than the Active Directory Users and Computers MMC snap-in, must provide the user with the ability view and edit attributes for an object in an Active Directory server.</span></span> <span data-ttu-id="4944d-111">L’application peut implémenter ses propres feuilles de propriétés, mais il est préférable d’offrir une interface utilisateur cohérente pour réduire la confusion et l’apprentissage du temps.</span><span class="sxs-lookup"><span data-stu-id="4944d-111">The application could implement its own property sheets, but it is better to offer a consistent user interface to reduce confusion and learning time.</span></span> <span data-ttu-id="4944d-112">Heureusement, le composant logiciel enfichable MMC Active Directory utilisateurs et ordinateurs permet à n’importe quelle application OLE COM d’afficher une feuille de propriétés pour un objet qui est identique à la feuille de propriétés qui serait affichée par le composant logiciel enfichable MMC utilisateurs et ordinateurs Active Directory pour le même objet.</span><span class="sxs-lookup"><span data-stu-id="4944d-112">Fortunately, the Active Directory Users and Computers MMC snap-in allows any OLE COM application to display a property sheet for an object that is identical to the property sheet that would be displayed by the Active Directory Users and Computers MMC snap-in for the same object.</span></span>

<span data-ttu-id="4944d-113">Pour plus d’informations et pour obtenir un exemple de code qui héberge un Active Directory feuille de propriétés utilisateurs et ordinateurs, consultez l’exemple PropSheetHost dans le kit de développement logiciel (SDK) de la plateforme.</span><span class="sxs-lookup"><span data-stu-id="4944d-113">For more information and a code example that hosts an Active Directory Users and Computers property sheet, see the PropSheetHost sample in the Platform Software Development Kit (SDK).</span></span>

## <a name="developer-audience"></a><span data-ttu-id="4944d-114">Public de développeurs</span><span class="sxs-lookup"><span data-stu-id="4944d-114">Developer Audience</span></span>

<span data-ttu-id="4944d-115">Cette documentation suppose que le lecteur est familiarisé avec l’opération COM et le développement de composants à l’aide de C++.</span><span class="sxs-lookup"><span data-stu-id="4944d-115">This documentation assumes that the reader is familiar with COM operation and component development using C++.</span></span> <span data-ttu-id="4944d-116">Actuellement, il n’est pas possible de créer une extension de feuille de propriétés Active Directory à l’aide de Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="4944d-116">Currently, it is not possible to create an Active Directory property sheet extension using Visual Basic.</span></span>

## <a name="hosting-an-active-directory-users-and-computers-property-sheet"></a><span data-ttu-id="4944d-117">Page de propriétés hébergement d’un Active Directory d’utilisateurs et d’ordinateurs</span><span class="sxs-lookup"><span data-stu-id="4944d-117">Hosting an Active Directory Users and Computers Property Sheet</span></span>

<span data-ttu-id="4944d-118">**Pour afficher une feuille de propriétés pour un objet dans un serveur Active Directory**</span><span class="sxs-lookup"><span data-stu-id="4944d-118">**To display a property sheet for an object in an Active Directory server**</span></span>

1.  <span data-ttu-id="4944d-119">Créer une fenêtre qui peut être utilisée pour traiter des messages.</span><span class="sxs-lookup"><span data-stu-id="4944d-119">Create a window that can be used to process messages.</span></span> <span data-ttu-id="4944d-120">Il peut s’agir d’une fenêtre existante ou d’une fenêtre à usage spécial.</span><span class="sxs-lookup"><span data-stu-id="4944d-120">This can be an existing window or a special purpose window.</span></span> <span data-ttu-id="4944d-121">C’est ce que l’on appelle la *fenêtre masquée*.</span><span class="sxs-lookup"><span data-stu-id="4944d-121">This is known as the *hidden window*.</span></span>
2.  <span data-ttu-id="4944d-122">Créez un objet OLE COM dérivé de [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject).</span><span class="sxs-lookup"><span data-stu-id="4944d-122">Create an OLE COM object that is derived from [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject).</span></span> <span data-ttu-id="4944d-123">Cet objet de données doit prendre en charge les formats de données suivants :</span><span class="sxs-lookup"><span data-stu-id="4944d-123">This data object must support the following data formats:</span></span>

    -   <span data-ttu-id="4944d-124">[**CFSTR \_ DSOBJECTNAMES**](cfstr-dsobjectnames.md) ce format de données contient un [**DSOBJECTNAMES**](/windows/desktop/api/Dsclient/ns-dsclient-dsobjectnames) qui identifie l’objet auquel s’applique la feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="4944d-124">[**CFSTR\_DSOBJECTNAMES**](cfstr-dsobjectnames.md) This data format contains a [**DSOBJECTNAMES**](/windows/desktop/api/Dsclient/ns-dsclient-dsobjectnames) that identifies the object that the property sheet applies to.</span></span> <span data-ttu-id="4944d-125">Lors de l’hébergement d’une feuille de propriétés, les membres les plus significatifs de la structure **DSOBJECTNAMES** sont affichés dans la liste suivante.</span><span class="sxs-lookup"><span data-stu-id="4944d-125">When hosting a property sheet, the more significant members of the **DSOBJECTNAMES** structure are shown in the following list.</span></span>

        <span data-ttu-id="4944d-126">**clsidNamespace** Réservé.</span><span class="sxs-lookup"><span data-stu-id="4944d-126">**clsidNamespace** Reserved.</span></span> <span data-ttu-id="4944d-127">Définissez cette valeur sur un GUID pour votre application dans le cas où elle sera utilisée à l’avenir.</span><span class="sxs-lookup"><span data-stu-id="4944d-127">Set this to a GUID for your application here in case that it is used in the future.</span></span>
        
        <span data-ttu-id="4944d-128">**aObjects** Contient un tableau de structures [**DSBOJECT**](/windows/desktop/api/Dsclient/ns-dsclient-dsobject) .</span><span class="sxs-lookup"><span data-stu-id="4944d-128">**aObjects** Contains an array of [**DSBOJECT**](/windows/desktop/api/Dsclient/ns-dsclient-dsobject) structures.</span></span> <span data-ttu-id="4944d-129">Chaque structure **DSBOJECT** représente un objet d’annuaire unique.</span><span class="sxs-lookup"><span data-stu-id="4944d-129">Each **DSBOJECT** structure represents a single directory object.</span></span> <span data-ttu-id="4944d-130">Le membre **CItems** contient le nombre d’éléments dans le tableau.</span><span class="sxs-lookup"><span data-stu-id="4944d-130">The **cItems** member contains the number of elements in the array.</span></span> <span data-ttu-id="4944d-131">Seul le premier objet de ce tableau est utilisé.</span><span class="sxs-lookup"><span data-stu-id="4944d-131">Only the first object in this array is used.</span></span> <span data-ttu-id="4944d-132">Les autres objets sont ignorés.</span><span class="sxs-lookup"><span data-stu-id="4944d-132">Other objects are ignored.</span></span>

    -   <span data-ttu-id="4944d-133">[**CFSTR \_ DSDISPLAYSPECOPTIONS**](cfstr-ds-display-spec-options.md) ce format de données contient une structure [**DSDISPLAYSPECOPTIONS**](/windows/desktop/api/Dsclient/ns-dsclient-dsdisplayspecoptions) qui contient les données qui seront utilisées par les pages de propriétés, telles que l’emplacement de chargement des pages de propriétés, le serveur et les informations d’identification à utiliser, etc.</span><span class="sxs-lookup"><span data-stu-id="4944d-133">[**CFSTR\_DSDISPLAYSPECOPTIONS**](cfstr-ds-display-spec-options.md) This data format contains a [**DSDISPLAYSPECOPTIONS**](/windows/desktop/api/Dsclient/ns-dsclient-dsdisplayspecoptions) structure that contains data that will be used by the property pages, such as where to load the property pages from, the server and credentials to use, and so on.</span></span> <span data-ttu-id="4944d-134">Les membres les plus significatifs du **DSDISPLAYSPECOPTIONS** sont affichés dans la liste suivante.</span><span class="sxs-lookup"><span data-stu-id="4944d-134">The more significant members of the **DSDISPLAYSPECOPTIONS** are shown in the following list.</span></span>

        <span data-ttu-id="4944d-135">**offsetAttribPrefix** La chaîne de préfixe d’attribut détermine l’emplacement de la liste des pages de propriétés.</span><span class="sxs-lookup"><span data-stu-id="4944d-135">**offsetAttribPrefix** The attribute prefix string determines where the list of property pages is obtained.</span></span> <span data-ttu-id="4944d-136">Il doit contenir l’une des chaînes suivantes.</span><span class="sxs-lookup"><span data-stu-id="4944d-136">This must contain one of the following strings.</span></span>

        

        | <span data-ttu-id="4944d-137">Chaîne de préfixe d’attribut</span><span class="sxs-lookup"><span data-stu-id="4944d-137">Attribute prefix string</span></span> | <span data-ttu-id="4944d-138">Description</span><span class="sxs-lookup"><span data-stu-id="4944d-138">Description</span></span>                                              |
        |-------------------------|----------------------------------------------------------------------------------------------------------------------|
        | <span data-ttu-id="4944d-139">« admin »</span><span class="sxs-lookup"><span data-stu-id="4944d-139">"admin"</span></span><br/>      | <span data-ttu-id="4944d-140">Les pages de propriétés sont chargées à partir de l’attribut [**adminPropertyPages**](/windows/desktop/ADSchema/a-adminpropertypages) .</span><span class="sxs-lookup"><span data-stu-id="4944d-140">The property pages are loaded from the [**adminPropertyPages**](/windows/desktop/ADSchema/a-adminpropertypages) attribute.</span></span><br/> |
        | <span data-ttu-id="4944d-141">Shell</span><span class="sxs-lookup"><span data-stu-id="4944d-141">"shell"</span></span><br/>      | <span data-ttu-id="4944d-142">Les pages de propriétés sont chargées à partir de l’attribut [**shellPropertyPages**](/windows/desktop/ADSchema/a-shellpropertypages) .</span><span class="sxs-lookup"><span data-stu-id="4944d-142">The property pages are loaded from the [**shellPropertyPages**](/windows/desktop/ADSchema/a-shellpropertypages) attribute.</span></span><br/> |

        


    -   <span data-ttu-id="4944d-143">[**CFSTR \_ DS \_ PROPSHEETCONFIG**](cfstr-ds-propsheetconfig.md) ce format de données contient une structure [**PROPSHEETCFG**](propsheetcfg.md) qui contient les données de l’hôte de feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="4944d-143">[**CFSTR\_DS\_PROPSHEETCONFIG**](cfstr-ds-propsheetconfig.md) This data format contains a [**PROPSHEETCFG**](propsheetcfg.md) structure that contains property sheet host data.</span></span> <span data-ttu-id="4944d-144">Lors de l’hébergement d’une feuille de propriétés, les membres les plus significatifs de la structure **PROPSHEETCFG** contiennent les données affichées dans la liste suivante.</span><span class="sxs-lookup"><span data-stu-id="4944d-144">When hosting a property sheet, the more significant members of the **PROPSHEETCFG** structure contain the data shown in the following list.</span></span>

        <span data-ttu-id="4944d-145">**lNotifyHandle** Doit être égal à zéro.</span><span class="sxs-lookup"><span data-stu-id="4944d-145">**lNotifyHandle** Must be zero.</span></span>
        <span data-ttu-id="4944d-146">**hwndParentSheet**  Contient le handle de la fenêtre qui reçoit les messages de [**\_ modification de \_ notification \_ WM ADSPROP**](wm-adsprop-notify-change.md) quand une partie de l’une des pages change et est appliquée.</span><span class="sxs-lookup"><span data-stu-id="4944d-146">**hwndParentSheet**  Contains the handle of the window to receive [**WM\_ADSPROP\_NOTIFY\_CHANGE**](wm-adsprop-notify-change.md) messages when something in one of the pages changes and is applied.</span></span> <span data-ttu-id="4944d-147">Peut avoir la **valeur null** si ce message n’est pas souhaité.</span><span class="sxs-lookup"><span data-stu-id="4944d-147">Can be **NULL** if this message is not desired.</span></span>

        <span data-ttu-id="4944d-148">**hwndHidden** Contient le descripteur de la fenêtre pour recevoir les messages de notification de la feuille de calcul de la feuille de calcul [**WM \_ DSA \_ \_ \_**](wm-dsa-sheet-create-notify.md) et [**WM \_ DSA \_ \_ \_**](wm-dsa-sheet-close-notify.md) .</span><span class="sxs-lookup"><span data-stu-id="4944d-148">**hwndHidden** Contains the handle of the window to receive [**WM\_DSA\_SHEET\_CREATE\_NOTIFY**](wm-dsa-sheet-create-notify.md) and [**WM\_DSA\_SHEET\_CLOSE\_NOTIFY**](wm-dsa-sheet-close-notify.md) messages.</span></span> <span data-ttu-id="4944d-149">Définissez cette valeur sur le handle de votre fenêtre masquée.</span><span class="sxs-lookup"><span data-stu-id="4944d-149">Set this to the handle of your hidden window.</span></span>

        <span data-ttu-id="4944d-150">**wParamSheetClose** Contient un identificateur défini par l’application qui est retourné dans *wParam* dans le message de fermeture de la feuille de calcul [**WM \_ DSA \_ \_ \_**](wm-dsa-sheet-close-notify.md) .</span><span class="sxs-lookup"><span data-stu-id="4944d-150">**wParamSheetClose** Contains an application-defined identifier that is returned in the *wParam* in the [**WM\_DSA\_SHEET\_CLOSE\_NOTIFY**](wm-dsa-sheet-close-notify.md) message.</span></span> <span data-ttu-id="4944d-151">Si ce membre est égal à zéro, le message de fermeture de la **\_ \_ feuille \_ \_ DSA DSA** n’est pas publié dans la fenêtre masquée.</span><span class="sxs-lookup"><span data-stu-id="4944d-151">If this member is zero, the **WM\_DSA\_SHEET\_CLOSE\_NOTIFY** message will not be posted to the hidden window.</span></span>


3.  <span data-ttu-id="4944d-152">Créez une instance de l' [**objet \_ DsPropertyPages CLSID**](guids-of-user-interface-elements.md) et obtenez l’interface [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) pour l’objet.</span><span class="sxs-lookup"><span data-stu-id="4944d-152">Create an instance of the [**CLSID\_DsPropertyPages**](guids-of-user-interface-elements.md) object and obtain the [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) interface for the object.</span></span> <span data-ttu-id="4944d-153">Il est également possible de dupliquer le comportement de l’objet **CLSID \_ DsPropertyPages** .</span><span class="sxs-lookup"><span data-stu-id="4944d-153">It is also possible to duplicate the behavior of the **CLSID\_DsPropertyPages** object.</span></span> <span data-ttu-id="4944d-154">Pour plus d’informations, consultez duplication du comportement de l' \_ objet CLSID DsPropertyPages.</span><span class="sxs-lookup"><span data-stu-id="4944d-154">For more information, see Duplicating the Behavior of the CLSID\_DsPropertyPages Object.</span></span>
4.  <span data-ttu-id="4944d-155">Initialisez l’objet [**CLSID \_ DsPropertyPages**](guids-of-user-interface-elements.md) en appelant la méthode [**IShellExtInit :: Initialize**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) .</span><span class="sxs-lookup"><span data-stu-id="4944d-155">Initialize the [**CLSID\_DsPropertyPages**](guids-of-user-interface-elements.md) object by calling the [**IShellExtInit::Initialize**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) method.</span></span> <span data-ttu-id="4944d-156">Les paramètres *pidlFolder* et *hkeyProgID* ne sont pas utilisés dans cette méthode.</span><span class="sxs-lookup"><span data-stu-id="4944d-156">The *pidlFolder* and *hkeyProgID* parameters are not used in this method.</span></span> <span data-ttu-id="4944d-157">Le paramètre *pdtobj* est le pointeur vers l’objet de données créé à l’étape 2.</span><span class="sxs-lookup"><span data-stu-id="4944d-157">The *pdtobj* parameter is the pointer to the data object created in Step 2.</span></span> <span data-ttu-id="4944d-158">Quand la méthode **IShellExtInit :: Initialize** est appelée, l’objet **CLSID \_ DsPropertyPages** enregistre une référence à l’objet de données.</span><span class="sxs-lookup"><span data-stu-id="4944d-158">When the **IShellExtInit::Initialize** method is called, the **CLSID\_DsPropertyPages** object will save a reference to the data object.</span></span>
5.  <span data-ttu-id="4944d-159">Obtenez l’interface [**IShellPropSheetExt**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext) pour l’objet [**CLSID \_ DsPropertyPages**](guids-of-user-interface-elements.md) et appelez la méthode [**IShellPropSheetExt :: AddPages**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) .</span><span class="sxs-lookup"><span data-stu-id="4944d-159">Obtain the [**IShellPropSheetExt**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext) interface for the [**CLSID\_DsPropertyPages**](guids-of-user-interface-elements.md) object and call the [**IShellPropSheetExt::AddPages**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) method.</span></span> <span data-ttu-id="4944d-160">Le paramètre *lpfnAddPage* est l’adresse d’une fonction de rappel que vous devez implémenter.</span><span class="sxs-lookup"><span data-stu-id="4944d-160">The *lpfnAddPage* parameter is the address of a callback function that you must implement.</span></span> <span data-ttu-id="4944d-161">Le format de cette fonction est illustré ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="4944d-161">The format of this function is shown below.</span></span> <span data-ttu-id="4944d-162">Si la fonction de rappel est déclarée en tant que membre d’une classe C++, la fonction de rappel doit être déclarée comme **static**.</span><span class="sxs-lookup"><span data-stu-id="4944d-162">If the callback function is declared as a member of a C++ class, the callback function must be declared as **static**.</span></span> <span data-ttu-id="4944d-163">Le paramètre *lParam* est une valeur définie par l’application qui peut être utilisée pour identifier l’objet qui implémente la fonction de rappel.</span><span class="sxs-lookup"><span data-stu-id="4944d-163">The *lParam* parameter is an application-defined value that can be used to identify the object that implements the callback function.</span></span> <span data-ttu-id="4944d-164">Quand la méthode **IShellPropSheetExt :: AddPages** est appelée, l’objet **CLSID \_ DsPropertyPages** obtient les données de l’objet de données et énumère les pages de propriétés inscrites pour les spécificateurs d’affichage de l’objet.</span><span class="sxs-lookup"><span data-stu-id="4944d-164">When the **IShellPropSheetExt::AddPages** method is called, the **CLSID\_DsPropertyPages** object will obtain the data from the data object and enumerate the property pages registered for the object display specifiers.</span></span> <span data-ttu-id="4944d-165">L’objet **CLSID \_ DsPropertyPages** énumère ensuite les objets page de propriétés, en appelant la méthode **IShellPropSheetExt :: AddPages** de chaque objet.</span><span class="sxs-lookup"><span data-stu-id="4944d-165">The **CLSID\_DsPropertyPages** object will then enumerate the property page objects, calling each object's **IShellPropSheetExt::AddPages** method.</span></span>

    ```C++
    BOOL CALLBACK AddPagesCallback(HPROPSHEETPAGE, LPARAM)
    ```

    

6.  <span data-ttu-id="4944d-166">Chaque page ajoutée par les objets page de propriétés entraînera l’appel de votre fonction de rappel avec le handle vers la page de propriétés et la valeur définie par l’application.</span><span class="sxs-lookup"><span data-stu-id="4944d-166">Each page added by the property page objects will result in your callback function being called with the handle to the property page and the application-defined value.</span></span> <span data-ttu-id="4944d-167">Votre fonction de rappel doit stocker chaque descripteur de page de propriétés qui est passé.</span><span class="sxs-lookup"><span data-stu-id="4944d-167">Your callback function must store each property page handle that is passed.</span></span> <span data-ttu-id="4944d-168">Lorsque la méthode [**IShellPropSheetExt :: AddPages**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) de l’objet [**CLSID \_ DsPropertyPages**](guids-of-user-interface-elements.md) est retournée, toutes les pages ont été ajoutées via votre fonction de rappel.</span><span class="sxs-lookup"><span data-stu-id="4944d-168">When the [**CLSID\_DsPropertyPages**](guids-of-user-interface-elements.md) object's [**IShellPropSheetExt::AddPages**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) method returns, all pages will have been added via your callback function.</span></span>
7.  <span data-ttu-id="4944d-169">Remplissez une structure [**PROPSHEETHEADER**](/windows/win32/api/prsht/ns-prsht-propsheetheadera_v2) pour afficher la feuille de propriétés.</span><span class="sxs-lookup"><span data-stu-id="4944d-169">Fill in a [**PROPSHEETHEADER**](/windows/win32/api/prsht/ns-prsht-propsheetheadera_v2) structure to display the property sheet.</span></span> <span data-ttu-id="4944d-170">Le membre **phpage** reçoit un pointeur vers un tableau de handles de page qui ont été collectés par votre fonction de rappel.</span><span class="sxs-lookup"><span data-stu-id="4944d-170">The **phpage** member receives a pointer to an array of page handles that were collected by your callback function.</span></span> <span data-ttu-id="4944d-171">Le membre **nPages** reçoit le nombre de pages dans le tableau de handles de page.</span><span class="sxs-lookup"><span data-stu-id="4944d-171">The **nPages** member receives the number of pages in the page handle array.</span></span>
8.  <span data-ttu-id="4944d-172">Affichez la feuille de propriétés en appelant la fonction [**feuille**](/windows/win32/api/prsht/nf-prsht-propertysheeta) .</span><span class="sxs-lookup"><span data-stu-id="4944d-172">Display the property sheet by calling the [**PropertySheet**](/windows/win32/api/prsht/nf-prsht-propertysheeta) function.</span></span>

<span data-ttu-id="4944d-173">Si les données de n’importe quelle page sont modifiées et que l’utilisateur clique sur les boutons **OK** ou **appliquer** , la fenêtre identifiée par le membre **hwndParentSheet** de la structure [**PROPSHEETCFG**](propsheetcfg.md) reçoit un message de [**notification de \_ \_ \_ modification WM ADSPROP**](wm-adsprop-notify-change.md) .</span><span class="sxs-lookup"><span data-stu-id="4944d-173">If the data in any page is changed and the **OK** or **Apply** buttons are clicked, the window identified by the **hwndParentSheet** member of the [**PROPSHEETCFG**](propsheetcfg.md) structure will receive a [**WM\_ADSPROP\_NOTIFY\_CHANGE**](wm-adsprop-notify-change.md) message.</span></span> <span data-ttu-id="4944d-174">Ce message est strictement une notification et ne nécessite aucune action spécifique.</span><span class="sxs-lookup"><span data-stu-id="4944d-174">This message is strictly a notification and requires no specific action.</span></span>

<span data-ttu-id="4944d-175">Lorsque la page est fermée, la fenêtre identifiée par le membre **hwndHidden** de la structure [**PROPSHEETCFG**](propsheetcfg.md) reçoit un message de fermeture de la feuille de calcul [**WM \_ \_ \_ \_ DSA**](wm-dsa-sheet-close-notify.md) .</span><span class="sxs-lookup"><span data-stu-id="4944d-175">When the page is closed, the window identified by the **hwndHidden** member of the [**PROPSHEETCFG**](propsheetcfg.md) structure will receive a [**WM\_DSA\_SHEET\_CLOSE\_NOTIFY**](wm-dsa-sheet-close-notify.md) message.</span></span> <span data-ttu-id="4944d-176">Ce message est strictement une notification et ne nécessite pas l’exécution d’une action spécifique.</span><span class="sxs-lookup"><span data-stu-id="4944d-176">This message is strictly a notification and requires no specific action to be performed.</span></span>

<span data-ttu-id="4944d-177">Dans certains cas, les feuilles de propriétés existantes doivent afficher une feuille de propriétés secondaire.</span><span class="sxs-lookup"><span data-stu-id="4944d-177">In some cases, the existing property sheets will need to display a secondary property sheet.</span></span> <span data-ttu-id="4944d-178">Par exemple, si vous affichez la feuille de propriétés d’un objet utilisateur et que vous sélectionnez la page **membre de** , une liste des groupes dont l’utilisateur est membre s’affiche.</span><span class="sxs-lookup"><span data-stu-id="4944d-178">For example, if you display the property sheet for a user object and select the **Member Of** page, a list of groups that the user is a member of will be displayed.</span></span> <span data-ttu-id="4944d-179">Si vous double-cliquez sur l’un de ces groupes dans la liste, la feuille de propriétés de ce groupe s’affiche.</span><span class="sxs-lookup"><span data-stu-id="4944d-179">If you double-click one of these groups in the list, the property sheet for that group will be displayed.</span></span> <span data-ttu-id="4944d-180">La feuille de propriétés principale n’affiche pas la feuille secondaire seule.</span><span class="sxs-lookup"><span data-stu-id="4944d-180">The primary property sheet does not display the secondary sheet by itself.</span></span> <span data-ttu-id="4944d-181">Elle demande à l’hôte d’afficher la feuille secondaire en envoyant un message de notification de création de la feuille de données [**WM \_ DSA \_ \_ \_**](wm-dsa-sheet-create-notify.md) à la fenêtre identifiée par le membre **hwndHidden** de la structure [**PROPSHEETCFG**](propsheetcfg.md) .</span><span class="sxs-lookup"><span data-stu-id="4944d-181">It requests that the host display the secondary sheet by sending a [**WM\_DSA\_SHEET\_CREATE\_NOTIFY**](wm-dsa-sheet-create-notify.md) message to the window identified by the **hwndHidden** member of the [**PROPSHEETCFG**](propsheetcfg.md) structure.</span></span> <span data-ttu-id="4944d-182">Le *wParam* de la **\_ feuille DSA \_ DSA \_ créer \_** un message Notify est un pointeur vers une structure d' [**\_ informations de \_ page \_ DSA sec**](dsa-sec-page-info.md) qui contient des informations sur la feuille de propriétés secondaire et l’objet qu’elle représente.</span><span class="sxs-lookup"><span data-stu-id="4944d-182">The *wParam* of the **WM\_DSA\_SHEET\_CREATE\_NOTIFY** message is a pointer to a [**DSA\_SEC\_PAGE\_INFO**](dsa-sec-page-info.md) structure that contains information about the secondary property sheet and the object that it represents.</span></span> <span data-ttu-id="4944d-183">En réponse à ce message, l’hôte de feuille de propriétés doit afficher la feuille de propriétés secondaire de la même manière que celle présentée ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="4944d-183">In response to this message, the property sheet host must display the secondary property sheet in the same manner as shown above.</span></span> <span data-ttu-id="4944d-184">Après le traitement du message de notification de création de la **\_ \_ feuille \_ \_ DSA DSA** , le récepteur du message doit libérer la structure des informations de la **\_ \_ page \_ DSA sec** en passant la valeur *wParam* à la fonction [**LocalFree**](/windows/desktop/api/winbase/nf-winbase-localfree) .</span><span class="sxs-lookup"><span data-stu-id="4944d-184">After processing the **WM\_DSA\_SHEET\_CREATE\_NOTIFY** message, the message receiver must free the **DSA\_SEC\_PAGE\_INFO** structure by passing the *wParam* value to the [**LocalFree**](/windows/desktop/api/winbase/nf-winbase-localfree) function.</span></span>

## <a name="duplicating-the-behavior-of-the-clsid_dspropertypages-object"></a><span data-ttu-id="4944d-185">Duplication du comportement de l' \_ objet DSPROPERTYPAGES CLSID</span><span class="sxs-lookup"><span data-stu-id="4944d-185">Duplicating the Behavior of the CLSID\_DsPropertyPages Object</span></span>

<span data-ttu-id="4944d-186">**Pour dupliquer le comportement de l' \_ objet CLSID DsPropertyPages**</span><span class="sxs-lookup"><span data-stu-id="4944d-186">**To duplicate the behavior of the CLSID\_DsPropertyPages object**</span></span>

1.  <span data-ttu-id="4944d-187">Énumérez les valeurs de l’attribut [**adminPropertyPages**](/windows/desktop/ADSchema/a-adminpropertypages) ou [**shellPropertyPages**](/windows/desktop/ADSchema/a-shellpropertypages) pour le spécificateur d’affichage pour la classe d’objet.</span><span class="sxs-lookup"><span data-stu-id="4944d-187">Enumerate the values in the [**adminPropertyPages**](/windows/desktop/ADSchema/a-adminpropertypages) or [**shellPropertyPages**](/windows/desktop/ADSchema/a-shellpropertypages) attribute for the display specifier for the object class.</span></span> <span data-ttu-id="4944d-188">Chaque valeur est une chaîne qui contient un nombre, suivi d’une virgule, suivi de la représentation sous forme de chaîne de l’identificateur de classe de l’extension de la page de propriétés.</span><span class="sxs-lookup"><span data-stu-id="4944d-188">Each value is a string that contains a number, followed by a comma, followed by the string representation of the class identifier of the property page extension.</span></span> <span data-ttu-id="4944d-189">Pour plus d’informations sur le format des valeurs du spécificateur d’affichage des pages de propriétés, consultez [inscription de l’objet com de la page de propriétés dans un spécificateur d’affichage](registering-the-property-page-com-object-in-a-display-specifier.md).</span><span class="sxs-lookup"><span data-stu-id="4944d-189">For more information about the format of the property pages display specifier values, see [Registering the Property Page COM Object in a Display Specifier](registering-the-property-page-com-object-in-a-display-specifier.md).</span></span>
2.  <span data-ttu-id="4944d-190">Convertissez chaque chaîne d’identificateur de classe en **CLSID** à l’aide de la fonction [**CLSIDFromString**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) .</span><span class="sxs-lookup"><span data-stu-id="4944d-190">Convert each class identifier string into a **CLSID** using the [**CLSIDFromString**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) function.</span></span>
3.  <span data-ttu-id="4944d-191">Triez les identificateurs de classe d’extension par le nombre qui précède chaque chaîne d’identificateur de classe dans la valeur de l’attribut.</span><span class="sxs-lookup"><span data-stu-id="4944d-191">Sort the extension class identifiers by the number that precedes each class identifier string in the attribute value.</span></span> <span data-ttu-id="4944d-192">Si deux nombres sont identiques, triez les identificateurs de classe dans l’ordre dans lequel les valeurs d’attribut sont obtenues à partir du serveur de Active Directory.</span><span class="sxs-lookup"><span data-stu-id="4944d-192">If two numbers are identical, sort the class identifiers in the order that the attribute values are obtained from the Active Directory server.</span></span>
4.  <span data-ttu-id="4944d-193">Énumérez les identificateurs de classe d’extension, en créant une instance de chaque extension.</span><span class="sxs-lookup"><span data-stu-id="4944d-193">Enumerate the extension class identifiers, creating an instance of each extension.</span></span>
5.  <span data-ttu-id="4944d-194">Pour chaque extension, dans l’ordre indiqué ci-dessus, appelez [**IShellExtInit :: Initialize**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) de l’extension à l’aide des mêmes informations que celles décrites à l’étape 4 de la procédure de la feuille de propriétés hébergement d’un Active Directory utilisateurs et ordinateurs.</span><span class="sxs-lookup"><span data-stu-id="4944d-194">For each extension, in the order sorted above, call the extension's [**IShellExtInit::Initialize**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) with the same information described in Step 4 of the Hosting an Active Directory Users and Computers Property Sheet procedure.</span></span>
6.  <span data-ttu-id="4944d-195">Pour chaque extension, dans l’ordre indiqué ci-dessus, appelez [**IShellPropSheetExt :: AddPages**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) de l’extension avec les mêmes informations que celles décrites à l’étape 5 de la procédure de la feuille de propriétés hébergement d’un Active Directory utilisateurs et ordinateurs.</span><span class="sxs-lookup"><span data-stu-id="4944d-195">For each extension, in the order sorted above, call the extension's [**IShellPropSheetExt::AddPages**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) with the same information described in Step 5 of the Hosting an Active Directory Users and Computers Property Sheet procedure.</span></span>

<span data-ttu-id="4944d-196">Si possible, utilisez l’objet [**CLSID \_ DsPropertyPages**](guids-of-user-interface-elements.md) pour créer les pages au lieu de le faire manuellement.</span><span class="sxs-lookup"><span data-stu-id="4944d-196">If possible, use the [**CLSID\_DsPropertyPages**](guids-of-user-interface-elements.md) object to create the pages rather than do this manually.</span></span> <span data-ttu-id="4944d-197">Le **\_ DsPropertyPages CLSID** a été optimisé et gère correctement les cas d’échec, par exemple quand aucun spécificateur d’affichage n’est disponible pour les paramètres régionaux actuels.</span><span class="sxs-lookup"><span data-stu-id="4944d-197">The **CLSID\_DsPropertyPages** has been optimized and will correctly handle failure cases, such as when no display specifier is available for the current locale.</span></span> <span data-ttu-id="4944d-198">En outre, l’objet **CLSID \_ DsPropertyPages** peut changer à l’avenir, ce qui signifie que vos feuilles de propriétés peuvent ne pas correspondre exactement à celles affichées par le composant logiciel enfichable MMC Active Directory utilisateurs et ordinateurs.</span><span class="sxs-lookup"><span data-stu-id="4944d-198">Also, the **CLSID\_DsPropertyPages** object may change in the future, which means your property sheets may not exactly match those displayed by the Active Directory Users and Computers MMC snap-in.</span></span>

## <a name="special-programming-elements"></a><span data-ttu-id="4944d-199">Éléments de programmation spéciaux</span><span class="sxs-lookup"><span data-stu-id="4944d-199">Special Programming Elements</span></span>

<span data-ttu-id="4944d-200">Actuellement, les éléments de programmation suivants ne sont pas définis dans un fichier d’en-tête publié.</span><span class="sxs-lookup"><span data-stu-id="4944d-200">Currently, the following programming elements are not defined in a published header file.</span></span> <span data-ttu-id="4944d-201">Pour utiliser ces éléments, vous devez les définir vous-même dans le format exact affiché dans la page de référence particulière.</span><span class="sxs-lookup"><span data-stu-id="4944d-201">To use these elements, you must define them yourself in the exact format shown in the particular reference page.</span></span>

-   [<span data-ttu-id="4944d-202">**CFSTR \_ DS \_ PROPSHEETCONFIG**</span><span class="sxs-lookup"><span data-stu-id="4944d-202">**CFSTR\_DS\_PROPSHEETCONFIG**</span></span>](cfstr-ds-propsheetconfig.md)
-   [<span data-ttu-id="4944d-203">**PROPSHEETCFG**</span><span class="sxs-lookup"><span data-stu-id="4944d-203">**PROPSHEETCFG**</span></span>](propsheetcfg.md)
-   [<span data-ttu-id="4944d-204">**notification de fermeture de la \_ feuille du DSA WM \_ \_ \_**</span><span class="sxs-lookup"><span data-stu-id="4944d-204">**WM\_DSA\_SHEET\_CLOSE\_NOTIFY**</span></span>](wm-dsa-sheet-close-notify.md)
-   [<span data-ttu-id="4944d-205">**créer une notification de la \_ feuille DSA DSA \_ \_ \_**</span><span class="sxs-lookup"><span data-stu-id="4944d-205">**WM\_DSA\_SHEET\_CREATE\_NOTIFY**</span></span>](wm-dsa-sheet-create-notify.md)
-   [<span data-ttu-id="4944d-206">**\_ \_ informations sur la page DSA sec \_**</span><span class="sxs-lookup"><span data-stu-id="4944d-206">**DSA\_SEC\_PAGE\_INFO**</span></span>](dsa-sec-page-info.md)

## <a name="example-code"></a><span data-ttu-id="4944d-207">Exemple de code</span><span class="sxs-lookup"><span data-stu-id="4944d-207">Example Code</span></span>

<span data-ttu-id="4944d-208">L’exemple de code C++ suivant montre un moyen sûr de définir ces éléments qui continueront de fonctionner même si ces éléments sont définis dans un fichier d’en-tête publié à l’avenir.</span><span class="sxs-lookup"><span data-stu-id="4944d-208">The following C++ code example shows a safe way to define these elements that will continue to work even if these elements are defined in a published header file in the future.</span></span>


```C++
#ifndef CFSTR_DS_PROPSHEETCONFIG
    #define CFSTR_DS_PROPSHEETCONFIG_W L"DsPropSheetCfgClipFormat"
    #define CFSTR_DS_PROPSHEETCONFIG_A "DsPropSheetCfgClipFormat"

    #ifdef UNICODE
        #define CFSTR_DS_PROPSHEETCONFIG CFSTR_DS_PROPSHEETCONFIG_W
    #else
        #define CFSTR_DS_PROPSHEETCONFIG CFSTR_DS_PROPSHEETCONFIG_A
    #endif //UNICODE
#endif //CFSTR_DS_PROPSHEETCONFIG


#ifndef WM_ADSPROP_SHEET_CREATE
    #define WM_ADSPROP_SHEET_CREATE (WM_USER + 1108)
#endif


#ifndef WM_DSA_SHEET_CREATE_NOTIFY
    #define WM_DSA_SHEET_CREATE_NOTIFY (WM_USER + 6)
#endif


#ifndef WM_DSA_SHEET_CLOSE_NOTIFY
    #define WM_DSA_SHEET_CLOSE_NOTIFY (WM_USER + 5) 
#endif


#ifndef DSA_SEC_PAGE_INFO
    typedef struct _DSA_SEC_PAGE_INFO
    {
        HWND    hwndParentSheet;
        DWORD   offsetTitle;
        DSOBJECTNAMES dsObjectNames;
    } DSA_SEC_PAGE_INFO, *PDSA_SEC_PAGE_INFO;
#endif //DSA_SEC_PAGE_INFO

#ifndef PROPSHEETCFG
    typedef struct _PROPSHEETCFG
    {  
        LONG_PTR lNotifyHandle;  
        HWND hwndParentSheet;  
        HWND hwndHidden;  
        WPARAM wParamSheetClose;
    } PROPSHEETCFG, *PPROPSHEETCFG;
#endif //PROPSHEETCFG
```



 

