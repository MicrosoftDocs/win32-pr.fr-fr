---
title: Menus contextuels à utiliser avec les spécificateurs d’affichage
description: Les composants logiciels enfichables MMC d’administration Active Directory et Windows 2000 Shell fournissent un mécanisme pour ajouter un élément au menu contextuel affiché pour les objets dans Active Directory Domain Services.
ms.assetid: 0b0691f5-321d-4f22-b39c-bc528db9e707
ms.tgt_platform: multiple
keywords:
- afficher les spécificateurs Active Directory, menus contextuels
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f28fbf703f17ea5c0fa7938365d485998be77e8d
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/17/2020
ms.locfileid: "103940835"
---
# <a name="context-menus-for-use-with-display-specifiers"></a><span data-ttu-id="2e1ea-104">Menus contextuels à utiliser avec les spécificateurs d’affichage</span><span class="sxs-lookup"><span data-stu-id="2e1ea-104">Context Menus for Use with Display Specifiers</span></span>

<span data-ttu-id="2e1ea-105">Les composants logiciels enfichables MMC d’administration Active Directory et Windows 2000 Shell fournissent un mécanisme pour ajouter un élément au menu contextuel affiché pour les objets dans Active Directory Domain Services.</span><span class="sxs-lookup"><span data-stu-id="2e1ea-105">The Active Directory administrative MMC snap-ins and Windows 2000 shell provide a mechanism to add an item to the context menu displayed for objects in Active Directory Domain Services.</span></span> <span data-ttu-id="2e1ea-106">Un élément de menu contextuel peut être ajouté en implémentant un serveur COM in-proc appelé *extension de menu contextuel*.</span><span class="sxs-lookup"><span data-stu-id="2e1ea-106">A context menu item can be added by implementing an COM in-proc server known as a *context menu extension*.</span></span> <span data-ttu-id="2e1ea-107">Vous pouvez également ajouter un élément de menu contextuel qui appelle n’importe quel fichier démarré avec l’API [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) , telle qu’une application ou une URL de page Web.</span><span class="sxs-lookup"><span data-stu-id="2e1ea-107">A context menu item can also be added that invokes any file started with the [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) API, such as an application or webpage URL.</span></span> <span data-ttu-id="2e1ea-108">C’est ce qu’on appelle un *élément de menu contextuel statique*.</span><span class="sxs-lookup"><span data-stu-id="2e1ea-108">This is known as a *static context menu item*.</span></span>

## <a name="developer-audience"></a><span data-ttu-id="2e1ea-109">Public de développeurs</span><span class="sxs-lookup"><span data-stu-id="2e1ea-109">Developer Audience</span></span>

<span data-ttu-id="2e1ea-110">Cette documentation suppose que le lecteur est familiarisé avec l’opération COM et le développement de composants à l’aide de C++.</span><span class="sxs-lookup"><span data-stu-id="2e1ea-110">This documentation assumes that the reader is familiar with COM operation and component development using C++.</span></span> <span data-ttu-id="2e1ea-111">Il n’est actuellement pas possible de créer une extension de menu contextuel Active Directory Domain Services à l’aide de Microsoft Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="2e1ea-111">It is not currently possible to create an Active Directory Domain Services context menu extension using Microsoft Visual Basic.</span></span>

## <a name="extending-the-context-menu-with-a-context-menu-extension"></a><span data-ttu-id="2e1ea-112">Extension du menu contextuel à l’aide d’une extension de menu contextuel</span><span class="sxs-lookup"><span data-stu-id="2e1ea-112">Extending the Context Menu With a Context Menu Extension</span></span>

<span data-ttu-id="2e1ea-113">Une extension de menu contextuel est un serveur COM in-proc qui implémente certaines interfaces et est inscrit avec Active Directory Domain Services.</span><span class="sxs-lookup"><span data-stu-id="2e1ea-113">A context menu extension is a COM in-proc server that implements certain interfaces and is registered with Active Directory Domain Services.</span></span>

<span data-ttu-id="2e1ea-114">**Pour créer et installer une extension de menu contextuel**</span><span class="sxs-lookup"><span data-stu-id="2e1ea-114">**To create and install a context menu extension**</span></span>

1.  <span data-ttu-id="2e1ea-115">Créez la DLL d’extension du menu contextuel.</span><span class="sxs-lookup"><span data-stu-id="2e1ea-115">Create the context menu extension DLL.</span></span> <span data-ttu-id="2e1ea-116">Une extension de menu contextuel est un serveur COM in-proc qui, au minimum, implémente les interfaces [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) et [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu) .</span><span class="sxs-lookup"><span data-stu-id="2e1ea-116">A context menu extension is a COM in-proc server that, at a minimum, implements the [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) and [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu) interfaces.</span></span> <span data-ttu-id="2e1ea-117">Pour plus d’informations, consultez [implémentation de l’objet com du menu contextuel](implementing-the-context-menu-com-object.md).</span><span class="sxs-lookup"><span data-stu-id="2e1ea-117">For more information, see [Implementing the Context Menu COM Object](implementing-the-context-menu-com-object.md).</span></span>
2.  <span data-ttu-id="2e1ea-118">Installez l’extension de la feuille de menus contextuel sur les ordinateurs où l’extension du menu contextuel est utilisée.</span><span class="sxs-lookup"><span data-stu-id="2e1ea-118">Install the context menu sheet extension on computers where the context menu extension is used.</span></span> <span data-ttu-id="2e1ea-119">Pour ce faire, vous devez créer un package Microsoft Windows Installer pour la DLL d’extension du menu contextuel et déployer le package de manière appropriée à l’aide de la stratégie de groupe.</span><span class="sxs-lookup"><span data-stu-id="2e1ea-119">This is accomplished by creating a Microsoft Windows Installer package for the context menu extension DLL and deploying the package appropriately using the group policy.</span></span> <span data-ttu-id="2e1ea-120">Pour plus d’informations, consultez distribution des composants de l' [interface utilisateur](distributing-user-interface-components.md).</span><span class="sxs-lookup"><span data-stu-id="2e1ea-120">For more information, see [Distributing User Interface Components](distributing-user-interface-components.md).</span></span>
3.  <span data-ttu-id="2e1ea-121">Enregistrez l’extension du menu contextuel dans le Registre Windows et avec Active Directory Domain Services.</span><span class="sxs-lookup"><span data-stu-id="2e1ea-121">Register the context menu extension in the Windows registry and with Active Directory Domain Services.</span></span> <span data-ttu-id="2e1ea-122">Pour plus d’informations, consultez [inscription de l’objet com du menu contextuel dans un spécificateur d’affichage](registering-the-context-menu-com-object-in-a-display-specifier.md).</span><span class="sxs-lookup"><span data-stu-id="2e1ea-122">For more information, see [Registering the Context Menu COM Object in a Display Specifier](registering-the-context-menu-com-object-in-a-display-specifier.md).</span></span>

## <a name="extending-the-context-menu-with-a-static-context-menu-item"></a><span data-ttu-id="2e1ea-123">Extension du menu contextuel à l’aide d’un élément de menu contextuel statique</span><span class="sxs-lookup"><span data-stu-id="2e1ea-123">Extending the Context Menu With a Static Context Menu Item</span></span>

<span data-ttu-id="2e1ea-124">Un élément de menu contextuel statique peut être utilisé pour appeler n’importe quel fichier démarré avec l’API [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) , par exemple une URL d’application ou de page Web.</span><span class="sxs-lookup"><span data-stu-id="2e1ea-124">A static context menu item can be used to invoke any file started with the [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) API, such as an application or webpage URL.</span></span> <span data-ttu-id="2e1ea-125">Pour ce faire, l’élément de menu contextuel statique d’une classe d’objet particulière doit être inscrit pour que l’élément de menu contextuel statique soit ajouté au menu contextuel des objets de cette classe.</span><span class="sxs-lookup"><span data-stu-id="2e1ea-125">To accomplished this, the static context menu item for a particular object class must be registered so that the static context menu item is added to the context menu of objects of that class.</span></span> <span data-ttu-id="2e1ea-126">Pour plus d’informations, consultez [inscription d’un élément de menu contextuel statique](registering-a-static-context-menu-item.md).</span><span class="sxs-lookup"><span data-stu-id="2e1ea-126">For more information, see [Registering a Static Context Menu Item](registering-a-static-context-menu-item.md).</span></span>

 

 