---
title: Interrogation des modifications à l’aide du contrôle DirSync
description: Le contrôle de synchronisation d’annuaires Active Directory Directory (DirSync) est une extension de serveur LDAP qui permet à une application de rechercher dans une partition d’annuaire des objets qui ont été modifiés depuis un état antérieur.
ms.assetid: f77caeb3-bfc9-4ae6-8d1d-73f4ee554336
ms.tgt_platform: multiple
keywords:
- Interrogation des modifications à l’aide de l’AD du contrôle DirSync
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8c3d105757d39bc25bd10df21ab68c4d1d1202be
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/17/2020
ms.locfileid: "103724469"
---
# <a name="polling-for-changes-using-the-dirsync-control"></a><span data-ttu-id="ea652-104">Interrogation des modifications à l’aide du contrôle DirSync</span><span class="sxs-lookup"><span data-stu-id="ea652-104">Polling for Changes Using the DirSync Control</span></span>

<span data-ttu-id="ea652-105">Le contrôle de synchronisation d’annuaires Active Directory Directory (DirSync) est une extension de serveur LDAP qui permet à une application de rechercher dans une partition d’annuaire des objets qui ont été modifiés depuis un état antérieur.</span><span class="sxs-lookup"><span data-stu-id="ea652-105">Active Directory directory synchronization (DirSync) control is an LDAP server extension that enables an application to search an directory partition for objects that have changed since a previous state.</span></span>

<span data-ttu-id="ea652-106">Utilisez le contrôle DirSync par le biais d’ADSI en spécifiant les préférences de recherche de **\_ \_ DirSync SEARCHPREFs ADS** lors de l’utilisation de [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch).</span><span class="sxs-lookup"><span data-stu-id="ea652-106">Use the DirSync control through ADSI by specifying the **ADS\_SEARCHPREF\_DIRSYNC** search preference when using [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch).</span></span> <span data-ttu-id="ea652-107">Pour plus d’informations et pour obtenir un exemple de code, consultez [exemple de code utilisant les publicités \_ SEARCHPREF \_ DirSync](example-code-using-ads-searchpref-dirsync.md).</span><span class="sxs-lookup"><span data-stu-id="ea652-107">For more information and a code example, see [Example Code Using ADS\_SEARCHPREF\_DIRSYNC](example-code-using-ads-searchpref-dirsync.md).</span></span> <span data-ttu-id="ea652-108">Vous pouvez également effectuer une recherche DirSync à l’aide de l’API LDAP.</span><span class="sxs-lookup"><span data-stu-id="ea652-108">You can also perform a DirSync search using the LDAP API.</span></span> <span data-ttu-id="ea652-109">Les éléments suivants décrivent l’implémentation d’ADSI, dont la plupart s’appliquent également à l’utilisation directe de LDAP, sauf comme indiqué à la fin de cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="ea652-109">The following describes the ADSI implementation, most of which also applies to using LDAP directly, except as discussed at the end of this topic.</span></span>

<span data-ttu-id="ea652-110">Lorsque vous effectuez une recherche DirSync, vous transmettez un élément de données spécifique au fournisseur (cookie) qui identifie l’état de l’annuaire au moment de la recherche DirSync précédente.</span><span class="sxs-lookup"><span data-stu-id="ea652-110">When you perform a DirSync search, you pass in a provider-specific data element (cookie) that identifies the directory state at the time of the previous DirSync search.</span></span> <span data-ttu-id="ea652-111">Pour la première recherche, vous transmettez un cookie null, et la recherche retourne tous les objets qui correspondent au filtre.</span><span class="sxs-lookup"><span data-stu-id="ea652-111">For the first search, you pass in a null cookie, and the search returns all objects that match the filter.</span></span> <span data-ttu-id="ea652-112">La recherche retourne également un cookie valide.</span><span class="sxs-lookup"><span data-stu-id="ea652-112">The search also returns a valid cookie.</span></span> <span data-ttu-id="ea652-113">Stockez le cookie dans le même stockage que celui que vous synchronisez avec le serveur de Active Directory.</span><span class="sxs-lookup"><span data-stu-id="ea652-113">Store the cookie in the same storage that you are synchronizing with the Active Directory server.</span></span> <span data-ttu-id="ea652-114">Lors des recherches suivantes, récupérez le cookie auprès du stockage et transmettez-le à la demande de recherche.</span><span class="sxs-lookup"><span data-stu-id="ea652-114">On subsequent searches, get the cookie from storage and pass it with the search request.</span></span> <span data-ttu-id="ea652-115">Les résultats de la recherche incluent désormais uniquement les objets et les attributs qui ont été modifiés depuis l’état précédent identifié par le cookie.</span><span class="sxs-lookup"><span data-stu-id="ea652-115">The search results now include only the objects and attributes that have changed since the previous state identified by the cookie.</span></span> <span data-ttu-id="ea652-116">La recherche retourne également un nouveau cookie à stocker pour la recherche suivante.</span><span class="sxs-lookup"><span data-stu-id="ea652-116">The search also returns a new cookie to store for the next search.</span></span>

<span data-ttu-id="ea652-117">Le tableau suivant répertorie les paramètres de recherche que la demande de recherche du client peut spécifier.</span><span class="sxs-lookup"><span data-stu-id="ea652-117">The following table lists search parameters that the client search request can specify.</span></span>



| <span data-ttu-id="ea652-118">Paramètre</span><span class="sxs-lookup"><span data-stu-id="ea652-118">Parameter</span></span>          | <span data-ttu-id="ea652-119">Description</span><span class="sxs-lookup"><span data-stu-id="ea652-119">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|--------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="ea652-120">Base de la recherche</span><span class="sxs-lookup"><span data-stu-id="ea652-120">Base of the search</span></span> | <span data-ttu-id="ea652-121">La base d’une recherche DirSync doit être la racine d’une partition d’annuaire, qui peut être une partition de domaine, la partition de configuration ou la partition de schéma.</span><span class="sxs-lookup"><span data-stu-id="ea652-121">The base of a DirSync search must be the root of a directory partition, which can be a domain partition, the configuration partition, or the schema partition.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| <span data-ttu-id="ea652-122">Étendue</span><span class="sxs-lookup"><span data-stu-id="ea652-122">Scope</span></span>              | <span data-ttu-id="ea652-123">L’étendue d’une recherche DirSync doit être **la \_ \_ sous-arborescence étendue ADS**, c’est-à-dire la sous-arborescence entière de la partition.</span><span class="sxs-lookup"><span data-stu-id="ea652-123">The scope of a DirSync search must be **ADS\_SCOPE\_SUBTREE**, that is, the entire subtree of the partition.</span></span> <span data-ttu-id="ea652-124">N’oubliez pas que pour la recherche d’une partition de domaine, la sous-arborescence comprend les têtes, mais pas le contenu, des partitions de configuration et de schéma.</span><span class="sxs-lookup"><span data-stu-id="ea652-124">Be aware that for a search of a domain partition, the subtree includes the heads, but not the contents, of the configuration and schema partitions.</span></span> <span data-ttu-id="ea652-125">Pour interroger les modifications dans une plus petite étendue, utilisez la technique **USNChanged** au lieu de DirSync.</span><span class="sxs-lookup"><span data-stu-id="ea652-125">To poll for changes in a smaller scope, use the **USNChanged** technique instead of DirSync.</span></span>                                                                                                                                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="ea652-126">Filtrer</span><span class="sxs-lookup"><span data-stu-id="ea652-126">Filter</span></span>             | <span data-ttu-id="ea652-127">Vous pouvez spécifier n’importe quel filtre de recherche valide.</span><span class="sxs-lookup"><span data-stu-id="ea652-127">You can specify any valid search filter.</span></span> <span data-ttu-id="ea652-128">Pour une recherche initiale avec un cookie null, les résultats incluent tous les objets qui correspondent au filtre.</span><span class="sxs-lookup"><span data-stu-id="ea652-128">For an initial search with a null cookie, the results include all objects that match the filter.</span></span> <span data-ttu-id="ea652-129">Pour les recherches suivantes avec un cookie valide, les résultats de la recherche incluent des données uniquement pour les objets qui correspondent au filtre et ont été modifiés depuis l’état indiqué par le cookie.</span><span class="sxs-lookup"><span data-stu-id="ea652-129">For subsequent searches with a valid cookie, the search results include data only for objects that match the filter and have changed since the state indicated by the cookie.</span></span> <span data-ttu-id="ea652-130">Pour plus d’informations sur les filtres de recherche, consultez [création d’un filtre de requête](creating-a-query-filter.md).</span><span class="sxs-lookup"><span data-stu-id="ea652-130">For more information about search filters, see [Creating a Query Filter](creating-a-query-filter.md).</span></span>                                                                                                                                                                                                                                                                                                                |
| <span data-ttu-id="ea652-131">Attributs</span><span class="sxs-lookup"><span data-stu-id="ea652-131">Attributes</span></span>         | <span data-ttu-id="ea652-132">Vous pouvez spécifier une liste d’attributs à retourner lorsqu’une modification se produit.</span><span class="sxs-lookup"><span data-stu-id="ea652-132">You can specify a list of attributes to be returned when a change occurs.</span></span> <span data-ttu-id="ea652-133">Pour chaque objet, les résultats initiaux incluent tous les attributs demandés définis sur l’objet.</span><span class="sxs-lookup"><span data-stu-id="ea652-133">For each object, the initial results include all the requested attributes set on the object.</span></span> <span data-ttu-id="ea652-134">Les résultats de la recherche suivants incluent uniquement les attributs spécifiés qui ont été modifiés.</span><span class="sxs-lookup"><span data-stu-id="ea652-134">Subsequent search results include only the specified attributes that have changed.</span></span> <span data-ttu-id="ea652-135">Les attributs non modifiés ne sont pas inclus dans les résultats de la recherche.</span><span class="sxs-lookup"><span data-stu-id="ea652-135">Unchanged attributes are not included in the search results.</span></span> <span data-ttu-id="ea652-136">Dans l’implémentation ADSI, les résultats de la recherche incluent toujours les valeurs **objectGUID** et **instanceType** de chaque objet.</span><span class="sxs-lookup"><span data-stu-id="ea652-136">In the ADSI implementation, the search results always include the **objectGUID** and **instanceType** of each object.</span></span> <span data-ttu-id="ea652-137">En outre, la liste d’attributs spécifiée agit comme un filtre supplémentaire : les résultats de la recherche initiale incluent uniquement les objets qui ont au moins un des attributs spécifiés définis ; les recherches suivantes incluent uniquement les objets sur lesquels un ou plusieurs attributs ont changé (valeurs ajoutées ou supprimées).</span><span class="sxs-lookup"><span data-stu-id="ea652-137">Also, the specified attribute list acts as an additional filter: the initial search results include only objects that have at least one of the specified attributes set; subsequent searches include only objects on which one or more of the attributes have changed (values added or deleted).</span></span> |



 

<span data-ttu-id="ea652-138">Sachez également que :</span><span class="sxs-lookup"><span data-stu-id="ea652-138">Also, be aware that:</span></span>

-   <span data-ttu-id="ea652-139">Pour les recherches incrémentielles, la meilleure pratique consiste à établir une liaison avec le même contrôleur de domaine que celui utilisé dans la recherche précédente, autrement dit, le contrôleur de domaine qui a généré le cookie.</span><span class="sxs-lookup"><span data-stu-id="ea652-139">For incremental searches, the best practice is to bind to the same domain controller (DC) used in the previous search, that is, the DC that generated the cookie.</span></span> <span data-ttu-id="ea652-140">Si le même contrôleur de périphérique n’est pas disponible, patientez jusqu’à ce qu’il soit ou établissez une liaison à un nouveau contrôleur de service et effectuez une synchronisation complète.</span><span class="sxs-lookup"><span data-stu-id="ea652-140">If the same DC is unavailable, either wait until it is, or bind to a new DC and perform a full synchronization.</span></span> <span data-ttu-id="ea652-141">Stockez le nom DNS du contrôleur de domaine dans le stockage secondaire avec le cookie.</span><span class="sxs-lookup"><span data-stu-id="ea652-141">Store the DNS name of the DC in the secondary storage with the cookie.</span></span>

    <span data-ttu-id="ea652-142">Vous pouvez transmettre un cookie généré par un contrôleur de périphérique à un autre contrôleur de périphérique hébergeant un réplica de la même partition d’annuaire.</span><span class="sxs-lookup"><span data-stu-id="ea652-142">You can pass a cookie generated by one DC to a different DC hosting a replica of the same directory partition.</span></span> <span data-ttu-id="ea652-143">Il n’y a aucun risque qu’un client ne puisse pas modifier à l’aide d’un cookie d’un contrôleur de périphérique sur un autre.</span><span class="sxs-lookup"><span data-stu-id="ea652-143">There is no chance that a client will miss changes by using a cookie from one DC on another DC.</span></span> <span data-ttu-id="ea652-144">Toutefois, il est possible que les résultats de la recherche du nouveau contrôleur de service puissent inclure les modifications signalées par l’ancien contrôleur de périphérique. dans certains cas, le nouveau contrôleur de périphérique peut retourner tous les objets et attributs, comme avec une synchronisation complète.</span><span class="sxs-lookup"><span data-stu-id="ea652-144">However, it is possible that the search results from the new DC may include reported changes by the old DC; in some cases, the new DC may return all objects and attributes, as with a full synchronization.</span></span> <span data-ttu-id="ea652-145">Le client doit simplement rendre sa base de données cohérente avec les résultats de recherche signalés pour un appel DirSync donné, c’est-à-dire gérer tous les résultats incrémentiels comme s’il s’agissait de l’état le plus récent.</span><span class="sxs-lookup"><span data-stu-id="ea652-145">The client should just make its database consistent with reported search results for any given DirSync call, that is, handle all incremental results as if they were the latest state.</span></span> <span data-ttu-id="ea652-146">Il n’est pas important de savoir si vous avez vu la modification avant ou si vous revenez à un état précédent, car les synchronisations incrémentielles répétées convergeront sur la cohérence.</span><span class="sxs-lookup"><span data-stu-id="ea652-146">It does not matter whether you have seen the change before or are even going back to a previous state because repeated incremental synchronizations will converge on consistency.</span></span>

-   <span data-ttu-id="ea652-147">Lorsqu’un objet est renommé ou déplacé, ses objets enfants, le cas échéant, ne sont pas inclus dans les résultats de la recherche, même si les noms uniques des objets enfants ont changé.</span><span class="sxs-lookup"><span data-stu-id="ea652-147">When an object is renamed or moved, its child objects, if any, are not included in the search results, even though the distinguished names of the child objects have changed.</span></span> <span data-ttu-id="ea652-148">De même, lorsqu’une entrée du contrôle d’accès héritable est modifiée dans un descripteur de sécurité d’objet, les objets enfants de l’objet ne sont pas inclus dans les résultats de la recherche, même si les descripteurs de sécurité des objets enfants ont changé.</span><span class="sxs-lookup"><span data-stu-id="ea652-148">Similarly, when an inheritable ACE is modified in an object security-descriptor, the child objects of the object are not included in the search results, even though the security-descriptors of the child objects have changed.</span></span>
-   <span data-ttu-id="ea652-149">Utilisez l’attribut **objectGUID** pour identifier les objets suivis.</span><span class="sxs-lookup"><span data-stu-id="ea652-149">Use the **objectGUID** attribute to identify the tracked objects.</span></span> <span data-ttu-id="ea652-150">L' **objectGUID** de chaque objet reste inchangé, quel que soit l’emplacement où l’objet est déplacé dans la forêt.</span><span class="sxs-lookup"><span data-stu-id="ea652-150">The **objectGUID** of each object remains unchanged regardless of where the object is moved within the forest.</span></span>
-   <span data-ttu-id="ea652-151">Sachez que les résultats de la recherche d’une recherche DirSync indiquent l’état des objets sur un réplica de la partition d’annuaire au moment de la recherche.</span><span class="sxs-lookup"><span data-stu-id="ea652-151">Be aware that the search results of a DirSync search indicate the state of the objects on a replica of the directory partition at the time of the search.</span></span> <span data-ttu-id="ea652-152">Cela signifie que les modifications apportées sur d’autres contrôleurs de l’utilisateur ne seront pas incluses si elles n’ont pas été répliquées sur le contrôleur de l’équipement cible.</span><span class="sxs-lookup"><span data-stu-id="ea652-152">This means that changes made on other DCs will not be included if they have not been replicated to the target DC.</span></span> <span data-ttu-id="ea652-153">Cela signifie également que les attributs d’un objet peuvent avoir changé plusieurs fois depuis la recherche DirSync précédente, mais que la recherche n’affiche que l’état final, et non la séquence de modifications.</span><span class="sxs-lookup"><span data-stu-id="ea652-153">It also means that an object's attributes may have changed several times since the previous DirSync search, but the search will show only the final state, not the sequence of changes.</span></span>
-   <span data-ttu-id="ea652-154">Dans l’implémentation ADSI, l’application doit gérer le cookie comme opaque et ne pas faire d’hypothèses concernant son organisation ou sa valeur interne.</span><span class="sxs-lookup"><span data-stu-id="ea652-154">In the ADSI implementation, the application must handle the cookie as opaque and not make any assumptions about its internal organization or value.</span></span>
-   <span data-ttu-id="ea652-155">N’oubliez pas que le client stocke le cookie, la longueur du cookie et le nom DNS du contrôleur de domaine dans le même stockage que celui qui contient les données de l’objet synchronisé.</span><span class="sxs-lookup"><span data-stu-id="ea652-155">Be aware that the client stores the cookie, cookie length, and DNS name of the DC in the same storage that contains the synchronized object data.</span></span> <span data-ttu-id="ea652-156">Cela garantit que le cookie et les autres paramètres restent synchronisés avec les données d’objet si le stockage est restauré à partir d’une sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="ea652-156">This ensures that the cookie and other parameters remain in sync with the object data if the storage is ever restored from a backup.</span></span>
-   <span data-ttu-id="ea652-157">Pour récupérer l’attribut [**parentGUID**](/windows/desktop/ADSchema/a-parentguid) , qui est construit pour le contrôle DirSync, il est également nécessaire de demander l’attribut [**Name**](/windows/desktop/ADSchema/a-name) .</span><span class="sxs-lookup"><span data-stu-id="ea652-157">To retrieve the [**parentGUID**](/windows/desktop/ADSchema/a-parentguid) attribute, which is constructed for the DirSync control, it is also necessary to request the [**name**](/windows/desktop/ADSchema/a-name) attribute.</span></span>

<span data-ttu-id="ea652-158">Pour utiliser le contrôle DirSync, l’appelant doit disposer du droit « obtenir les modifications de l’annuaire » sur la racine de la partition surveillée.</span><span class="sxs-lookup"><span data-stu-id="ea652-158">To use the DirSync control, caller must have the "directory get changes" right assigned on the root of the partition being monitored.</span></span> <span data-ttu-id="ea652-159">Par défaut, ce droit est attribué aux comptes administrateur et LocalSystem sur les contrôleurs de domaine.</span><span class="sxs-lookup"><span data-stu-id="ea652-159">By default, this right is assigned to the Administrator and LocalSystem accounts on domain controllers.</span></span> <span data-ttu-id="ea652-160">L’appelant doit également disposer du droit d’accès du contrôle étendu [**DS-Replication-obten-changes**](/windows/desktop/ADSchema/r-ds-replication-get-changes) .</span><span class="sxs-lookup"><span data-stu-id="ea652-160">The caller must also have the [**DS-Replication-Get-Changes**](/windows/desktop/ADSchema/r-ds-replication-get-changes) extended control access right.</span></span> <span data-ttu-id="ea652-161">Pour plus d’informations sur l’implémentation d’un mécanisme de suivi des modifications pour les applications qui doivent s’exécuter sous un compte qui ne dispose pas de ce droit, consultez [interrogation des modifications à l’aide de USNChanged](polling-for-changes-using-usnchanged.md).</span><span class="sxs-lookup"><span data-stu-id="ea652-161">For more information about implementing a change-tracking mechanism for applications that must run under an account that does not have this right, see [Polling for Changes Using USNChanged](polling-for-changes-using-usnchanged.md).</span></span> <span data-ttu-id="ea652-162">Pour plus d’informations sur les privilèges, consultez [privilèges](/windows/desktop/SecAuthZ/privileges).</span><span class="sxs-lookup"><span data-stu-id="ea652-162">For more information about privileges, see [Privileges](/windows/desktop/SecAuthZ/privileges).</span></span>

## <a name="retrieving-deleted-objects-with-a-dirsync-search"></a><span data-ttu-id="ea652-163">Récupération d’objets supprimés à l’aide d’une recherche DirSync</span><span class="sxs-lookup"><span data-stu-id="ea652-163">Retrieving Deleted Objects With a DirSync Search</span></span>

<span data-ttu-id="ea652-164">Les résultats de la recherche **\_ SEARCHPREF \_ DirSync de publicités** incluent automatiquement les objets supprimés (objets tombstone) qui correspondent au filtre de recherche spécifié.</span><span class="sxs-lookup"><span data-stu-id="ea652-164">The **ADS\_SEARCHPREF\_DIRSYNC** search results automatically include deleted objects (tombstones) that match the specified search filter.</span></span> <span data-ttu-id="ea652-165">Toutefois, un filtre de recherche qui correspond à un objet lorsqu’il est en temps réel peut ne pas correspondre à l’objet après sa suppression.</span><span class="sxs-lookup"><span data-stu-id="ea652-165">However, a search filter that will match an object when it is live may not match the object after it is deleted.</span></span> <span data-ttu-id="ea652-166">Cela est dû au fait que les objets tombstone ne conservent qu’un sous-ensemble des attributs présents sur l’objet d’origine.</span><span class="sxs-lookup"><span data-stu-id="ea652-166">This is because tombstones retain only a subset of the attributes present on the original object.</span></span> <span data-ttu-id="ea652-167">Par exemple, vous utiliseriez généralement le filtre suivant pour les objets utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ea652-167">For example, you would typically use the following filter for user objects.</span></span>


```C++
(&(objectClass=user)(objectCategory=person))
```



<span data-ttu-id="ea652-168">L’attribut **objectCategory** est supprimé lorsqu’un objet est supprimé, donc le filtre ci-dessus ne correspond à aucun objet tombstone.</span><span class="sxs-lookup"><span data-stu-id="ea652-168">The **objectCategory** attribute is removed when an object is deleted, so the filter above would not match any tombstone objects.</span></span> <span data-ttu-id="ea652-169">À l’inverse, l’attribut **objectClass** est conservé sur les objets tombstone, donc un filtre « (objectClass = user) » correspond aux objets utilisateur supprimés.</span><span class="sxs-lookup"><span data-stu-id="ea652-169">Conversely, the **objectClass** attribute is retained on tombstone objects, so a filter of "(objectClass=user)" would match deleted user objects.</span></span>

<span data-ttu-id="ea652-170">La liste d’attributs que vous spécifiez avec une recherche DirSync agit également comme un filtre. les résultats de la recherche incluent uniquement les objets sur lesquels un ou plusieurs des attributs spécifiés ont été modifiés depuis la recherche DirSync précédente.</span><span class="sxs-lookup"><span data-stu-id="ea652-170">The attribute list that you specify with a DirSync search also acts as a filter; search results include only objects on which one or more of the specified attributes have changed since the previous DirSync search.</span></span> <span data-ttu-id="ea652-171">Si la liste d’attributs n’inclut aucun attribut conservé sur les objets tombstone, les résultats de la recherche n’incluent pas les objets tombstone.</span><span class="sxs-lookup"><span data-stu-id="ea652-171">If the attribute list does not include any attributes that are retained on tombstones, the search results will not include tombstones.</span></span> <span data-ttu-id="ea652-172">Pour gérer cela, demandez tous les attributs en spécifiant une liste d’attributs NULL ; ou vous pouvez demander l’attribut **IsDeleted** , avec la valeur **true** pour tous les objets tombstone.</span><span class="sxs-lookup"><span data-stu-id="ea652-172">To handle this, request all attributes by specifying a null attribute list; or you can request the **isDeleted** attribute, set to **TRUE** on all tombstones.</span></span> <span data-ttu-id="ea652-173">Les attributs de désactivation ont le bit 0x8 défini dans l’attribut **searchFlags** de la définition **attributeSchema** .</span><span class="sxs-lookup"><span data-stu-id="ea652-173">Tombstone attributes have the 0x8 bit set in the **searchFlags** attribute of the **attributeSchema** definition.</span></span>

<span data-ttu-id="ea652-174">Pour plus d’informations, consultez [récupération des objets supprimés](retrieving-deleted-objects.md).</span><span class="sxs-lookup"><span data-stu-id="ea652-174">For more information, see [Retrieving Deleted Objects](retrieving-deleted-objects.md).</span></span>

## <a name="ldap-implementation-of-the-dirsync-control"></a><span data-ttu-id="ea652-175">Implémentation LDAP du contrôle DirSync</span><span class="sxs-lookup"><span data-stu-id="ea652-175">LDAP Implementation of the DirSync Control</span></span>

<span data-ttu-id="ea652-176">Vous pouvez également effectuer une recherche DirSync en utilisant l’API LDAP avec le contrôle de [ \_ \_ DirSync \_ de l’OID du serveur LDAP](/previous-versions/windows/desktop/ldap/ldap-server-dirsync-oid) .</span><span class="sxs-lookup"><span data-stu-id="ea652-176">You can also perform a DirSync search by using the LDAP API with the [LDAP\_SERVER\_DIRSYNC\_OID](/previous-versions/windows/desktop/ldap/ldap-server-dirsync-oid) control.</span></span> <span data-ttu-id="ea652-177">Si vous utilisez l’API LDAP, spécifiez également [l' \_ \_ \_ \_ OID étendu du serveur LDAP](/previous-versions/windows/desktop/ldap/ldap-server-extended-dn-oid) et le [serveur LDAP afficher les contrôles \_ \_ \_ \_ OID supprimés](/previous-versions/windows/desktop/ldap/ldap-server-show-deleted-oid) .</span><span class="sxs-lookup"><span data-stu-id="ea652-177">If you use the LDAP API, also specify the [LDAP\_SERVER\_EXTENDED\_DN\_OID](/previous-versions/windows/desktop/ldap/ldap-server-extended-dn-oid) and [LDAP\_SERVER\_SHOW\_DELETED\_OID](/previous-versions/windows/desktop/ldap/ldap-server-show-deleted-oid) controls.</span></span> <span data-ttu-id="ea652-178">Le \_ \_ contrôle de l’OID étendu du DN du serveur LDAP \_ \_ fait en sorte qu’une recherche LDAP retourne une forme étendue du nom unique qui comprend les attributs **objectGUID** et **objectSID** pour les objets principaux de sécurité tels que les utilisateurs, les groupes et les ordinateurs.</span><span class="sxs-lookup"><span data-stu-id="ea652-178">The LDAP\_SERVER\_EXTENDED\_DN\_OID control causes an LDAP search to return an extended form of the distinguished name that includes the **objectGUID** and **objectSID** for security principal objects such as users, groups, and computers.</span></span> <span data-ttu-id="ea652-179">Le \_ contrôle serveur LDAP \_ afficher les \_ \_ OID supprimés entraîne l’inclusion de données pour les objets supprimés dans les résultats de la recherche.</span><span class="sxs-lookup"><span data-stu-id="ea652-179">The LDAP\_SERVER\_SHOW\_DELETED\_OID control causes the search results to include data for deleted objects.</span></span> <span data-ttu-id="ea652-180">N’oubliez pas que ces contrôles sont inclus automatiquement dans l’implémentation ADSI.</span><span class="sxs-lookup"><span data-stu-id="ea652-180">Be aware that these controls are automatically included in the ADSI implementation.</span></span>

 

 