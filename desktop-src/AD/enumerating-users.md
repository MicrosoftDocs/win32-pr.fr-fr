---
title: Énumération des utilisateurs
description: Contrairement aux domaines Windows NT 4,0, les utilisateurs de Windows 2000 peuvent être placés dans un conteneur ou une unité d’organisation (UO) dans un domaine, ainsi que la racine du domaine.
ms.assetid: 4a35af7a-f43b-4cf9-a030-77f6c2518ae7
ms.tgt_platform: multiple
keywords:
- Énumération des utilisateurs Active Directory
- utilisateurs Active Directory, énumération d’un utilisateur
- Active Directory, utilisation de, utilisateurs, énumération d’un utilisateur
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e922d92f4313ed0238ff068f7ae1c0fbf693d497
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/17/2020
ms.locfileid: "106545740"
---
# <a name="enumerating-users"></a><span data-ttu-id="bcea4-106">Énumération des utilisateurs</span><span class="sxs-lookup"><span data-stu-id="bcea4-106">Enumerating Users</span></span>

<span data-ttu-id="bcea4-107">Contrairement aux domaines Windows NT 4,0, les utilisateurs de Windows 2000 peuvent être placés dans un conteneur ou une unité d’organisation (UO) dans un domaine, ainsi que la racine du domaine.</span><span class="sxs-lookup"><span data-stu-id="bcea4-107">Unlike Windows NT 4.0 domains, Windows 2000 users can be placed in any container or organizational unit (OU) in a domain as well as the root of the domain.</span></span> <span data-ttu-id="bcea4-108">Cela signifie que les utilisateurs peuvent se trouver à de nombreux emplacements dans la hiérarchie de répertoires.</span><span class="sxs-lookup"><span data-stu-id="bcea4-108">This means that users can be in numerous locations in the directory hierarchy.</span></span> <span data-ttu-id="bcea4-109">Par conséquent, vous avez deux possibilités pour l’énumération des utilisateurs :</span><span class="sxs-lookup"><span data-stu-id="bcea4-109">Therefore, you have two choices for enumerating users:</span></span>

-   <span data-ttu-id="bcea4-110">Énumérer les utilisateurs contenus directement dans un conteneur, une unité d’organisation ou à la racine du domaine :</span><span class="sxs-lookup"><span data-stu-id="bcea4-110">Enumerate the users directly contained in a container, OU, or at the root of the domain:</span></span>

    <span data-ttu-id="bcea4-111">Effectuez une liaison explicite à l’objet conteneur qui contient les utilisateurs que vous souhaitez énumérer, définissez un filtre contenant « utilisateur » en tant que classe à l’aide de la propriété [**IADsContainer. Filter**](/windows/desktop/ADSI/iadscontainer-property-methods) et utilisez la méthode [**IADsContainer :: obtenir \_ \_ NewEnum**](/windows/desktop/api/iads/nf-iads-iadscontainer-get__newenum) pour énumérer les objets utilisateur.</span><span class="sxs-lookup"><span data-stu-id="bcea4-111">Explicitly bind to the container object that contains the users you are interested in enumerating, set a filter containing "user" as the class using the [**IADsContainer.Filter**](/windows/desktop/ADSI/iadscontainer-property-methods) property, and use the [**IADsContainer::get\_\_NewEnum**](/windows/desktop/api/iads/nf-iads-iadscontainer-get__newenum) method to enumerate the user objects.</span></span>

    <span data-ttu-id="bcea4-112">Cette technique peut être utilisée pour énumérer les utilisateurs qui sont directement contenus dans un conteneur ou un objet d’unité d’organisation.</span><span class="sxs-lookup"><span data-stu-id="bcea4-112">This technique can be used to enumerate users that are directly contained in a container or OU object.</span></span> <span data-ttu-id="bcea4-113">Si le conteneur contient d’autres conteneurs qui peuvent potentiellement contenir d’autres utilisateurs, vous devez les lier à ces conteneurs et énumérer de manière récursive les utilisateurs sur ces conteneurs.</span><span class="sxs-lookup"><span data-stu-id="bcea4-113">If the container contains other containers that can potentially contain other users, you must bind to those containers and recursively enumerate the users on those containers.</span></span> <span data-ttu-id="bcea4-114">Si vous n’avez pas besoin de manipuler les objets utilisateur et que vous devez uniquement lire des propriétés spécifiques, utilisez la recherche détaillée décrite dans l’option 2.</span><span class="sxs-lookup"><span data-stu-id="bcea4-114">If it is not required that you manipulate the user objects, and only need to read specific properties, use the deep search described in Option 2.</span></span>

    <span data-ttu-id="bcea4-115">Étant donné que l’énumération retourne des pointeurs vers des objets COM ADSI représentant chaque objet utilisateur, vous pouvez appeler [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) pour récupérer les pointeurs d’interface [**IADs**](/windows/desktop/api/iads/nn-iads-iads), [**IADsUser**](/windows/desktop/api/iads/nn-iads-iadsuser)et [**IADsPropertyList**](/windows/desktop/api/iads/nn-iads-iadspropertylist) sur l’objet utilisateur.</span><span class="sxs-lookup"><span data-stu-id="bcea4-115">Because enumeration returns pointers to ADSI COM objects representing each user object, you can call [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) to get [**IADs**](/windows/desktop/api/iads/nn-iads-iads), [**IADsUser**](/windows/desktop/api/iads/nn-iads-iadsuser), and [**IADsPropertyList**](/windows/desktop/api/iads/nn-iads-iadspropertylist) interface pointers to the user object.</span></span> <span data-ttu-id="bcea4-116">Cela signifie que vous pouvez obtenir des pointeurs d’interface vers chaque objet utilisateur énuméré dans un conteneur sans avoir à effectuer une liaison explicite à chaque objet utilisateur.</span><span class="sxs-lookup"><span data-stu-id="bcea4-116">This means you can get interface pointers to each enumerated user object in a container without having to explicitly bind to each user object.</span></span> <span data-ttu-id="bcea4-117">Pour effectuer des opérations sur tous les utilisateurs directement dans un conteneur, l’énumération évite d’avoir à établir une liaison à chaque utilisateur afin d’appeler des méthodes **IADs** ou **IADsUser** .</span><span class="sxs-lookup"><span data-stu-id="bcea4-117">To perform operations on all the users directly within a container, enumeration avoids having to bind to each user in order to call **IADs** or **IADsUser** methods.</span></span> <span data-ttu-id="bcea4-118">Pour récupérer des propriétés spécifiques des utilisateurs, utilisez [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) comme décrit dans l’option 2.</span><span class="sxs-lookup"><span data-stu-id="bcea4-118">To retrieve specific properties from users, use [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) as described in option 2.</span></span>

-   <span data-ttu-id="bcea4-119">Effectuez une recherche détaillée (& (objectClass = user) (objectCategory = person)) pour rechercher tous les utilisateurs dans une arborescence :</span><span class="sxs-lookup"><span data-stu-id="bcea4-119">Perform a deep search for (&(objectClass=user)(objectCategory=person)) to find all users in a tree:</span></span>

    <span data-ttu-id="bcea4-120">Tout d’abord, établissez une liaison avec l’objet conteneur où commencer la recherche.</span><span class="sxs-lookup"><span data-stu-id="bcea4-120">First, bind to the container object where to begin the search.</span></span> <span data-ttu-id="bcea4-121">Par exemple, pour rechercher tous les utilisateurs dans un domaine, établissez une liaison à la racine du domaine. pour rechercher tous les utilisateurs de la forêt, établissez une liaison au catalogue global et recherchez à partir de la racine du GC.</span><span class="sxs-lookup"><span data-stu-id="bcea4-121">For example, to find all users in a domain, bind to root of the domain; to find all users in the forest, bind to the global catalog and search from the root of the GC.</span></span>

    <span data-ttu-id="bcea4-122">Utilisez ensuite [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) pour interroger à l’aide d’un filtre de recherche contenant (& (objectClass = user) (objectcategory = person)) et la préférence de recherche de la \_ sous-arborescence étendue ADS \_ .</span><span class="sxs-lookup"><span data-stu-id="bcea4-122">Then use [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) to query using a search filter containing (&(objectClass=user)(objectCategory=person)) and search preference of ADS\_SCOPE\_SUBTREE.</span></span>

    <span data-ttu-id="bcea4-123">Vous pouvez effectuer une recherche à l’aide d’une préférence de recherche de \_ l’étendue ad \_ onelevel pour limiter la recherche au contenu direct de l’objet conteneur auquel vous êtes lié.</span><span class="sxs-lookup"><span data-stu-id="bcea4-123">You can perform a search with a search preference of ADS\_SCOPE\_ONELEVEL to limit the search to the direct contents of the container object that you bound to.</span></span>

    <span data-ttu-id="bcea4-124">[**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) récupère uniquement les valeurs des propriétés spécifiques des utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="bcea4-124">[**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) retrieves only the values of specific properties from users.</span></span> <span data-ttu-id="bcea4-125">Pour récupérer des valeurs, utilisez **IDirectorySearch**.</span><span class="sxs-lookup"><span data-stu-id="bcea4-125">To retrieve values, use **IDirectorySearch**.</span></span> <span data-ttu-id="bcea4-126">Pour manipuler les objets utilisateur retournés par une recherche, autrement dit, vous souhaitez utiliser des méthodes [**IADs**](/windows/desktop/api/iads/nn-iads-iads) ou [**IADsUser**](/windows/desktop/api/iads/nn-iads-iadsuser) , vous devez les lier explicitement.</span><span class="sxs-lookup"><span data-stu-id="bcea4-126">To manipulate the user objects returned from a search, that is, you want to use [**IADs**](/windows/desktop/api/iads/nn-iads-iads) or [**IADsUser**](/windows/desktop/api/iads/nn-iads-iadsuser) methods, you must explicitly bind to them.</span></span> <span data-ttu-id="bcea4-127">Pour ce faire, spécifiez **distinguishedName** comme l’une des propriétés à retourner à partir de la recherche et utilisez les noms distinctifs retournés pour établir une liaison à chaque utilisateur retourné dans la recherche.</span><span class="sxs-lookup"><span data-stu-id="bcea4-127">To do this, specify **distinguishedName** as one of the properties to return from the search and use the returned distinguished names to bind to each user returned in the search.</span></span>

    <span data-ttu-id="bcea4-128">Seules les propriétés spécifiques sont récupérées.</span><span class="sxs-lookup"><span data-stu-id="bcea4-128">Only specific properties are retrieved.</span></span> <span data-ttu-id="bcea4-129">Vous ne pouvez pas récupérer tous les attributs sans spécifier explicitement chaque attribut possible de la classe utilisateur.</span><span class="sxs-lookup"><span data-stu-id="bcea4-129">You cannot retrieve all attributes without explicitly specifying every possible attribute of the user class.</span></span>

 

 