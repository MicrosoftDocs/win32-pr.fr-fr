---
title: Sélecteur d’objets d’annuaire
description: La boîte de dialogue Sélecteur d’objets d’annuaire permet à un utilisateur de sélectionner un ou plusieurs objets à partir du catalogue global, d’un domaine ou d’un ordinateur ou d’un groupe de travail.
ms.assetid: 5b3e5d71-afd2-49db-b3a2-f9a49f0b2b3a
ms.tgt_platform: multiple
keywords:
- Active Directory Object Picker AD
- sélecteur d’objet AD
- objets AD, sélecteur d’objets
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 24f6ba7fd053aa8ab3245bf72c693f0a887aa983
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/17/2020
ms.locfileid: "104031017"
---
# <a name="directory-object-picker"></a><span data-ttu-id="5c1db-106">Sélecteur d’objets d’annuaire</span><span class="sxs-lookup"><span data-stu-id="5c1db-106">Directory Object Picker</span></span>

<span data-ttu-id="5c1db-107">La boîte de dialogue Sélecteur d’objets d’annuaire permet à un utilisateur de sélectionner un ou plusieurs objets à partir du catalogue global, d’un domaine ou d’un ordinateur ou d’un groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="5c1db-107">The directory object picker dialog box enables a user to select one or more objects from either the global catalog, a domain or computer, or a workgroup.</span></span> <span data-ttu-id="5c1db-108">Les types d’objets à partir desquels un utilisateur peut sélectionner incluent les objets d’utilisateur, de contact, de groupe et d’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="5c1db-108">The object types from which a user can select include user, contact, group, and computer objects.</span></span> <span data-ttu-id="5c1db-109">Pour plus d’informations sur Active Directory Domain Services, consultez [Active Directory Domain Services](active-directory-domain-services.md).</span><span class="sxs-lookup"><span data-stu-id="5c1db-109">For more information about Active Directory Domain Services, see [Active Directory Domain Services](active-directory-domain-services.md).</span></span>

<span data-ttu-id="5c1db-110">Pour afficher une boîte de dialogue Sélecteur d’objets :</span><span class="sxs-lookup"><span data-stu-id="5c1db-110">To display an object picker dialog box:</span></span>

1.  <span data-ttu-id="5c1db-111">Appelez la fonction [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) ou [**CoCreateInstanceEx**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstanceex) pour créer une instance de l’interface [**IDsObjectPicker**](/windows/desktop/api/Objsel/nn-objsel-idsobjectpicker) .</span><span class="sxs-lookup"><span data-stu-id="5c1db-111">Call the [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) or [**CoCreateInstanceEx**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstanceex) function to create an instance of the [**IDsObjectPicker**](/windows/desktop/api/Objsel/nn-objsel-idsobjectpicker) interface.</span></span>
2.  <span data-ttu-id="5c1db-112">Appelez la méthode [**IDsObjectPicker :: Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) pour initialiser la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="5c1db-112">Call the [**IDsObjectPicker::Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) method to initialize the dialog box.</span></span>
3.  <span data-ttu-id="5c1db-113">Appelez la méthode [**IDsObjectPicker :: InvokeDialog**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-invokedialog) pour afficher la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="5c1db-113">Call the [**IDsObjectPicker::InvokeDialog**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-invokedialog) method to display the dialog box.</span></span>
4.  <span data-ttu-id="5c1db-114">Appelez la méthode [**IDataObject :: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) de l’instance [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) renvoyée par la boîte de dialogue Sélecteur d’objets pour récupérer les données de la [**\_ \_ \_ \_ liste de sélection CFSTR DSOP DS**](cfstr-dsop-ds-selection-list.md) .</span><span class="sxs-lookup"><span data-stu-id="5c1db-114">Call the [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method of the [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) instance returned by the object picker dialog box to retrieve the [**CFSTR\_DSOP\_DS\_SELECTION\_LIST**](cfstr-dsop-ds-selection-list.md) data.</span></span> <span data-ttu-id="5c1db-115">Le format de presse-papiers de la **\_ \_ \_ \_ liste de sélection DS CFSTR DSOP** fournit un **HGLOBAL** qui contient une structure de [**\_ \_ liste de sélection des services d’annuaire**](/windows/desktop/api/Objsel/ns-objsel-ds_selection_list) .</span><span class="sxs-lookup"><span data-stu-id="5c1db-115">The **CFSTR\_DSOP\_DS\_SELECTION\_LIST** clipboard format provides an **HGLOBAL** that contains a [**DS\_SELECTION\_LIST**](/windows/desktop/api/Objsel/ns-objsel-ds_selection_list) structure.</span></span> <span data-ttu-id="5c1db-116">La structure de la **\_ \_ liste de sélection des services d’annuaire** contient des données sur les éléments sélectionnés dans la boîte de dialogue Sélecteur d’objets.</span><span class="sxs-lookup"><span data-stu-id="5c1db-116">The **DS\_SELECTION\_LIST** structure contains data about the items selected in the object picker dialog box.</span></span>

<span data-ttu-id="5c1db-117">Si l’identificateur de sécurité (SID) est requis pour un objet, celui-ci doit être demandé directement à partir du sélecteur d’objets en ajoutant l’attribut **objectSID** à la liste d’attributs à récupérer pour l’objet sélectionné.</span><span class="sxs-lookup"><span data-stu-id="5c1db-117">If the Security Identifier (SID) is required for an object, this should be requested directly from the object picker by adding the **objectSID** attribute to the list of attributes to retrieve for the selected object.</span></span> <span data-ttu-id="5c1db-118">La transmission du nom d’objet retourné à la fonction [**LsaLookupNames**](/windows/desktop/api/ntsecapi/nf-ntsecapi-lsalookupnames) ou [**LookupAccountName**](/windows/desktop/api/winbase/nf-winbase-lookupaccountnamea) n’est pas recommandée, car la recherche de nom sera redondante et risque d’échouer dans certains cas.</span><span class="sxs-lookup"><span data-stu-id="5c1db-118">Passing the returned object name to the [**LsaLookupNames**](/windows/desktop/api/ntsecapi/nf-ntsecapi-lsalookupnames) or [**LookupAccountName**](/windows/desktop/api/winbase/nf-winbase-lookupaccountnamea) function is not recommended because the name lookup will be redundant and may fail in some cases.</span></span>

<span data-ttu-id="5c1db-119">Si une référence à des objets sélectionnés est enregistrée, le nom unique ne doit pas être enregistré, car l’objet peut être déplacé, renommé ou peut être modifié en raison de différences de paramètres régionaux.</span><span class="sxs-lookup"><span data-stu-id="5c1db-119">If a reference to any selected objects will be saved, the distinguished name should not be saved because the object may move, get renamed, or may change due to locale differences.</span></span> <span data-ttu-id="5c1db-120">Pour les principaux de sécurité, l' **objectSID** doit être demandé pour l’objet et enregistré en toute sécurité.</span><span class="sxs-lookup"><span data-stu-id="5c1db-120">For security principals, the **objectSID** should be requested for the object and securely saved.</span></span> <span data-ttu-id="5c1db-121">Si le nom du principal de sécurité est nécessaire ultérieurement, il peut être récupéré avec la fonction [**LookupAccountSid**](/windows/desktop/api/winbase/nf-winbase-lookupaccountsida) .</span><span class="sxs-lookup"><span data-stu-id="5c1db-121">If the name of the security principal is needed later, it can be retrieved with the [**LookupAccountSid**](/windows/desktop/api/winbase/nf-winbase-lookupaccountsida) function.</span></span> <span data-ttu-id="5c1db-122">Pour tous les autres objets, l' **objectGUID** doit être demandé et enregistré.</span><span class="sxs-lookup"><span data-stu-id="5c1db-122">For all other objects, the **objectGUID** should be requested and saved.</span></span>

## <a name="initialization"></a><span data-ttu-id="5c1db-123">Initialisation</span><span class="sxs-lookup"><span data-stu-id="5c1db-123">Initialization</span></span>

<span data-ttu-id="5c1db-124">Quand la boîte de dialogue Sélecteur d’objets est initialisée, un ensemble de types et de filtres d’étendue est spécifié.</span><span class="sxs-lookup"><span data-stu-id="5c1db-124">When the object picker dialog box is initialized, a set of scope types and filters is specified.</span></span> <span data-ttu-id="5c1db-125">Les types d’étendues spécifiés déterminent, par exemple, les emplacements, les domaines ou les ordinateurs à partir desquels un utilisateur peut sélectionner des objets.</span><span class="sxs-lookup"><span data-stu-id="5c1db-125">The specified scope types determine the locations, domains or computers for example, from which a user can select objects.</span></span> <span data-ttu-id="5c1db-126">Les filtres déterminent les types d’objets qu’un utilisateur peut sélectionner à partir d’un type d’étendue donné.</span><span class="sxs-lookup"><span data-stu-id="5c1db-126">The filters determine the types of objects that a user can select from a given scope type.</span></span> <span data-ttu-id="5c1db-127">Pour plus d’informations, consultez la section étendues et filtres ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="5c1db-127">For more information, see the Scopes and Filters section below.</span></span>

<span data-ttu-id="5c1db-128">Par défaut, un utilisateur peut sélectionner un seul objet dans la boîte de dialogue Sélecteur d’objets d’annuaire.</span><span class="sxs-lookup"><span data-stu-id="5c1db-128">By default, a user can select a single object in the directory object picker dialog box.</span></span> <span data-ttu-id="5c1db-129">Pour activer plusieurs sélections, définissez l’indicateur de **\_ \_ multisélection DSOP Flag** dans le membre **flOptions** de la structure d' [**\_ \_ informations init DSOP**](/windows/desktop/api/Objsel/ns-objsel-dsop_init_info) lorsque la boîte de dialogue est initialisée.</span><span class="sxs-lookup"><span data-stu-id="5c1db-129">To enable multiple selections, set the **DSOP\_FLAG\_MULTISELECT** flag in the **flOptions** member of the [**DSOP\_INIT\_INFO**](/windows/desktop/api/Objsel/ns-objsel-dsop_init_info) structure when the dialog box initialized.</span></span>

## <a name="scopes-and-filters"></a><span data-ttu-id="5c1db-130">Étendues et filtres</span><span class="sxs-lookup"><span data-stu-id="5c1db-130">Scopes and Filters</span></span>

<span data-ttu-id="5c1db-131">La liste déroulante **regarder dans** contient les étendues à partir desquelles un utilisateur peut sélectionner des objets.</span><span class="sxs-lookup"><span data-stu-id="5c1db-131">The **Look in** drop-down list contains the scopes from which a user can select objects.</span></span> <span data-ttu-id="5c1db-132">Une étendue est un domaine, un ordinateur, un groupe de travail ou un catalogue global qui stocke des données sur un ensemble d’objets disponibles et permet d’y accéder.</span><span class="sxs-lookup"><span data-stu-id="5c1db-132">A scope is a domain, computer, workgroup, or global catalog that stores data about, and provides access to, a set of available objects.</span></span> <span data-ttu-id="5c1db-133">Les entrées de la liste étendue dépendent des types d’étendue et de l’ordinateur cible spécifié lors du dernier appel de la méthode [**IDsObjectPicker :: Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) pour initialiser la boîte de dialogue Sélecteur d’objets.</span><span class="sxs-lookup"><span data-stu-id="5c1db-133">The entries in the scope list depend on the scope types and the target computer specified when the [**IDsObjectPicker::Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) method was last called to initialize the object picker dialog box.</span></span>

<span data-ttu-id="5c1db-134">Un type d’étendue est une catégorie générique d’étendues, telles que tous les domaines de l’entreprise à laquelle l’ordinateur cible appartient, ou le catalogue global pour l’entreprise de l’ordinateur cible, ou l’ordinateur cible lui-même.</span><span class="sxs-lookup"><span data-stu-id="5c1db-134">A scope type is a generic category of scopes, such as all domains in the enterprise to which the target computer belongs, or the global catalog for the target computer's enterprise, or the target computer itself.</span></span> <span data-ttu-id="5c1db-135">Pour chaque type d’étendue spécifié, la boîte de dialogue utilise le contexte de l’ordinateur cible pour déterminer les entrées de la liste d’étendues.</span><span class="sxs-lookup"><span data-stu-id="5c1db-135">For each specified scope type, the dialog box uses the context of the target computer to determine the scope list entries.</span></span>

<span data-ttu-id="5c1db-136">La méthode [**IDsObjectPicker :: Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) accepte un pointeur vers une structure [**d' \_ \_ informations d’initialisation DSOP**](/windows/desktop/api/Objsel/ns-objsel-dsop_init_info) qui contient un tableau de structures d' [**\_ \_ \_ informations init de portée DSOP**](/windows/desktop/api/Objsel/ns-objsel-dsop_scope_init_info) .</span><span class="sxs-lookup"><span data-stu-id="5c1db-136">The [**IDsObjectPicker::Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) method takes a pointer to a [**DSOP\_INIT\_INFO**](/windows/desktop/api/Objsel/ns-objsel-dsop_init_info) structure that contains an array of [**DSOP\_SCOPE\_INIT\_INFO**](/windows/desktop/api/Objsel/ns-objsel-dsop_scope_init_info) structures.</span></span> <span data-ttu-id="5c1db-137">Chaque entrée du tableau **d' \_ \_ \_ informations d’initialisation de l’étendue DSOP** spécifie un ou plusieurs types d’étendue, ainsi que les filtres applicables et d’autres attributs.</span><span class="sxs-lookup"><span data-stu-id="5c1db-137">Each entry in the **DSOP\_SCOPE\_INIT\_INFO** array specifies one or more scope types as well as applicable filters and other attributes.</span></span> <span data-ttu-id="5c1db-138">Les filtres déterminent les types d’objets, tels que les utilisateurs, les groupes, les contacts et les ordinateurs, que l’utilisateur peut sélectionner à partir d’un type d’étendue donné.</span><span class="sxs-lookup"><span data-stu-id="5c1db-138">The filters determine the types of objects, such as users, groups, contacts, and computers, that the user can select from a given scope type.</span></span> <span data-ttu-id="5c1db-139">Lorsque l’utilisateur sélectionne une étendue dans la liste, la boîte de dialogue applique les filtres de ce type d’étendue pour afficher la liste des objets que l’utilisateur peut sélectionner.</span><span class="sxs-lookup"><span data-stu-id="5c1db-139">When the user selects a scope from the list, the dialog box applies the filters for that scope type to display a list of objects from which the user can select.</span></span>

<span data-ttu-id="5c1db-140">Chaque structure d' [**\_ informations d' \_ initialisation \_ de portée DSOP**](/windows/desktop/api/Objsel/ns-objsel-dsop_scope_init_info) contient une structure d' [**\_ \_ indicateurs de filtre DSOP**](/windows/desktop/api/Objsel/ns-objsel-dsop_filter_flags) qui spécifie les filtres pour ce type d’étendue.</span><span class="sxs-lookup"><span data-stu-id="5c1db-140">Each [**DSOP\_SCOPE\_INIT\_INFO**](/windows/desktop/api/Objsel/ns-objsel-dsop_scope_init_info) structure contains a [**DSOP\_FILTER\_FLAGS**](/windows/desktop/api/Objsel/ns-objsel-dsop_filter_flags) structure that specifies the filters for that scope type.</span></span> <span data-ttu-id="5c1db-141">La structure d' **\_ \_ indicateurs de filtre DSOP** distingue les étendues de niveau supérieur et de niveau supérieur :</span><span class="sxs-lookup"><span data-stu-id="5c1db-141">The **DSOP\_FILTER\_FLAGS** structure distinguishes between up-level and down-level scopes:</span></span>

-   <span data-ttu-id="5c1db-142">Une étendue de niveau supérieur est un catalogue global ou un domaine qui prend en charge le [fournisseur LDAP](/windows/desktop/ADSI/adsi-ldap-provider)ADSI.</span><span class="sxs-lookup"><span data-stu-id="5c1db-142">An up-level scope is a global catalog or a domain that supports the ADSI [LDAP provider](/windows/desktop/ADSI/adsi-ldap-provider).</span></span>
-   <span data-ttu-id="5c1db-143">Une étendue de niveau supérieur comprend des groupes de travail et tous les ordinateurs individuels.</span><span class="sxs-lookup"><span data-stu-id="5c1db-143">A down-level scope includes workgroups and all individual computers.</span></span> <span data-ttu-id="5c1db-144">La boîte de dialogue utilise le fournisseur ADSI WinNT pour accéder à une étendue de niveau supérieur.</span><span class="sxs-lookup"><span data-stu-id="5c1db-144">The dialog box uses the ADSI WinNT provider to access a down-level scope.</span></span>

<span data-ttu-id="5c1db-145">Deux ensembles d’indicateurs de filtre sont définis pour être utilisés dans la structure d' [**\_ \_ indicateurs de filtre DSOP**](/windows/desktop/api/Objsel/ns-objsel-dsop_filter_flags) : un pour les portées de niveau supérieur et un pour les étendues de niveau inférieure.</span><span class="sxs-lookup"><span data-stu-id="5c1db-145">There are two sets of filter flags defined for use in the [**DSOP\_FILTER\_FLAGS**](/windows/desktop/api/Objsel/ns-objsel-dsop_filter_flags) structure: one for up-level scopes and one for down-level scopes.</span></span> <span data-ttu-id="5c1db-146">Le membre de **niveau supérieur** de la structure d' **\_ \_ indicateurs de filtre DSOP** est une structure d' [**indicateurs de \_ \_ filtre \_ de niveau supérieur DSOP**](/windows/desktop/api/Objsel/ns-objsel-dsop_uplevel_filter_flags) qui spécifie les filtres pour les portées de niveau supérieur.</span><span class="sxs-lookup"><span data-stu-id="5c1db-146">The **Uplevel** member of the **DSOP\_FILTER\_FLAGS** structure is a [**DSOP\_UPLEVEL\_FILTER\_FLAGS**](/windows/desktop/api/Objsel/ns-objsel-dsop_uplevel_filter_flags) structure that specifies the filters for up-level scopes.</span></span> <span data-ttu-id="5c1db-147">Le membre **flDownlevel** de la structure d' **\_ \_ indicateurs de filtre DSOP** est un ensemble d’indicateurs qui spécifient les filtres pour les portées de niveau inférieure.</span><span class="sxs-lookup"><span data-stu-id="5c1db-147">The **flDownlevel** member of the **DSOP\_FILTER\_FLAGS** structure is a set of flags that specify the filters for down-level scopes.</span></span>

 

 