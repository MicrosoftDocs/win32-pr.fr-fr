---
title: Traitement des résultats de la recherche
description: Après le premier appel à IDirectorySearch GetFirstRow ou IDirectorySearch GetNextRow, S \_ OK, s \_ ADS \_ \_ ou un résultat d’erreur est retourné.
ms.assetid: 3a84f394-a256-4815-901c-eaaae3d54b75
ms.tgt_platform: multiple
keywords:
- Traitement de l’AD des résultats de la recherche
- Active Directory, recherche, traitement des résultats de la recherche
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 732128438162f5ee8f6fe75bb4d2ce53e0d43070
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/17/2020
ms.locfileid: "106513516"
---
# <a name="processing-the-search-results"></a><span data-ttu-id="23f55-105">Traitement des résultats de la recherche</span><span class="sxs-lookup"><span data-stu-id="23f55-105">Processing the Search Results</span></span>

<span data-ttu-id="23f55-106">Après le premier appel à [**IDirectorySearch :: GetFirstRow**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getfirstrow) ou [**IDirectorySearch :: GetNextRow**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getnextrow), les annonces sont **\_ incorrectes** ou **\_ \_ bien \_**, ou un résultat d’erreur est retourné.</span><span class="sxs-lookup"><span data-stu-id="23f55-106">After the first call to [**IDirectorySearch::GetFirstRow**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getfirstrow) or [**IDirectorySearch::GetNextRow**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getnextrow), either **S\_OK**, **S\_ADS\_NOMORE\_ROWS**, or an error result is returned.</span></span>

<span data-ttu-id="23f55-107">Si la valeur de retour est « S », plus il y a de **\_ \_ \_ lignes**, plus aucun objet correspondant au filtre n’a été trouvé.</span><span class="sxs-lookup"><span data-stu-id="23f55-107">If the return value is **S\_ADS\_NOMORE\_ROWS**, no more objects matching the filter were found.</span></span> <span data-ttu-id="23f55-108">Si un résultat d’erreur est retourné, la requête a échoué.</span><span class="sxs-lookup"><span data-stu-id="23f55-108">If an error result is returned, the query failed.</span></span> <span data-ttu-id="23f55-109">Dans les deux cas, vous n’êtes pas obligé de traiter les lignes dans le résultat, car rien n’a été retourné.</span><span class="sxs-lookup"><span data-stu-id="23f55-109">In both cases, you are not required to process the rows in the result because nothing was returned.</span></span>

<span data-ttu-id="23f55-110">Si la condition **S \_ OK** est retournée, une ligne a été récupérée.</span><span class="sxs-lookup"><span data-stu-id="23f55-110">If **S\_OK** is returned, a row has been retrieved.</span></span> <span data-ttu-id="23f55-111">Vous pouvez analyser les colonnes par nom à l’aide de [**IDirectorySearch :: GetColumn**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getcolumn).</span><span class="sxs-lookup"><span data-stu-id="23f55-111">You can parse the columns by name using [**IDirectorySearch::GetColumn**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getcolumn).</span></span> <span data-ttu-id="23f55-112">Le nom est le **lDAPDisplayName** de l’attribut dans la colonne.</span><span class="sxs-lookup"><span data-stu-id="23f55-112">The name is the **lDAPDisplayName** of the attribute in the column.</span></span> <span data-ttu-id="23f55-113">L’ensemble de toutes les colonnes a été défini par le paramètre pAttributeNames de la méthode [**IDirectorySearch :: ExecuteSearch**](/windows/desktop/api/iads/nf-iads-idirectorysearch-executesearch) .</span><span class="sxs-lookup"><span data-stu-id="23f55-113">The set of all columns was defined by the pAttributeNames parameter of the [**IDirectorySearch::ExecuteSearch**](/windows/desktop/api/iads/nf-iads-idirectorysearch-executesearch) method.</span></span> <span data-ttu-id="23f55-114">Si la **valeur null** a été spécifiée, le jeu de toutes les colonnes est l’Union de toutes les propriétés trouvées pour tous les objets retournés.</span><span class="sxs-lookup"><span data-stu-id="23f55-114">If **NULL** was specified, the set of all columns is the union of all properties found for all the objects returned.</span></span> <span data-ttu-id="23f55-115">Pour lire l’ensemble des colonnes retournées pour un objet, utilisez [**IDirectorySearch :: GetNextColumnName**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getnextcolumnname) pour effectuer une itération sur chaque colonne et utilisez le nom de colonne retourné pour appeler **IDirectorySearch :: GetColumn**.</span><span class="sxs-lookup"><span data-stu-id="23f55-115">To read the entire set of columns returned for an object, use the [**IDirectorySearch::GetNextColumnName**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getnextcolumnname) to iterate each column, and use the column name returned to call **IDirectorySearch::GetColumn**.</span></span>

<span data-ttu-id="23f55-116">La méthode [**IDirectorySearch :: GetColumn**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getcolumn) retourne une structure de [**\_ \_ colonne de recherche ADS**](/windows/desktop/api/iads/ns-iads-ads_search_column) qui contient le nom d’attribut, le type de l’attribut, le nombre de valeurs et un pointeur vers un tableau de structures [**ADSVALUE**](/windows/desktop/api/iads/ns-iads-adsvalue) qui contiennent les valeurs.</span><span class="sxs-lookup"><span data-stu-id="23f55-116">The [**IDirectorySearch::GetColumn**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getcolumn) method returns an [**ADS\_SEARCH\_COLUMN**](/windows/desktop/api/iads/ns-iads-ads_search_column) structure that contains the attribute name, the type of the attribute, count of values, and a pointer to an array of [**ADSVALUE**](/windows/desktop/api/iads/ns-iads-adsvalue) structures that contain the values.</span></span> <span data-ttu-id="23f55-117">Vous pouvez parcourir les structures **ADSVALUE** pour lire les valeurs de la propriété retournée par la colonne.</span><span class="sxs-lookup"><span data-stu-id="23f55-117">You can loop through the **ADSVALUE** structures to read the values for the property returned by the column.</span></span> <span data-ttu-id="23f55-118">Vous devez lire le membre approprié de la structure **ADSVALUE** en fonction du [**ADSTYPE**](/windows/win32/api/iads/ne-iads-adstypeenum) spécifié par le membre **dwADsType** de la structure de **\_ \_ colonne de recherche ADS** (ou du membre **dwType** de la structure **ADSVALUE** ).</span><span class="sxs-lookup"><span data-stu-id="23f55-118">You must read the appropriate member of the **ADSVALUE** structure based on the [**ADSTYPE**](/windows/win32/api/iads/ne-iads-adstypeenum) specified by the **dwADsType** member of the **ADS\_SEARCH\_COLUMN** structure (or the **dwType** member of the **ADSVALUE** structure).</span></span> <span data-ttu-id="23f55-119">Par exemple, si **dwADsType** était **ADSTYPE \_ Integer**, vous devez lire le membre **Integer** de chaque structure **ADSVALUE** .</span><span class="sxs-lookup"><span data-stu-id="23f55-119">For example, if **dwADsType** was **ADSTYPE\_INTEGER**, you would read the **Integer** member of each **ADSVALUE** structure.</span></span>

<span data-ttu-id="23f55-120">Pour plus d’informations et pour obtenir un exemple de code, consultez [exemple de code pour rechercher des utilisateurs](example-code-for-searching-for-users.md).</span><span class="sxs-lookup"><span data-stu-id="23f55-120">For more information and a code example, see [Example Code for Searching for Users](example-code-for-searching-for-users.md).</span></span>

 

 