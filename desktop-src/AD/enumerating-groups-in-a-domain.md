---
title: Énumération des groupes dans un domaine
description: Les groupes peuvent être placés dans n’importe quel conteneur ou unité d’organisation (ou) dans un domaine, ainsi que la racine du domaine.
ms.assetid: 7f9d3c90-b6f4-4bfa-960f-58f380aa487c
ms.tgt_platform: multiple
keywords:
- Énumération des groupes dans un domaine AD
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3586b8c6d261c769cabe56def2aa9396a58fa3a5
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/17/2020
ms.locfileid: "103724564"
---
# <a name="enumerating-groups-in-a-domain"></a><span data-ttu-id="fc9d8-104">Énumération des groupes dans un domaine</span><span class="sxs-lookup"><span data-stu-id="fc9d8-104">Enumerating Groups in a Domain</span></span>

<span data-ttu-id="fc9d8-105">Les groupes peuvent être placés dans n’importe quel conteneur ou unité d’organisation (ou) dans un domaine, ainsi que la racine du domaine.</span><span class="sxs-lookup"><span data-stu-id="fc9d8-105">Groups can be placed in any container or organizational unit (OU) in a domain as well as the root of the domain.</span></span> <span data-ttu-id="fc9d8-106">Cela signifie que les groupes peuvent se trouver à de nombreux emplacements dans la hiérarchie de répertoires.</span><span class="sxs-lookup"><span data-stu-id="fc9d8-106">This means that groups can be in numerous locations in the directory hierarchy.</span></span> <span data-ttu-id="fc9d8-107">Par conséquent, vous avez deux possibilités pour énumérer des groupes :</span><span class="sxs-lookup"><span data-stu-id="fc9d8-107">Therefore, you have two choices for enumerating groups:</span></span>

1.  <span data-ttu-id="fc9d8-108">Énumérez les groupes contenus directement dans un conteneur, une unité d’organisation ou à la racine du domaine.</span><span class="sxs-lookup"><span data-stu-id="fc9d8-108">Enumerate the groups directly contained in a container, OU, or at the root of the domain.</span></span>

    <span data-ttu-id="fc9d8-109">Établissez une liaison explicite à l’objet conteneur qui contient les groupes à énumérer, définissez un filtre qui contient « Groups » en tant que classe à l’aide de la propriété [**IADsContainer. Filter**](/windows/desktop/api/iads/nn-iads-iadscontainer) et utilisez la méthode [**IADsContainer :: obtenir \_ \_ NewEnum**](/windows/desktop/api/iads/nf-iads-iadscontainer-get__newenum) pour énumérer les objets de groupe.</span><span class="sxs-lookup"><span data-stu-id="fc9d8-109">Explicitly bind to the container object that contains the groups to enumerate, set a filter that contains "groups" as the class using the [**IADsContainer.Filter**](/windows/desktop/api/iads/nn-iads-iadscontainer) property, and use the [**IADsContainer::get\_\_NewEnum**](/windows/desktop/api/iads/nf-iads-iadscontainer-get__newenum) method to enumerate the group objects.</span></span>

    <span data-ttu-id="fc9d8-110">Cette technique énumère les groupes contenus directement dans un conteneur ou un objet d’unité d’organisation.</span><span class="sxs-lookup"><span data-stu-id="fc9d8-110">This technique enumerates groups contained directly in a container or OU object.</span></span> <span data-ttu-id="fc9d8-111">Si le conteneur contient d’autres conteneurs qui peuvent potentiellement contenir d’autres groupes, vous devez les lier à ces conteneurs et énumérer de manière récursive les groupes sur ces conteneurs.</span><span class="sxs-lookup"><span data-stu-id="fc9d8-111">If the container contains other containers that can potentially contain other groups, you must bind to those containers and recursively enumerate the groups on those containers.</span></span> <span data-ttu-id="fc9d8-112">Pour manipuler les objets de groupe et lire uniquement des propriétés spécifiques, utilisez la recherche détaillée décrite dans l’option 2.</span><span class="sxs-lookup"><span data-stu-id="fc9d8-112">To manipulate the group objects and read only specific properties, use the deep search described in Option 2.</span></span>

    <span data-ttu-id="fc9d8-113">Étant donné que l’énumération retourne des pointeurs vers des objets COM ADSI représentant chaque objet de groupe, vous pouvez appeler [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) pour récupérer les pointeurs d’interface [**IADs**](/windows/desktop/api/iads/nn-iads-iads), [**IADsGroup**](/windows/desktop/api/iads/nn-iads-iadsgroup)et [**IADsPropertyList**](/windows/desktop/api/iads/nn-iads-iadspropertylist) sur l’objet de groupe. autrement dit, vous pouvez obtenir des pointeurs d’interface vers chaque objet de groupe énuméré dans un conteneur sans avoir à effectuer une liaison explicite à chaque objet de groupe.</span><span class="sxs-lookup"><span data-stu-id="fc9d8-113">Because enumeration returns pointers to ADSI COM objects representing each group object, you can call [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) to get [**IADs**](/windows/desktop/api/iads/nn-iads-iads), [**IADsGroup**](/windows/desktop/api/iads/nn-iads-iadsgroup), and [**IADsPropertyList**](/windows/desktop/api/iads/nn-iads-iadspropertylist) interface pointers to the group object; that is, you can get interface pointers to each enumerated group object in a container without having to explicitly bind to each group object.</span></span> <span data-ttu-id="fc9d8-114">Pour effectuer des opérations sur tous les groupes directement dans un conteneur, l’énumération ne requiert pas de liaison à chaque groupe afin d’appeler des méthodes **IADs** ou **IADsGroup** .</span><span class="sxs-lookup"><span data-stu-id="fc9d8-114">To perform operations on all the groups directly within a container, enumeration does not require binding to each group in order to call **IADs** or **IADsGroup** methods.</span></span> <span data-ttu-id="fc9d8-115">Pour récupérer des propriétés spécifiques à partir de groupes, utilisez [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) comme décrit dans la deuxième option.</span><span class="sxs-lookup"><span data-stu-id="fc9d8-115">To retrieve specific properties from groups, use [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) as described in the second option.</span></span>

    <span data-ttu-id="fc9d8-116">Une exception à cette situation se produit lorsque vous tentez d’énumérer un groupe qui contient des membres qui sont des principaux de sécurité wellKnown, tels que tout le monde, utilisateurs authentifiés, traitement par lots, etc.</span><span class="sxs-lookup"><span data-stu-id="fc9d8-116">An exception to this occurs when you attempt to enumerate a group that contains members that are wellKnown security principals, such as Everyone, Authenticated users, BATCH, and so on.</span></span> <span data-ttu-id="fc9d8-117">Étant donné que vous ne pouvez pas lier ces types d’objets, ils ne sont pas répertoriés quand vous énumérez des groupes dans l’étendue WinNT, même s’il peut sembler être lié, car certaines méthodes IADs telles que Class, ADsPath et Name retournent des résultats corrects lorsqu’ils sont appelés sur des membres énumérés.</span><span class="sxs-lookup"><span data-stu-id="fc9d8-117">Because you cannot bind to these types of objects, they are not listed when you enumerate groups in the WinNT scope, even though it may appear to bind, because certain IADs methods such as Class, ADsPath, and Name return correct results when invoked on enumerated members.</span></span>

2.  <span data-ttu-id="fc9d8-118">Effectuez une recherche complète sur « objectCategory = Group » pour rechercher tous les groupes dans une arborescence.</span><span class="sxs-lookup"><span data-stu-id="fc9d8-118">Perform a deep search for "objectCategory=group" to find all groups in a tree.</span></span>

    <span data-ttu-id="fc9d8-119">Tout d’abord, établissez une liaison avec l’objet conteneur où commencer la recherche.</span><span class="sxs-lookup"><span data-stu-id="fc9d8-119">First, bind to the container object where to begin the search.</span></span> <span data-ttu-id="fc9d8-120">Par exemple, pour rechercher tous les groupes d’un domaine, établissez une liaison à la racine du domaine ; pour rechercher tous les groupes de la forêt, établissez une liaison avec le catalogue global et recherchez à partir de la racine du GC.</span><span class="sxs-lookup"><span data-stu-id="fc9d8-120">For example, to find all groups in a domain, bind to root of the domain; to find all groups in the forest, bind to global catalog and search from the root of the GC.</span></span>

    <span data-ttu-id="fc9d8-121">Utilisez ensuite [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) pour interroger à l’aide d’un filtre de recherche contenant (objectCategory = Group) et des préférences de recherche de la **\_ sous- \_ arborescence étendue ADS**.</span><span class="sxs-lookup"><span data-stu-id="fc9d8-121">Then use [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) to query using a search filter that contains (objectCategory=group) and search preference of **ADS\_SCOPE\_SUBTREE**.</span></span>

    > [!Note]  
    > <span data-ttu-id="fc9d8-122">Vous pouvez effectuer une recherche à l’aide d’une préférence de recherche de l' **\_ étendue ad \_ onelevel** pour limiter la recherche au contenu direct de l’objet conteneur auquel vous êtes lié.</span><span class="sxs-lookup"><span data-stu-id="fc9d8-122">You can perform a search with a search preference of **ADS\_SCOPE\_ONELEVEL** to limit the search to the direct contents of the container object that you bound to.</span></span>

     

    <span data-ttu-id="fc9d8-123">[**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) récupère uniquement les valeurs des propriétés spécifiques des groupes.</span><span class="sxs-lookup"><span data-stu-id="fc9d8-123">[**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) retrieves only the values of specific properties from groups.</span></span> <span data-ttu-id="fc9d8-124">Pour récupérer des valeurs, utilisez **IDirectorySearch**.</span><span class="sxs-lookup"><span data-stu-id="fc9d8-124">To retrieve values, use **IDirectorySearch**.</span></span> <span data-ttu-id="fc9d8-125">Pour manipuler les objets de groupe retournés à partir d’une recherche, autrement dit, pour utiliser des méthodes [**IADs**](/windows/desktop/api/iads/nn-iads-iads) ou [**IADsGroup**](/windows/desktop/api/iads/nn-iads-iadsgroup) , établissez une liaison explicite avec eux.</span><span class="sxs-lookup"><span data-stu-id="fc9d8-125">To manipulate the group objects returned from a search, that is, to use [**IADs**](/windows/desktop/api/iads/nn-iads-iads) or [**IADsGroup**](/windows/desktop/api/iads/nn-iads-iadsgroup) methods, explicitly bind to them.</span></span> <span data-ttu-id="fc9d8-126">Pour ce faire, spécifiez **distinguishedName** comme l’une des propriétés à retourner à partir de la recherche et utilisez les noms distinctifs retournés pour établir une liaison à chaque groupe retourné dans la recherche.</span><span class="sxs-lookup"><span data-stu-id="fc9d8-126">To do this, specify **distinguishedName** as one of the properties to return from the search and use the returned distinguished names to bind to each group returned in the search.</span></span>

    <span data-ttu-id="fc9d8-127">Seules les propriétés spécifiques sont récupérées.</span><span class="sxs-lookup"><span data-stu-id="fc9d8-127">Only specific properties are retrieved.</span></span> <span data-ttu-id="fc9d8-128">Vous ne pouvez pas récupérer tous les attributs sans spécifier explicitement chaque attribut possible de la classe de groupe.</span><span class="sxs-lookup"><span data-stu-id="fc9d8-128">You cannot retrieve all attributes without explicitly specifying every possible attribute of the group class.</span></span>

 

 