---
title: Notifications de modifications dans Active Directory Domain Services
description: Active Directory Domain Services fournir un mécanisme permettant à une application cliente de s’inscrire auprès d’un contrôleur de domaine pour recevoir des notifications de modification.
ms.assetid: 27f6c7c1-b32e-457a-9be5-47836d097ab1
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ee564727cfbcb2bfdb367f822fdc137bca7c4e37
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/17/2020
ms.locfileid: "104031050"
---
# <a name="change-notifications-in-active-directory-domain-services"></a><span data-ttu-id="c5542-103">Notifications de modifications dans Active Directory Domain Services</span><span class="sxs-lookup"><span data-stu-id="c5542-103">Change Notifications in Active Directory Domain Services</span></span>

<span data-ttu-id="c5542-104">Active Directory Domain Services fournir un mécanisme permettant à une application cliente de s’inscrire auprès d’un contrôleur de domaine pour recevoir des notifications de modification.</span><span class="sxs-lookup"><span data-stu-id="c5542-104">Active Directory Domain Services provide a mechanism for a client application to register with a domain controller to receive change notifications.</span></span> <span data-ttu-id="c5542-105">Pour ce faire, le client spécifie le contrôle de notification de modification LDAP dans une opération de recherche LDAP asynchrone.</span><span class="sxs-lookup"><span data-stu-id="c5542-105">To do this, the client specifies the LDAP change notification control in an asynchronous LDAP search operation.</span></span> <span data-ttu-id="c5542-106">Le client spécifie également les paramètres de recherche suivants.</span><span class="sxs-lookup"><span data-stu-id="c5542-106">The client also specifies the following search parameters.</span></span>



| <span data-ttu-id="c5542-107">Paramètre</span><span class="sxs-lookup"><span data-stu-id="c5542-107">Parameter</span></span>             | <span data-ttu-id="c5542-108">Description</span><span class="sxs-lookup"><span data-stu-id="c5542-108">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|-----------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="c5542-109">Étendue</span><span class="sxs-lookup"><span data-stu-id="c5542-109">Scope</span></span><br/>      | <span data-ttu-id="c5542-110">Spécifiez soit la **\_ \_ base de l’étendue LDAP** pour surveiller uniquement l’objet, soit l' **\_ étendue LDAP \_** pour surveiller les enfants immédiats de l’objet, à l’exclusion de l’objet lui-même.</span><span class="sxs-lookup"><span data-stu-id="c5542-110">Specify either **LDAP\_SCOPE\_BASE** to monitor just the object, or **LDAP\_SCOPE\_ONELEVEL** to monitor the immediate children of the object, not including the object itself.</span></span> <span data-ttu-id="c5542-111">Ne spécifiez pas la **\_ sous- \_ arborescence de l’étendue LDAP**.</span><span class="sxs-lookup"><span data-stu-id="c5542-111">Do not specify **LDAP\_SCOPE\_SUBTREE**.</span></span> <span data-ttu-id="c5542-112">Bien que l’étendue de la sous-arborescence soit prise en charge si l’objet de base est la racine d’un contexte d’appellation, son utilisation peut avoir un impact considérable sur les performances du serveur, car elle génère un message de résultat de recherche LDAP chaque fois qu’un objet dans le contexte d’appellation est modifié.</span><span class="sxs-lookup"><span data-stu-id="c5542-112">Although the subtree scope is supported if the base object is the root of a naming context, its use can severely impact server performance, because it generates an LDAP search result message every time an object in the naming context is modified.</span></span> <span data-ttu-id="c5542-113">Vous ne pouvez pas spécifier la **\_ sous- \_ arborescence étendue LDAP** pour une sous-arborescence arbitraire.</span><span class="sxs-lookup"><span data-stu-id="c5542-113">You cannot specify **LDAP\_SCOPE\_SUBTREE** for an arbitrary subtree.</span></span><br/> |
| <span data-ttu-id="c5542-114">Filtrer</span><span class="sxs-lookup"><span data-stu-id="c5542-114">Filter</span></span><br/>     | <span data-ttu-id="c5542-115">Spécifiez un filtre de recherche « (objectClass = \* ) », ce qui signifie que vous recevez des notifications pour les modifications apportées à un objet dans l’étendue spécifiée.</span><span class="sxs-lookup"><span data-stu-id="c5542-115">Specify a search filter of "(objectclass=\*)", which means you receive notifications for changes to any object in the specified scope.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                |
| <span data-ttu-id="c5542-116">Attributs</span><span class="sxs-lookup"><span data-stu-id="c5542-116">Attributes</span></span><br/> | <span data-ttu-id="c5542-117">Spécifiez une liste d’attributs à retourner lorsqu’une modification se produit.</span><span class="sxs-lookup"><span data-stu-id="c5542-117">Specify a list of attributes to return when a change occurs.</span></span> <span data-ttu-id="c5542-118">N’oubliez pas que vous recevez des notifications lorsqu’un attribut est modifié, pas seulement les attributs spécifiés.</span><span class="sxs-lookup"><span data-stu-id="c5542-118">Be aware that you receive notifications when any attribute is modified, not just the specified attributes.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                               |



 

<span data-ttu-id="c5542-119">Vous pouvez inscrire jusqu’à cinq demandes de notification sur une seule connexion LDAP.</span><span class="sxs-lookup"><span data-stu-id="c5542-119">You can register up to five notification requests on a single LDAP connection.</span></span> <span data-ttu-id="c5542-120">Vous devez disposer d’un thread dédié qui attend les notifications et les traite rapidement.</span><span class="sxs-lookup"><span data-stu-id="c5542-120">You must have a dedicated thread that waits for the notifications and processes them quickly.</span></span> <span data-ttu-id="c5542-121">Lorsque vous appelez la \_ fonction LDAP Search \_ ext pour inscrire une demande de notification, la fonction retourne un identificateur de message qui identifie cette demande.</span><span class="sxs-lookup"><span data-stu-id="c5542-121">When you call the ldap\_search\_ext function to register a notification request, the function returns a message identifier that identifies that request.</span></span> <span data-ttu-id="c5542-122">Vous utilisez ensuite la fonction [**LDAP \_ result**](/previous-versions/windows/desktop/api/winldap/nf-winldap-ldap_result) pour attendre les notifications de modification.</span><span class="sxs-lookup"><span data-stu-id="c5542-122">You then use the [**ldap\_result**](/previous-versions/windows/desktop/api/winldap/nf-winldap-ldap_result) function to wait for change notifications.</span></span> <span data-ttu-id="c5542-123">Lorsqu’une modification se produit, le serveur envoie un message LDAP contenant l’identificateur de message pour la demande de notification qui a généré la notification.</span><span class="sxs-lookup"><span data-stu-id="c5542-123">When a change occurs, the server sends you an LDAP message that contains the message identifier for the notification request that generated the notification.</span></span> <span data-ttu-id="c5542-124">La fonction de **\_ résultat LDAP** est alors renvoyée avec les résultats de la recherche qui identifient l’objet modifié.</span><span class="sxs-lookup"><span data-stu-id="c5542-124">This causes the **ldap\_result** function to return with search results that identify the object that changed.</span></span>

<span data-ttu-id="c5542-125">L’application cliente doit déterminer l’état initial de l’objet surveillé.</span><span class="sxs-lookup"><span data-stu-id="c5542-125">The client application must determine the initial state of the object monitored.</span></span> <span data-ttu-id="c5542-126">Pour ce faire, vous devez d’abord inscrire la demande de notification, puis lire l’état actuel.</span><span class="sxs-lookup"><span data-stu-id="c5542-126">To do this, you must first register the notification request and then read the current state.</span></span>

<span data-ttu-id="c5542-127">L’application cliente doit également déterminer la cause de la modification.</span><span class="sxs-lookup"><span data-stu-id="c5542-127">The client application must also determine the cause of the change.</span></span> <span data-ttu-id="c5542-128">Pour une recherche au niveau de base, une notification se produit lorsqu’un attribut change ou lorsque l’objet est supprimé ou déplacé.</span><span class="sxs-lookup"><span data-stu-id="c5542-128">For a base level search, a notification occurs when any attribute changes, or when the object is deleted or moved.</span></span> <span data-ttu-id="c5542-129">Pour une recherche à un niveau, une notification se produit lorsqu’un objet enfant est créé, supprimé, déplacé ou modifié.</span><span class="sxs-lookup"><span data-stu-id="c5542-129">For a one-level search, a notification occurs when a child object is created, deleted, moved, or modified.</span></span> <span data-ttu-id="c5542-130">Sachez que le déplacement ou le changement de nom d’un objet dans la hiérarchie au-dessus d’un objet cible ne génère pas de notification, même si le nom unique de la cible a été modifié en conséquence.</span><span class="sxs-lookup"><span data-stu-id="c5542-130">Be aware that moving or renaming an object in the hierarchy above a target object does not generate a notification even though the distinguished name of the target changed as a result.</span></span> <span data-ttu-id="c5542-131">Par exemple, si vous surveillez les modifications apportées aux objets enfants d’un conteneur, vous ne recevrez pas de notifications si le conteneur lui-même est déplacé ou renommé.</span><span class="sxs-lookup"><span data-stu-id="c5542-131">For example, if monitoring changes to the child objects in a container, you will not receive notifications if the container itself is moved or renamed.</span></span>

<span data-ttu-id="c5542-132">Lorsque le client traite les résultats de la recherche, il peut utiliser \_ la \_ fonction LDAP obtenir DN pour obtenir le nom unique de l’objet qui a changé.</span><span class="sxs-lookup"><span data-stu-id="c5542-132">When the client processes the search results, it can use the ldap\_get\_dn function to get the distinguished name of the object that changed.</span></span> <span data-ttu-id="c5542-133">Ne vous fiez pas à des noms uniques pour identifier les objets suivis, car les noms uniques peuvent changer.</span><span class="sxs-lookup"><span data-stu-id="c5542-133">Do not rely on distinguished names to identify the objects tracked, because distinguished names can change.</span></span> <span data-ttu-id="c5542-134">Au lieu de cela, incluez l’attribut **objectGUID** dans la liste d’attributs à récupérer.</span><span class="sxs-lookup"><span data-stu-id="c5542-134">Instead, include the **objectGUID** attribute in the list of attributes to retrieve.</span></span> <span data-ttu-id="c5542-135">L' **objectGUID** de chaque objet reste inchangé, quel que soit l’emplacement où l’objet est déplacé dans la forêt d’entreprise.</span><span class="sxs-lookup"><span data-stu-id="c5542-135">Each object's **objectGUID** remains unchanged regardless of where the object is moved within the enterprise forest.</span></span>

<span data-ttu-id="c5542-136">Si un objet dans l’étendue de recherche est supprimé, le client reçoit une notification de modification et l’attribut **IsDeleted** de l’objet a la valeur **true**.</span><span class="sxs-lookup"><span data-stu-id="c5542-136">If an object within the search scope is deleted, the client receives a change notification and the **isDeleted** attribute of the object is set to **TRUE**.</span></span> <span data-ttu-id="c5542-137">Dans ce cas, les résultats de la recherche signalent le nouveau nom unique de l’objet dans le conteneur objets supprimés de sa partition.</span><span class="sxs-lookup"><span data-stu-id="c5542-137">In this case, the search results report the new distinguished name of the object in the Deleted Objects container of its partition.</span></span> <span data-ttu-id="c5542-138">Il n’est pas nécessaire de spécifier le contrôle tombstone ([le \_ serveur LDAP \_ affiche l' \_ \_ OID supprimé](/previous-versions/windows/desktop/ldap/ldap-server-show-deleted-oid)) pour recevoir des notifications de suppressions d’objets.</span><span class="sxs-lookup"><span data-stu-id="c5542-138">It is not necessary to specify the tombstone control ([LDAP\_SERVER\_SHOW\_DELETED\_OID](/previous-versions/windows/desktop/ldap/ldap-server-show-deleted-oid)) to get notifications of object deletions.</span></span> <span data-ttu-id="c5542-139">Pour plus d’informations, consultez [récupération des objets supprimés](retrieving-deleted-objects.md).</span><span class="sxs-lookup"><span data-stu-id="c5542-139">For more information, see [Retrieving Deleted Objects](retrieving-deleted-objects.md).</span></span>

<span data-ttu-id="c5542-140">Lorsqu’un client a inscrit une demande de notification, le client continue à recevoir des notifications jusqu’à ce que la connexion soit interrompue ou que le client abandonne la recherche en appelant la \_ fonction LDAP abandon.</span><span class="sxs-lookup"><span data-stu-id="c5542-140">When a client has registered a notification request, the client continues to receive notifications until the connection is broken or the client abandons the search by calling the ldap\_abandon function.</span></span> <span data-ttu-id="c5542-141">Si le client ou le serveur se déconnecte, par exemple, en cas de défaillance du serveur, la demande de notification est arrêtée.</span><span class="sxs-lookup"><span data-stu-id="c5542-141">If the client or server disconnects, for example, if the server fails, the notification request is terminated.</span></span> <span data-ttu-id="c5542-142">Lorsque le client se reconnecte, il doit s’inscrire à nouveau aux notifications, puis lire l’état actuel des objets qui vous intéressent en cas de modifications pendant la déconnexion du client.</span><span class="sxs-lookup"><span data-stu-id="c5542-142">When the client reconnects, it must register for notifications again, and then read the current state of the objects of interest in case there were changes while the client was disconnected.</span></span>

<span data-ttu-id="c5542-143">Le client peut utiliser la valeur de l’attribut **uSNChanged** d’un objet pour déterminer si l’état actuel de l’objet sur le serveur reflète les dernières modifications que le client a reçues.</span><span class="sxs-lookup"><span data-stu-id="c5542-143">The client can use the value of an object's **uSNChanged** attribute to determine whether the current state of the object on the server reflects the latest changes that the client has received.</span></span> <span data-ttu-id="c5542-144">Le système augmente l’attribut **uSNChanged** d’un objet lorsque l’objet est déplacé ou modifié.</span><span class="sxs-lookup"><span data-stu-id="c5542-144">The system increases an object's **uSNChanged** attribute when the object is moved or modified.</span></span> <span data-ttu-id="c5542-145">Par exemple, si le serveur échoue et que la partition d’annuaire est restaurée à partir d’une sauvegarde, le réplica du serveur d’un objet peut ne pas refléter les modifications précédemment signalées au client, auquel cas la valeur **uSNChanged** sur le serveur sera inférieure à la valeur stockée par le client.</span><span class="sxs-lookup"><span data-stu-id="c5542-145">For example, if the server fails and the directory partition is restored from a backup, the server's replica of an object may not reflect changes previously reported to the client, in which case the **uSNChanged** value on the server will be lower than the value stored by the client.</span></span>

<span data-ttu-id="c5542-146">Pour plus d’informations et pour obtenir un exemple de code qui utilise le contrôle de notification de modification LDAP dans une opération de recherche LDAP asynchrone, consultez l' [exemple de code pour recevoir des notifications de modification](example-code-for-receiving-change-notifications.md).</span><span class="sxs-lookup"><span data-stu-id="c5542-146">For more information and a code example that uses the LDAP change notification control in an asynchronous LDAP search operation, see [Example Code for Receiving Change Notifications](example-code-for-receiving-change-notifications.md).</span></span>

<span data-ttu-id="c5542-147">Pour plus d’informations sur l’utilisation du contrôle de notification de modification LDAP, consultez [vue d’ensemble des techniques de change Tracking](overview-of-change-tracking-techniques.md).</span><span class="sxs-lookup"><span data-stu-id="c5542-147">For more information about when to use the LDAP change notification control, see [Overview of Change Tracking Techniques](overview-of-change-tracking-techniques.md).</span></span>

 

