---
title: Utilisation de netsh pour gérer les traces
description: Dans Windows 7, netsh.exe peut être utilisé à partir d’une invite de commandes pour activer et configurer des suivis réseau. Cette section décrit quelques-unes des commandes netsh.exe qui peuvent vous aider à résoudre les problèmes de suivi, y compris la nouvelle fonctionnalité de suivi de netsh.
ms.assetid: f0f0fc7b-7cfa-43c7-89a3-3b80050875f8
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0c1cf869f60b69e227e78e19e8e05d3765ddb67d
ms.sourcegitcommit: b32433cc0394159c7263809ae67615ab5792d40d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/30/2021
ms.locfileid: "113119024"
---
# <a name="using-netsh-to-manage-traces"></a><span data-ttu-id="fd8bf-104">Utilisation de netsh pour gérer les traces</span><span class="sxs-lookup"><span data-stu-id="fd8bf-104">Using Netsh to Manage Traces</span></span>

<span data-ttu-id="fd8bf-105">Dans Windows 7, netsh.exe peut être utilisé à partir d’une invite de commandes pour activer et configurer des suivis réseau.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-105">In Windows 7, netsh.exe can be used from a command prompt to enable and configure network traces.</span></span> <span data-ttu-id="fd8bf-106">Cette section décrit quelques-unes des commandes netsh.exe qui peuvent vous aider à résoudre les problèmes de suivi, y compris la nouvelle fonctionnalité de **suivi de netsh** .</span><span class="sxs-lookup"><span data-stu-id="fd8bf-106">This section describes some of the netsh.exe commands which can help in troubleshooting tracing issues, including the new **netsh trace** functionality.</span></span> <span data-ttu-id="fd8bf-107">Notez que les commandes netsh doivent être exécutées à partir d’une invite de commandes avec élévation de privilèges.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-107">Note that the netsh commands must be run from an elevated command prompt.</span></span>

## <a name="collecting-traces"></a><span data-ttu-id="fd8bf-108">Collecte des traces</span><span class="sxs-lookup"><span data-stu-id="fd8bf-108">Collecting traces</span></span>

<span data-ttu-id="fd8bf-109">Les scénarios sont des ensembles prédéfinis de fournisseurs de suivi qui peuvent être activés pour la résolution des problèmes.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-109">Scenarios are predefined sets of trace providers which can be enabled for troubleshooting.</span></span> <span data-ttu-id="fd8bf-110">Pour afficher la liste des scénarios liés au réseau disponibles, tapez **netsh trace Show Scenarios** (**netsh trace Show Providers** répertorie chacun des fournisseurs disponibles, y compris ceux qui ne sont pas pertinents pour la mise en réseau).</span><span class="sxs-lookup"><span data-stu-id="fd8bf-110">To display the list of available network-related scenarios, type **netsh trace show scenarios** (**netsh trace show providers** lists every one of the available providers, including ones that are not relevant to networking).</span></span>

<span data-ttu-id="fd8bf-111">Une fois que vous avez identifié un scénario adapté à vos problèmes, vous pouvez voir une liste de tous les fournisseurs inclus dans ce scénario.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-111">When you have identified a scenario that looks relevant to your issues, you can see a list of all of the providers included in that scenario.</span></span> <span data-ttu-id="fd8bf-112">Par exemple, pour afficher tous les fournisseurs activés dans le cadre du scénario InternetClient, tapez **netsh trace Show scénario internetclient**.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-112">For example, to see all of the providers enabled under the InternetClient scenario, type **netsh trace show scenario internetclient**.</span></span>

<span data-ttu-id="fd8bf-113">Vous pouvez démarrer une trace pour tous les fournisseurs dans un scénario ou un ensemble de scénarios donné.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-113">You can start a trace for all of the providers in a given scenario or set of scenarios.</span></span> <span data-ttu-id="fd8bf-114">Par exemple, pour démarrer une trace pour tous les fournisseurs activés dans le cadre du scénario InternetClient, tapez **netsh trace Start Scenario = internetclient**.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-114">For example, to start a trace for all of the providers enabled under the InternetClient scenario, type **netsh trace start scenario=internetclient**.</span></span> <span data-ttu-id="fd8bf-115">Pour capturer des fournisseurs pour plusieurs scénarios, vous pouvez spécifier tous les scénarios appropriés, tels que **netsh trace Start scénario = filesharing Scenario = DirectAccess**.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-115">To capture providers for more than one scenario, you can specify all of the appropriate scenarios, such as **netsh trace start scenario=FileSharing scenario=DirectAccess**.</span></span> <span data-ttu-id="fd8bf-116">Notez qu’une seule session de suivi peut être activée à la fois ; Il n’est pas possible de capturer simultanément des informations de trace à partir de différents ensembles de fournisseurs dans des fichiers distincts.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-116">Note that only one tracing session may be enabled at a time; it is not possible to simultaneously capture trace information from different sets of providers in separate files.</span></span>

<span data-ttu-id="fd8bf-117">Vous pouvez également démarrer une trace pour des fournisseurs supplémentaires non inclus dans ce scénario particulier.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-117">You can also start a trace for additional providers not included in that particular scenario.</span></span> <span data-ttu-id="fd8bf-118">Par exemple, vous souhaiterez peut-être démarrer les traces pour tous les fournisseurs activés dans le cadre du scénario de réseau local sans fil et également le fournisseur DHCP.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-118">For example, you might want to start traces for all of the providers enabled under the WLAN scenario and also the DHCP provider.</span></span> <span data-ttu-id="fd8bf-119">Pour ce faire, tapez **netsh trace Start scénario = WLAN Provider = Microsoft-Windows-DHCP-client**.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-119">To do this, type **netsh trace start scenario=wlan provider=Microsoft-Windows-Dhcp-Client**.</span></span>

<span data-ttu-id="fd8bf-120">Vous pouvez également afficher plus de détails sur un fournisseur spécifique en tapant **netsh trace Show Provider** suivi du nom du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-120">You can also see more details about a specific provider by typing **netsh trace show provider** followed by the provider name.</span></span>

<span data-ttu-id="fd8bf-121">Pour afficher toutes les options et tous les filtres disponibles, vous pouvez taper **netsh trace Start/ ?**.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-121">To see all of the options and filters available you can type **netsh trace start /?**.</span></span>

<span data-ttu-id="fd8bf-122">Pour arrêter le suivi, tapez **netsh trace stop**.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-122">To stop tracing, type **netsh trace stop**.</span></span>

## <a name="using-the-output-files"></a><span data-ttu-id="fd8bf-123">Utilisation des fichiers de sortie</span><span class="sxs-lookup"><span data-stu-id="fd8bf-123">Using the output files</span></span>

<span data-ttu-id="fd8bf-124">Lorsque le suivi est arrêté, deux fichiers sont générés par défaut : un fichier journal de suivi d’événements (ETL) et un fichier .cab.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-124">When tracing is stopped, two files are generated by default: an Event Trace Log (ETL) file and a .cab file.</span></span>

<span data-ttu-id="fd8bf-125">Les événements de trace sont collectés dans le fichier ETL, qui peut être affiché à l’aide d’outils tels que Moniteur réseau.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-125">Trace events are collected in the ETL file, which can be viewed using tools such as Network Monitor.</span></span> <span data-ttu-id="fd8bf-126">Le fichier ETL est nommé NetTrace. etl par défaut, ou vous pouvez spécifier un autre nom en incluant **tracefile = nom_fichier. etl** lors du démarrage de la trace.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-126">The ETL file will be named nettrace.etl by default, or you can specify a different name by including **tracefile=filename.etl** when starting the trace.</span></span>

<span data-ttu-id="fd8bf-127">Le fichier .cab contient des informations détaillées sur les logiciels et le matériel du système, tels que les informations de l’adaptateur, la génération, le système d’exploitation et les paramètres sans fil.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-127">The .cab file contains rich information about the software and hardware on the system such as the adapter information, build, operating system, and wireless settings.</span></span> <span data-ttu-id="fd8bf-128">Le fichier .cab est nommé nettrace.cab par défaut, sauf si un autre nom a été spécifié comme indiqué ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-128">The .cab file will be named nettrace.cab by default, unless another name was specified as indicated above.</span></span>

<span data-ttu-id="fd8bf-129">Ce fichier de .cab contient deux fichiers, qui portent toujours le même nom.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-129">This .cab file will contain two files, which will always have the same name.</span></span> <span data-ttu-id="fd8bf-130">Report. etl est une autre copie des mêmes informations que celles incluses dans NetTrace. etl.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-130">Report.etl is another copy of the same information included in nettrace.etl.</span></span> <span data-ttu-id="fd8bf-131">Le fichier report.html contient des informations supplémentaires sur les événements de trace et les autres informations collectées.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-131">The report.html file includes additional information about the trace events and the other information collected.</span></span> <span data-ttu-id="fd8bf-132">Pour recevoir le plus de détails disponibles, incluez la commande **Report = Oui** lors du démarrage d’une trace.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-132">To receive the most details available, include the command **report = yes** when starting a trace.</span></span>

## <a name="using-filters-to-reduce-the-amount-of-data-in-the-etl-trace-file"></a><span data-ttu-id="fd8bf-133">Utilisation de filtres pour réduire la quantité de données dans le fichier de trace ETL</span><span class="sxs-lookup"><span data-stu-id="fd8bf-133">Using filters to reduce the amount of data in the ETL trace file</span></span>

<span data-ttu-id="fd8bf-134">Lorsque les captures se produisent sur une longue période de temps, le fichier de trace ETL peut devenir très volumineux.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-134">When captures happen over a long period of time, the ETL trace file can become very large.</span></span> <span data-ttu-id="fd8bf-135">Dans les scénarios où plusieurs fournisseurs sont activés, ce qui entraîne un trafic élevé, les contraintes de mémoire tampon ETW peuvent entraîner la suppression de certaines traces.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-135">In scenarios where multiple providers are enabled, resulting in high traffic, ETW buffer constraints may cause some traces to be dropped.</span></span> <span data-ttu-id="fd8bf-136">Hormis cette considération, la réduction de la quantité de données dans le fichier de trace ETL peut faciliter la résolution des problèmes en réduisant la quantité de données à examiner.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-136">Aside from this consideration, reducing the amount of data in the ETL trace file can help make troubleshooting easier by reducing the amount of data to review.</span></span>

<span data-ttu-id="fd8bf-137">Les filtres de trace netsh peuvent être utilisés pour réduire la taille du fichier de trace ETL.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-137">Netsh trace filters can be used to reduce the ETL trace file size.</span></span> <span data-ttu-id="fd8bf-138">Ces filtres de trace sont des niveaux et des mots clés ETW qui peuvent être appliqués à des fournisseurs individuels.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-138">These trace filters are ETW levels and keywords that can be applied to individual providers.</span></span>

<span data-ttu-id="fd8bf-139">Pour afficher la liste des filtres qui peuvent être appliqués, tapez **netsh trace Start/ ?**</span><span class="sxs-lookup"><span data-stu-id="fd8bf-139">To see a list of filters which can be applied, type **netsh trace start /?**</span></span>

<span data-ttu-id="fd8bf-140">Voici un exemple de filtre : **netsh trace Start internetclient fournisseur = Microsoft-Windows-tcpip Level = 5 Keywords = UT : ReceivePath, UT : SendPath**.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-140">An example of a filter is **netsh trace start InternetClient provider=Microsoft-Windows-TCPIP level=5 keywords=ut:ReceivePath,ut:SendPath**.</span></span>

<span data-ttu-id="fd8bf-141">Dans cet exemple, le niveau est défini sur 5, ce qui signifie que le nombre maximal d’événements est affiché.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-141">In this example, the level is set to 5, which means that the maximum number of events will be shown.</span></span> <span data-ttu-id="fd8bf-142">Le tableau suivant présente les paramètres disponibles :</span><span class="sxs-lookup"><span data-stu-id="fd8bf-142">The following table shows the settings available:</span></span>



| <span data-ttu-id="fd8bf-143">Level</span><span class="sxs-lookup"><span data-stu-id="fd8bf-143">Level</span></span>      | <span data-ttu-id="fd8bf-144">Paramètre</span><span class="sxs-lookup"><span data-stu-id="fd8bf-144">Setting</span></span>              | <span data-ttu-id="fd8bf-145">Description</span><span class="sxs-lookup"><span data-stu-id="fd8bf-145">Description</span></span>                                                                           |
|-------|---------------|----------------------------------------------------------------------------|
| <span data-ttu-id="fd8bf-146">1</span><span class="sxs-lookup"><span data-stu-id="fd8bf-146">1</span></span>     | <span data-ttu-id="fd8bf-147">Critique</span><span class="sxs-lookup"><span data-stu-id="fd8bf-147">Critical</span></span>      | <span data-ttu-id="fd8bf-148">Seuls les événements critiques seront affichés.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-148">Only critical events will be shown.</span></span>                                        |
| <span data-ttu-id="fd8bf-149">2</span><span class="sxs-lookup"><span data-stu-id="fd8bf-149">2</span></span>     | <span data-ttu-id="fd8bf-150">Erreurs</span><span class="sxs-lookup"><span data-stu-id="fd8bf-150">Errors</span></span>        | <span data-ttu-id="fd8bf-151">Les événements critiques et les erreurs s’affichent.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-151">Critical events and errors will be shown.</span></span>                                  |
| <span data-ttu-id="fd8bf-152">3</span><span class="sxs-lookup"><span data-stu-id="fd8bf-152">3</span></span>     | <span data-ttu-id="fd8bf-153">Avertissements</span><span class="sxs-lookup"><span data-stu-id="fd8bf-153">Warnings</span></span>      | <span data-ttu-id="fd8bf-154">Les événements critiques, les erreurs et les avertissements s’affichent.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-154">Critical events, errors, and warnings will be shown.</span></span>                       |
| <span data-ttu-id="fd8bf-155">4</span><span class="sxs-lookup"><span data-stu-id="fd8bf-155">4</span></span>     | <span data-ttu-id="fd8bf-156">Informationnel</span><span class="sxs-lookup"><span data-stu-id="fd8bf-156">Informational</span></span> | <span data-ttu-id="fd8bf-157">Les événements critiques, les erreurs, les avertissements et les événements d’information s’affichent.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-157">Critical events, errors, warnings, and informational events will be shown.</span></span> |
| <span data-ttu-id="fd8bf-158">5</span><span class="sxs-lookup"><span data-stu-id="fd8bf-158">5</span></span>     | <span data-ttu-id="fd8bf-159">Commentaires</span><span class="sxs-lookup"><span data-stu-id="fd8bf-159">Verbose</span></span>       | <span data-ttu-id="fd8bf-160">Tous les événements s’affichent.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-160">All events will be shown.</span></span>                                                  |



 

<span data-ttu-id="fd8bf-161">Les mots clés **UT : ReceivePath** et **UT : SentPath** filtrent les événements pour afficher uniquement les événements suivis dans le chemin d’envoi ou de réception.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-161">The keywords **ut:ReceivePath** and **ut:SentPath** filters the events to show only those events traced on the receive or send path.</span></span> <span data-ttu-id="fd8bf-162">Vous trouverez une liste complète des mots clés pour un fournisseur spécifique en tapant **netsh trace Show Provider** suivi du nom du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-162">A complete list of keywords for a specific provider can be found by typing **netsh trace show provider** followed by the provider name.</span></span> <span data-ttu-id="fd8bf-163">Par exemple, si vous tapez **netsh trace Show Provider Microsoft-Windows-tcpip** , vous affichez des informations sur le fournisseur Microsoft-Windows-tcpip, y compris une liste de mots clés.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-163">For example, typing **netsh trace show provider Microsoft-Windows-TCPIP** will display information about the Microsoft-Windows-TCPIP provider, including a list of keywords.</span></span>

<span data-ttu-id="fd8bf-164">Netsh prend également en charge la fonctionnalité de filtrage de paquets (semblable à Moniteur réseau) lorsque la capture de paquets est activée (en définissant **capture = Oui**).</span><span class="sxs-lookup"><span data-stu-id="fd8bf-164">Netsh also supports packet filtering capability (similar to Network Monitor) when packet capturing is turned on (by setting **capture = yes**).</span></span> <span data-ttu-id="fd8bf-165">Le filtrage de paquets peut être utilisé pour capturer un nombre limité de paquets dans un fichier de trace.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-165">Packet filtering can be used to capture a limited number of packets in a trace file.</span></span> <span data-ttu-id="fd8bf-166">Par exemple, **netsh trace Start capture = Oui IPv4. Address = = x.x.x.** x, où x.x. x est l’adresse IP, ne capture que les paquets avec le trafic IPv4 avec cette adresse source ou de destination spécifique...</span><span class="sxs-lookup"><span data-stu-id="fd8bf-166">For example, **netsh trace start capture = yes ipv4.address == x.x.x.x** , where x.x.x.x is the IP address, will only capture packets with ipv4 traffic with that specific source or destination address.</span></span>

<span data-ttu-id="fd8bf-167">Pour plus d’informations sur l’utilisation du filtrage de paquets, vous pouvez taper **netsh trace Show capturefilterHelp**.</span><span class="sxs-lookup"><span data-stu-id="fd8bf-167">For additional information about how to use packet filtering, you can type **netsh trace show capturefilterHelp**.</span></span>

 

 




