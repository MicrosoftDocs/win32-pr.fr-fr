---
title: Classe d’assistance extensible de plateforme de filtrage Windows
description: La plateforme de filtrage Windows (WFP) comprend une classe d’assistance de l’infrastructure de diagnostics du réseau (NDF), appelée classe d’assistance de la plateforme de filtrage (FPHC).
ms.assetid: 006ea30c-8682-4a3d-803a-73dba5162696
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 858835c1a649602293ed042c13205ca982de9258
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "103941071"
---
# <a name="windows-filtering-platform-extensible-helper-class"></a><span data-ttu-id="64204-103">Classe d’assistance extensible de plateforme de filtrage Windows</span><span class="sxs-lookup"><span data-stu-id="64204-103">Windows Filtering Platform Extensible Helper Class</span></span>

<span data-ttu-id="64204-104">La [plateforme de filtrage Windows (WFP)](/windows/desktop/FWP/windows-filtering-platform-start-page) comprend une classe d’assistance de l’infrastructure de diagnostics du réseau (NDF), appelée classe d’assistance de la plateforme de filtrage (fphc).</span><span class="sxs-lookup"><span data-stu-id="64204-104">The [Windows Filtering Platform (WFP)](/windows/desktop/FWP/windows-filtering-platform-start-page) includes a Network Diagnostics Framework (NDF) helper class, called the Filtering Platform helper class (FPHC).</span></span> <span data-ttu-id="64204-105">FPHC peut aider à identifier les causes racines des problèmes de connectivité provoqués par la plateforme WFP.</span><span class="sxs-lookup"><span data-stu-id="64204-105">FPHC can help identify the root causes of connectivity issues caused by WFP.</span></span> <span data-ttu-id="64204-106">Les développeurs de pare-feu tiers peuvent implémenter leurs propres classes d’assistance NDF.</span><span class="sxs-lookup"><span data-stu-id="64204-106">Third-party firewall developers can implement their own NDF helper classes.</span></span> <span data-ttu-id="64204-107">L’extensibilité FPHC permet d’appeler ces classes d’assistance tierces pendant les Diagnostics.</span><span class="sxs-lookup"><span data-stu-id="64204-107">FPHC extensibility allows these third-party helper classes to be invoked during diagnostics.</span></span>

<span data-ttu-id="64204-108">Cette rubrique suppose que vous connaissez l' [API WFP](/windows/desktop/FWP/windows-filtering-platform-start-page).</span><span class="sxs-lookup"><span data-stu-id="64204-108">This topic assumes familiarity with the [WFP API](/windows/desktop/FWP/windows-filtering-platform-start-page).</span></span>

## <a name="why-extend-the-fphc"></a><span data-ttu-id="64204-109">Pourquoi étendre le FPHC ?</span><span class="sxs-lookup"><span data-stu-id="64204-109">Why Extend the FPHC?</span></span>

<span data-ttu-id="64204-110">Tous les développeurs qui écrivent des applications qui appellent l’API WFP doivent écrire une classe d’assistance NDF qui étend FPHC.</span><span class="sxs-lookup"><span data-stu-id="64204-110">All developers that write applications that call the WFP API should write an NDF helper class that extends FPHC.</span></span>

<span data-ttu-id="64204-111">FPHC peut identifier la plateforme WFP comme étant la cause d’un problème de connectivité.</span><span class="sxs-lookup"><span data-stu-id="64204-111">FPHC can identify WFP as the cause of a connectivity issue.</span></span> <span data-ttu-id="64204-112">S’il est disponible, FPHC peut également identifier le fournisseur qui a créé le filtre qui bloque le trafic réseau.</span><span class="sxs-lookup"><span data-stu-id="64204-112">If available, FPHC can also identify the provider that created the filter that is blocking network traffic.</span></span> <span data-ttu-id="64204-113">FPHC transmet ces informations à NDF, qui à son tour peut informer l’utilisateur que WFP est à l’origine du problème de connectivité et lui attribuer le nom bloquant le trafic.</span><span class="sxs-lookup"><span data-stu-id="64204-113">FPHC passes this information to NDF, which in turn can then notify the user that WFP is causing the connectivity problem and give the name of the provider blocking traffic.</span></span>

<span data-ttu-id="64204-114">Toutefois, le FPHC ne peut pas suggérer une action corrective à l’utilisateur, ni fournir la raison pour laquelle le filtre bloque le trafic vers l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="64204-114">However, the FPHC cannot suggest a corrective action to the user, nor can it provide the reason that the filter is blocking traffic to the user.</span></span> <span data-ttu-id="64204-115">Seule une extension FPHC peut effectuer ces tâches.</span><span class="sxs-lookup"><span data-stu-id="64204-115">Only a FPHC extension can perform those tasks.</span></span>

<span data-ttu-id="64204-116">Prenons l’exemple d’une application de pare-feu tierce qui appelle l’API WFP.</span><span class="sxs-lookup"><span data-stu-id="64204-116">Consider a third-party firewall application that calls the WFP API.</span></span> <span data-ttu-id="64204-117">Si le pare-feu tiers implémente une extension FPHC, des actions personnalisées peuvent être implémentées pour gérer les problèmes de connectivité identifiés par NDF.</span><span class="sxs-lookup"><span data-stu-id="64204-117">If the third-party firewall implements a FPHC extension, then custom actions can be implemented to handle connectivity issues identified by NDF.</span></span> <span data-ttu-id="64204-118">Lorsque NDF diagnostique qu’une application a été bloquée par le pare-feu tiers, l’extension FPHC peut gérer l’événement bloquant.</span><span class="sxs-lookup"><span data-stu-id="64204-118">When NDF diagnoses that an application has been blocked by the third-party firewall, the FPHC extension can handle the blocking event.</span></span> <span data-ttu-id="64204-119">L’une des méthodes permettant à l’extension FPHC de gérer un événement est de présenter à l’utilisateur une invite pour débloquer un programme à l’aide du pare-feu, puis débloquer le programme à la confirmation de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="64204-119">One way that the FPHC extension could handle an event is to present the user with a prompt to unblock a program using the firewall and then unblock the program upon user confirmation.</span></span> <span data-ttu-id="64204-120">L’extension FPHC peut également gérer un événement en notifiant à l’utilisateur la raison pour laquelle l’application a été bloquée, telle qu’une application a été bloquée, car elle a été considérée comme un programme malveillant par le pare-feu.</span><span class="sxs-lookup"><span data-stu-id="64204-120">Alternatively, the FPHC extension could handle an event by notifying the user of the reason why the application was blocked, such as an application was blocked because it was considered malware by the firewall.</span></span>

## <a name="about-wfp-diagnostics"></a><span data-ttu-id="64204-121">À propos des diagnostics WFP</span><span class="sxs-lookup"><span data-stu-id="64204-121">About WFP Diagnostics</span></span>

<span data-ttu-id="64204-122">Quand NDF est appelé pour diagnostiquer un problème réseau, les classes d’assistance sont contactées pour déterminer la cause du problème.</span><span class="sxs-lookup"><span data-stu-id="64204-122">When NDF is invoked to diagnose a network issue, helper classes are contacted to determine the cause of the issue.</span></span> <span data-ttu-id="64204-123">Si une classe d’assistance de niveau supérieur détermine qu’une défaillance réseau peut être provoquée par WFP, elle génère une hypothèse pour FPHC en fonction des informations disponibles.</span><span class="sxs-lookup"><span data-stu-id="64204-123">If a higher-level helper class determines that a network failure may be caused by WFP, it generates a hypothesis for FPHC based on available information.</span></span> <span data-ttu-id="64204-124">NDF passe cette hypothèse, sous la forme de plusieurs attributs d’événement, à FPHC.</span><span class="sxs-lookup"><span data-stu-id="64204-124">NDF passes this hypothesis, in the form of several event attributes, to FPHC.</span></span> <span data-ttu-id="64204-125">Ces attributs sont décrits en détail dans la section [attributs d’événement fphc](#windows-filtering-platform-extensible-helper-class) ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="64204-125">These attributes are described in detail in the [FPHC Event Attributes](#windows-filtering-platform-extensible-helper-class) section below.</span></span>

<span data-ttu-id="64204-126">Un problème réseau peut être décrit comme un problème de connectivité affectant une tentative de connexion particulière.</span><span class="sxs-lookup"><span data-stu-id="64204-126">A network issue can be described as a connectivity problem affecting a particular connection attempt.</span></span> <span data-ttu-id="64204-127">Par exemple, l’utilisateur a peut-être bloqué accidentellement une application en cliquant par inadvertance sur **ne pas autoriser**.</span><span class="sxs-lookup"><span data-stu-id="64204-127">For example, the user may have accidentally blocked an application by inadvertently clicking **Don't allow**.</span></span> <span data-ttu-id="64204-128">Le pare-feu empêchera ensuite la liaison de l’application à n’importe quel port.</span><span class="sxs-lookup"><span data-stu-id="64204-128">The firewall will then block the application from binding to any port.</span></span> <span data-ttu-id="64204-129">L’utilisateur ne connaissant pas la raison pour laquelle l’application est bloquée peut tenter de diagnostiquer le problème via un point d’entrée proposé par l’application.</span><span class="sxs-lookup"><span data-stu-id="64204-129">The user, not knowing why the application is blocked, may try to diagnose the issue through an entry point offered by the application.</span></span> <span data-ttu-id="64204-130">FPHC examine les journaux et, s’il trouve une correspondance, il récupère l’ID de filtre et l’ID de fournisseur de ce filtre particulier.</span><span class="sxs-lookup"><span data-stu-id="64204-130">FPHC will look at the logs, and if it finds a match it will retrieve the filter ID and the provider ID of that particular filter.</span></span> <span data-ttu-id="64204-131">À ce stade, FPHC sait qui est le propriétaire du filtre, et il passe par le processus de diagnostic à la classe d’assistance appropriée pour un diagnostic plus approfondi.</span><span class="sxs-lookup"><span data-stu-id="64204-131">At this point, FPHC knows who the owner of that filter is, and it will hand over the diagnostic process to the appropriate helper class for further diagnosis.</span></span>

<span data-ttu-id="64204-132">L’événement le plus récent dans les journaux des événements WFP pour qu’il corresponde aux attributs est sélectionné comme étant pertinent pour le problème réseau.</span><span class="sxs-lookup"><span data-stu-id="64204-132">The most recent event in the WFP event logs to match the attributes is selected as being relevant to the network issue.</span></span> <span data-ttu-id="64204-133">Si aucun événement correspondant n’est trouvé et que l’heure à laquelle l’événement s’est produit est couverte dans le journal WFP, FPHC indique à NDF qu’il est sain.</span><span class="sxs-lookup"><span data-stu-id="64204-133">If no matching events are found and the time the event happened is covered in the WFP log, FPHC indicates to NDF that it is healthy.</span></span> <span data-ttu-id="64204-134">Si aucun événement correspondant n’est trouvé et que les journaux WFP n’incluent pas l’heure à laquelle l’événement s’est produit, FPHC renvoie un état indéterminé à NDF.</span><span class="sxs-lookup"><span data-stu-id="64204-134">If no matching events are found and the WFP logs do not include the time the event occurred, FPHC returns an indeterminate status to NDF.</span></span>

<span data-ttu-id="64204-135">Si un événement correspondant est trouvé, FPHC utilise l’ID du fournisseur du filtre qui a provoqué l’événement pour identifier le fournisseur de la règle de sécurité qui a bloqué la connectivité.</span><span class="sxs-lookup"><span data-stu-id="64204-135">If a matching event is found, FPHC uses the provider ID of the filter which caused the event to identify the provider of the security rule that blocked connectivity.</span></span> <span data-ttu-id="64204-136">FPHC vérifie ensuite s’il existe une extension de classe d’assistance pour ce fournisseur.</span><span class="sxs-lookup"><span data-stu-id="64204-136">FPHC then checks whether a helper class extension exists for that provider.</span></span> <span data-ttu-id="64204-137">Si une hypothèse est trouvée, FPHC génère une hypothèse pour ce fournisseur, puis l’objet NDF appelle l’extension.</span><span class="sxs-lookup"><span data-stu-id="64204-137">If one is found, FPHC generates a hypothesis for that provider and then NDF invokes the extension.</span></span> <span data-ttu-id="64204-138">L’extension doit retourner des informations de diagnostic et de réparation utiles à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="64204-138">The extension should return helpful diagnostic and repair information to the user.</span></span>

## <a name="helper-class-registration"></a><span data-ttu-id="64204-139">Inscription de la classe d’assistance</span><span class="sxs-lookup"><span data-stu-id="64204-139">Helper Class Registration</span></span>

<span data-ttu-id="64204-140">Une extension FPHC doit être inscrite comme décrit dans [inscription des extensions de classe d’assistance NDF](registering-ndf-helper-class-extensions.md).</span><span class="sxs-lookup"><span data-stu-id="64204-140">A FPHC extension must be registered as described in [Registering NDF Helper Class Extensions](registering-ndf-helper-class-extensions.md).</span></span> <span data-ttu-id="64204-141">Les développeurs qui implémentent une classe d’assistance doivent inscrire leurs extensions pour s’assurer que l’extension est appelée par NDF, le cas échéant.</span><span class="sxs-lookup"><span data-stu-id="64204-141">Developers implementing a helper class must register their extensions to ensure that the extension is called by NDF when appropriate.</span></span> <span data-ttu-id="64204-142">L' *attribut correspondant* décrit ci-dessous doit être stocké dans le Registre sous **HKLM \\ System \\ CurrentControlSet \\ Control \\ NetDiagFx** \\ *NomFournisseur* \\ **HostDLLs** \\ *Helper Class dll* \\ **HelperClasses** \\ *Helper Class Name* \\ **MatchAttributes**.</span><span class="sxs-lookup"><span data-stu-id="64204-142">The *matching attribute* described below must be stored in the registry under **HKLM\\System\\CurrentControlSet\\Control\\NetDiagFx**\\*VendorName*\\**HostDLLs**\\*Helper Class DLL*\\**HelperClasses**\\*Helper Class Name*\\**MatchAttributes**.</span></span>

<span data-ttu-id="64204-143">Le tableau suivant présente l’attribut correspondant utilisé pour identifier l’hypothèse à utiliser dans les diagnostics dans le journal des événements WFP.</span><span class="sxs-lookup"><span data-stu-id="64204-143">The following table shows the matching attribute used to identify the hypothesis to use in diagnostics in the WFP event log.</span></span> 

| <span data-ttu-id="64204-144">Nom</span><span class="sxs-lookup"><span data-stu-id="64204-144">Name</span></span>       | <span data-ttu-id="64204-145">Type</span><span class="sxs-lookup"><span data-stu-id="64204-145">Type</span></span>    | <span data-ttu-id="64204-146">Description</span><span class="sxs-lookup"><span data-stu-id="64204-146">Description</span></span>                                                                                                                                                                                                                                                                                                 |
|------------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="64204-147">ProviderID</span><span class="sxs-lookup"><span data-stu-id="64204-147">ProviderID</span></span> | <span data-ttu-id="64204-148">SZ de REG \_</span><span class="sxs-lookup"><span data-stu-id="64204-148">REG\_SZ</span></span> | <span data-ttu-id="64204-149">GUID de l’extension FPHC.</span><span class="sxs-lookup"><span data-stu-id="64204-149">The GUID of the FPHC extension.</span></span> <span data-ttu-id="64204-150">Cette valeur doit être identique à celle du GUID du fournisseur WFP.</span><span class="sxs-lookup"><span data-stu-id="64204-150">This value must be the same as the WFP Provider GUID.</span></span> <br/> <span data-ttu-id="64204-151">Cette chaîne respecte la casse.</span><span class="sxs-lookup"><span data-stu-id="64204-151">This string is case-sensitive.</span></span> <span data-ttu-id="64204-152">Elle doit être stockée dans le registre en majuscules avec des accolades et des traits d’Union.</span><span class="sxs-lookup"><span data-stu-id="64204-152">It should be stored in the registry in upper case with enclosing braces and hyphens.</span></span> <span data-ttu-id="64204-153">Par exemple, {C200E360-38C5-11CE-AE62-08002B2B79EF} est un ProviderID valide.</span><span class="sxs-lookup"><span data-stu-id="64204-153">For example, {C200E360-38C5-11CE-AE62-08002B2B79EF} is a valid ProviderID.</span></span><br/> |



 

<span data-ttu-id="64204-154">Lorsque le ProviderID d’un filtre bloquant correspond à celui d’une classe d’assistance inscrite, FPHC informe NDF d’appeler cette classe d’assistance, étendant ainsi la fonctionnalité de diagnostic de FPHC.</span><span class="sxs-lookup"><span data-stu-id="64204-154">When the ProviderID of a blocking filter matches that of a registered helper class, FPHC informs NDF to invoke that helper class, thus extending the diagnostic capability of FPHC.</span></span>

## <a name="fphc-event-attributes"></a><span data-ttu-id="64204-155">Attributs d’événement FPHC</span><span class="sxs-lookup"><span data-stu-id="64204-155">FPHC Event Attributes</span></span>

<span data-ttu-id="64204-156">Le tableau suivant répertorie les attributs d’événement associés à chaque événement correspondant.</span><span class="sxs-lookup"><span data-stu-id="64204-156">The following table lists the event attributes associated with each matching event.</span></span> <span data-ttu-id="64204-157">Chaque attribut d’événement est stocké dans une structure d' [**\_ attribut d’assistance**](/windows/win32/api/ndattrib/ns-ndattrib-helper_attribute) .</span><span class="sxs-lookup"><span data-stu-id="64204-157">Each event attribute is stored in a [**HELPER\_ATTRIBUTE**](/windows/win32/api/ndattrib/ns-ndattrib-helper_attribute) structure.</span></span> <span data-ttu-id="64204-158">Ces attributs sont passés par NDF à FPHC lorsqu’un événement correspondant est trouvé.</span><span class="sxs-lookup"><span data-stu-id="64204-158">These attributes are passed by NDF to FPHC when a matching event is found.</span></span> <span data-ttu-id="64204-159">Elles peuvent à leur tour être passées aux extensions FPHC.</span><span class="sxs-lookup"><span data-stu-id="64204-159">These can in turn be passed to FPHC extensions.</span></span>



| <span data-ttu-id="64204-160">Attribut</span><span class="sxs-lookup"><span data-stu-id="64204-160">Attribute</span></span>     | <span data-ttu-id="64204-161">[**Attribut \_**](/windows/win32/api/ndattrib/ne-ndattrib-attribute_type) Valeur de type</span><span class="sxs-lookup"><span data-stu-id="64204-161">[**ATTRIBUTE\_TYPE**](/windows/win32/api/ndattrib/ne-ndattrib-attribute_type) value</span></span> | <span data-ttu-id="64204-162">Description</span><span class="sxs-lookup"><span data-stu-id="64204-162">Description</span></span>                                                                                                                               |
|---------------|-------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="64204-163">GUID du fournisseur</span><span class="sxs-lookup"><span data-stu-id="64204-163">Provider GUID</span></span> | <span data-ttu-id="64204-164">AU \_ GUID</span><span class="sxs-lookup"><span data-stu-id="64204-164">AT\_GUID</span></span>                                        | <span data-ttu-id="64204-165">GUID du fournisseur associé au filtre.</span><span class="sxs-lookup"><span data-stu-id="64204-165">The GUID of the provider associated with the filter.</span></span>                                                                                      |
| <span data-ttu-id="64204-166">Timestamp</span><span class="sxs-lookup"><span data-stu-id="64204-166">Timestamp</span></span>     | <span data-ttu-id="64204-167">à \_ la \_ chaîne d’octets</span><span class="sxs-lookup"><span data-stu-id="64204-167">AT\_OCTET\_STRING</span></span>                               | <span data-ttu-id="64204-168">Mémoire tampon de type FILETIME qui spécifie l’heure à laquelle l’événement s’est produit.</span><span class="sxs-lookup"><span data-stu-id="64204-168">A buffer of type FILETIME that specifies the time at which the event occurred.</span></span> <span data-ttu-id="64204-169">Cet horodatage peut être utilisé pour identifier un événement de manière unique.</span><span class="sxs-lookup"><span data-stu-id="64204-169">This time stamp can be used to uniquely identify an event.</span></span> |
| <span data-ttu-id="64204-170">ipProtocol</span><span class="sxs-lookup"><span data-stu-id="64204-170">ipProtocol</span></span>    | <span data-ttu-id="64204-171">À \_ UInt32</span><span class="sxs-lookup"><span data-stu-id="64204-171">AT\_UINT32</span></span>                                      | <span data-ttu-id="64204-172">Protocole de couche de transport, au format UINT8.</span><span class="sxs-lookup"><span data-stu-id="64204-172">The transport layer protocol, in UINT8 format.</span></span>                                                                                            |
| <span data-ttu-id="64204-173">LocalAddr</span><span class="sxs-lookup"><span data-stu-id="64204-173">LocalAddr</span></span>     | <span data-ttu-id="64204-174">SUR \_ sockaddr</span><span class="sxs-lookup"><span data-stu-id="64204-174">AT\_SOCKADDR</span></span>                                    | <span data-ttu-id="64204-175">L’adresse IP et le port locaux, stockés dans une structure [**\_ sockaddr de diagnostic**](/windows/win32/api/ndattrib/ns-ndattrib-diag_sockaddr) .</span><span class="sxs-lookup"><span data-stu-id="64204-175">The local IP address and port, stored in a [**DIAG\_SOCKADDR**](/windows/win32/api/ndattrib/ns-ndattrib-diag_sockaddr) structure.</span></span>                                             |
| <span data-ttu-id="64204-176">RemoteAddr</span><span class="sxs-lookup"><span data-stu-id="64204-176">RemoteAddr</span></span>    | <span data-ttu-id="64204-177">SUR \_ sockaddr</span><span class="sxs-lookup"><span data-stu-id="64204-177">AT\_SOCKADDR</span></span>                                    | <span data-ttu-id="64204-178">L’adresse IP et le port distants, stockés dans une structure [**\_ sockaddr diag**](/windows/win32/api/ndattrib/ns-ndattrib-diag_sockaddr) .</span><span class="sxs-lookup"><span data-stu-id="64204-178">The remote IP address and port, stored in a [**DIAG\_SOCKADDR**](/windows/win32/api/ndattrib/ns-ndattrib-diag_sockaddr) structure.</span></span>                                            |
| <span data-ttu-id="64204-179">userId</span><span class="sxs-lookup"><span data-stu-id="64204-179">userId</span></span>        | <span data-ttu-id="64204-180">à \_ la \_ chaîne d’octets</span><span class="sxs-lookup"><span data-stu-id="64204-180">AT\_OCTET\_STRING</span></span>                               | <span data-ttu-id="64204-181">Mémoire tampon de type SID qui représente l’userid.</span><span class="sxs-lookup"><span data-stu-id="64204-181">A buffer of type SID that represents the userid.</span></span> <span data-ttu-id="64204-182">Si userId a une longueur de 0, le SID n’est pas disponible.</span><span class="sxs-lookup"><span data-stu-id="64204-182">If userId is of length 0, the SID is unavailable.</span></span>                                        |
| <span data-ttu-id="64204-183">appId</span><span class="sxs-lookup"><span data-stu-id="64204-183">appId</span></span>         | <span data-ttu-id="64204-184">au niveau de la \_ chaîne</span><span class="sxs-lookup"><span data-stu-id="64204-184">AT\_STRING</span></span>                                      | <span data-ttu-id="64204-185">Mémoire tampon qui stocke l’identificateur d’application récupéré.</span><span class="sxs-lookup"><span data-stu-id="64204-185">A buffer that stores the retrieved application identifier.</span></span> <span data-ttu-id="64204-186">Si appId a la valeur L "", l’identificateur d’application n’est pas disponible.</span><span class="sxs-lookup"><span data-stu-id="64204-186">If appId has a value of L"", the application identifier is unavailable.</span></span>        |



 

## <a name="handling-fphc-events"></a><span data-ttu-id="64204-187">Gestion des événements FPHC</span><span class="sxs-lookup"><span data-stu-id="64204-187">Handling FPHC Events</span></span>

<span data-ttu-id="64204-188">Avant de suggérer des informations de diagnostic et de réparation à l’utilisateur, une extension FPHC doit collecter plus de données que ce qui est fourni par les notifications FPHC.</span><span class="sxs-lookup"><span data-stu-id="64204-188">Before suggesting diagnostic and repair information to the user, a FPHC extension should gather more data than is provided by the FPHC notifications.</span></span> <span data-ttu-id="64204-189">Ces données peuvent être obtenues à partir des [fonctions de gestion des événements WFP](/windows/desktop/FWP/fwp-mgmt-functions).</span><span class="sxs-lookup"><span data-stu-id="64204-189">This data can be acquired from the [WFP Event Management Functions](/windows/desktop/FWP/fwp-mgmt-functions).</span></span> <span data-ttu-id="64204-190">Ces fonctions sont illustrées dans l’exemple [affichage des événements .net](/windows/desktop/FWP/displaying-net-events) .</span><span class="sxs-lookup"><span data-stu-id="64204-190">These functions are demonstrated in the [Displaying Net Events](/windows/desktop/FWP/displaying-net-events) sample.</span></span>

<span data-ttu-id="64204-191">Un exemple de gestion des événements plus détaillé est inclus dans le kit de développement logiciel (SDK).</span><span class="sxs-lookup"><span data-stu-id="64204-191">A more detailed event management sample is included in the SDK.</span></span> <span data-ttu-id="64204-192">Le code source de l’exemple se trouve dans l’emplacement d’installation du kit de développement logiciel (SDK) sous C : \\ Program Files \\ Microsoft SDK \\ Windows \\ <version number> \\ Samples \\ NetDs \\ WFP \\ DiagEvents.</span><span class="sxs-lookup"><span data-stu-id="64204-192">The source code for the sample can be found in the SDK installation location under C:\\Program Files\\Microsoft SDKs\\Windows\\<version number>\\Samples\\NetDs\\WFP\\DiagEvents.</span></span> <span data-ttu-id="64204-193">Le kit de développement logiciel (SDK) Windows Vista est disponible dans le [Centre de téléchargement](https://www.microsoft.com/downloads/details.aspx?FamilyID=f26b1aa4-741a-433a-9be5-fa919850bdbf).</span><span class="sxs-lookup"><span data-stu-id="64204-193">The Windows Vista SDK is available from the [Download Center](https://www.microsoft.com/downloads/details.aspx?FamilyID=f26b1aa4-741a-433a-9be5-fa919850bdbf).</span></span>

## <a name="built-in-fphc-diagnostics"></a><span data-ttu-id="64204-194">Diagnostics FPHC intégrés</span><span class="sxs-lookup"><span data-stu-id="64204-194">Built-in FPHC Diagnostics</span></span>

<span data-ttu-id="64204-195">En l’absence d’une extension FPHC, FPHC peut diagnostiquer les scénarios listés ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="64204-195">In the absence of an FPHC extension, FPHC can diagnose the scenarios listed below.</span></span> <span data-ttu-id="64204-196">La plupart des échecs de connectivité diagnostiqués par FPHC sont dus au fait que les pare-feu bloquent le trafic.</span><span class="sxs-lookup"><span data-stu-id="64204-196">Most connectivity failures diagnosed by FPHC occur because firewalls block traffic.</span></span> <span data-ttu-id="64204-197">Les scénarios IPsec sont moins courants.</span><span class="sxs-lookup"><span data-stu-id="64204-197">The IPsec scenarios are less common.</span></span>

<span data-ttu-id="64204-198">Le tableau suivant présente certains scénarios provoquant des échecs de connectivité qui peuvent être diagnostiqués par FPHC, ainsi que la description et les informations de réparation transmises à NDF.</span><span class="sxs-lookup"><span data-stu-id="64204-198">The following table shows some scenarios causing connectivity failures that can be diagnosed by FPHC, along with the description and repair information passed to NDF.</span></span>



| <span data-ttu-id="64204-199">Scénario</span><span class="sxs-lookup"><span data-stu-id="64204-199">Scenario</span></span>                   | <span data-ttu-id="64204-200">Description de l’intégrité faible</span><span class="sxs-lookup"><span data-stu-id="64204-200">Low health description</span></span>                                                                                                               | <span data-ttu-id="64204-201">Informations de réparation</span><span class="sxs-lookup"><span data-stu-id="64204-201">Repair information</span></span>                   |
|----------------------------|--------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------|
| <span data-ttu-id="64204-202">Suppression du pare-feu</span><span class="sxs-lookup"><span data-stu-id="64204-202">Firewall drop</span></span>              | <span data-ttu-id="64204-203">Les paramètres de pare-feu sur cet ordinateur bloquent la connexion.</span><span class="sxs-lookup"><span data-stu-id="64204-203">The firewall settings on this computer are blocking the connection.</span></span>                                                                  | <span data-ttu-id="64204-204">Vérifiez les paramètres de votre pare-feu.</span><span class="sxs-lookup"><span data-stu-id="64204-204">Verify your firewall settings.</span></span>       |
| <span data-ttu-id="64204-205">Échec du mode principal</span><span class="sxs-lookup"><span data-stu-id="64204-205">Main Mode Failure</span></span>          | <span data-ttu-id="64204-206">Vous ne pouvez pas vous connecter en raison d’une incompatibilité de stratégie de sécurité IPsec.</span><span class="sxs-lookup"><span data-stu-id="64204-206">You cannot connect because of an IPsec security policy mismatch.</span></span>                                                                     | <span data-ttu-id="64204-207">Contactez le propriétaire de la stratégie IPsec.</span><span class="sxs-lookup"><span data-stu-id="64204-207">Contact the IPsec policy owner.</span></span>      |
| <span data-ttu-id="64204-208">Échec du mode rapide</span><span class="sxs-lookup"><span data-stu-id="64204-208">Quick Mode Failure</span></span>         | <span data-ttu-id="64204-209">Vous ne pouvez pas vous connecter en raison d’une incompatibilité de stratégie de sécurité IPsec.</span><span class="sxs-lookup"><span data-stu-id="64204-209">You cannot connect because of an IPsec security policy mismatch.</span></span>                                                                     | <span data-ttu-id="64204-210">Contactez le propriétaire de la stratégie IPsec.</span><span class="sxs-lookup"><span data-stu-id="64204-210">Contact the IPsec policy owner.</span></span>      |
| <span data-ttu-id="64204-211">Échec du mode utilisateur</span><span class="sxs-lookup"><span data-stu-id="64204-211">User Mode Failure</span></span>          | <span data-ttu-id="64204-212">Vous ne pouvez pas vous connecter en raison d’une incompatibilité de stratégie de sécurité IPsec.</span><span class="sxs-lookup"><span data-stu-id="64204-212">You cannot connect because of an IPsec security policy mismatch.</span></span>                                                                     | <span data-ttu-id="64204-213">Contactez le propriétaire de la stratégie IPsec.</span><span class="sxs-lookup"><span data-stu-id="64204-213">Contact the IPsec policy owner.</span></span>      |
| <span data-ttu-id="64204-214">Échec des informations d’identification</span><span class="sxs-lookup"><span data-stu-id="64204-214">Credential Failure</span></span>         | <span data-ttu-id="64204-215">Vous ne pouvez pas vous connecter, car l’autorité de certification racine de cet ordinateur ne correspond pas à l’autorité de certification racine sur l’ordinateur distant.</span><span class="sxs-lookup"><span data-stu-id="64204-215">You cannot connect because the root certification authority (CA) on this computer does not match the root CA on the remote computer.</span></span> | <span data-ttu-id="64204-216">Mettez à jour le certificat racine approuvé.</span><span class="sxs-lookup"><span data-stu-id="64204-216">Update the trusted root certificate.</span></span> |
| <span data-ttu-id="64204-217">Certificat expiré</span><span class="sxs-lookup"><span data-stu-id="64204-217">Expired Certificate</span></span>        | <span data-ttu-id="64204-218">Le certificat utilisé pour l’authentification IPsec est arrivé à expiration.</span><span class="sxs-lookup"><span data-stu-id="64204-218">The certificate used for IPsec authentication has expired.</span></span>                                                                           | <span data-ttu-id="64204-219">Demander un certificat.</span><span class="sxs-lookup"><span data-stu-id="64204-219">Request a certificate.</span></span>               |
| <span data-ttu-id="64204-220">Autres échecs de certificat</span><span class="sxs-lookup"><span data-stu-id="64204-220">Other certificate failures</span></span> | <span data-ttu-id="64204-221">Aucun certificat valide n’a été trouvé pour l’authentification IPsec.</span><span class="sxs-lookup"><span data-stu-id="64204-221">A valid certificate was not found for IPsec authentication.</span></span>                                                                          | <span data-ttu-id="64204-222">Demander un certificat.</span><span class="sxs-lookup"><span data-stu-id="64204-222">Request a certificate.</span></span>               |
| <span data-ttu-id="64204-223">Échec de Kerberos</span><span class="sxs-lookup"><span data-stu-id="64204-223">Kerberos failure</span></span>           | <span data-ttu-id="64204-224">L’ordinateur ne fait pas partie de ce domaine.</span><span class="sxs-lookup"><span data-stu-id="64204-224">The computer is not part of this domain.</span></span>                                                                                             | <span data-ttu-id="64204-225">Joindre cet ordinateur à un domaine.</span><span class="sxs-lookup"><span data-stu-id="64204-225">Join this computer to a domain.</span></span>      |
| <span data-ttu-id="64204-226">Clé prépartagée</span><span class="sxs-lookup"><span data-stu-id="64204-226">Preshared Key</span></span>              | <span data-ttu-id="64204-227">Réinitialisez les clés prépartagées.</span><span class="sxs-lookup"><span data-stu-id="64204-227">Reset the preshared keys.</span></span>                                                                                                            | <span data-ttu-id="64204-228">Réinitialisez les clés prépartagées.</span><span class="sxs-lookup"><span data-stu-id="64204-228">Reset the preshared keys.</span></span>            |



 

## <a name="related-topics"></a><span data-ttu-id="64204-229">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="64204-229">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="64204-230">Plateforme de filtrage Windows</span><span class="sxs-lookup"><span data-stu-id="64204-230">Windows Filtering Platform</span></span>](/windows/desktop/FWP/windows-filtering-platform-start-page)
</dt> <dt>

[<span data-ttu-id="64204-231">Conception des extensions de classe d’assistance NDF</span><span class="sxs-lookup"><span data-stu-id="64204-231">Designing NDF Helper Class Extensions</span></span>](designing-ndf-helper-class-extensions.md)
</dt> <dt>

[<span data-ttu-id="64204-232">Inscription des extensions de classe d’assistance NDF</span><span class="sxs-lookup"><span data-stu-id="64204-232">Registering NDF Helper Class Extensions</span></span>](registering-ndf-helper-class-extensions.md)
</dt> <dt>

[<span data-ttu-id="64204-233">Exemples de classes d’assistance NDF</span><span class="sxs-lookup"><span data-stu-id="64204-233">NDF Helper Class Examples</span></span>](ndf-helper-class-examples.md)
</dt> </dl>

 

