---
title: Utilisation des fonctionnalités NDF
description: Microsoft fournit un accès à la fonctionnalité NDF par le biais d’une API publique. Lorsqu’un problème se produit, l’application peut utiliser cette API pour tirer parti de cette fonctionnalité dans le contexte d’une application spécifique.
ms.assetid: db06b9a9-a64a-43ff-9b77-95230208cfd6
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5ca74a8a80f7babca75182625ec71dc1ec47cbc7
ms.sourcegitcommit: c9c66a09eeb9e46311879a5181342e89964c1dd8
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/10/2020
ms.locfileid: "104381759"
---
# <a name="using-ndf-functionality"></a><span data-ttu-id="bf661-104">Utilisation des fonctionnalités NDF</span><span class="sxs-lookup"><span data-stu-id="bf661-104">Using NDF Functionality</span></span>

<span data-ttu-id="bf661-105">Microsoft fournit un accès à la fonctionnalité NDF par le biais d’une API publique.</span><span class="sxs-lookup"><span data-stu-id="bf661-105">Microsoft provides access to NDF functionality through a public API.</span></span> <span data-ttu-id="bf661-106">Lorsqu’un problème se produit, l’application peut utiliser cette API pour tirer parti de cette fonctionnalité dans le contexte d’une application spécifique.</span><span class="sxs-lookup"><span data-stu-id="bf661-106">When a problem occurs, the application can use this API to leverage this functionality within the context of a specific application.</span></span>

<span data-ttu-id="bf661-107">Il existe trois étapes de diagnostic avec NDF : création d’un incident, exécution du diagnostic et réparations et fermeture de l’incident.</span><span class="sxs-lookup"><span data-stu-id="bf661-107">There are three stages of performing diagnosis with NDF: creating an incident, running diagnosis and repairs, and closing the incident.</span></span> <span data-ttu-id="bf661-108">Cette vue d’ensemble indique les fonctions NDF qui peuvent être pertinentes pour un scénario spécifique.</span><span class="sxs-lookup"><span data-stu-id="bf661-108">This overview indicates which NDF functions may be relevant for a specific scenario.</span></span> <span data-ttu-id="bf661-109">Vous trouverez des informations détaillées sur chaque fonction dans la section [référence NDF](ndf-reference.md) .</span><span class="sxs-lookup"><span data-stu-id="bf661-109">Detailed information on each function can be found in the [NDF Reference](ndf-reference.md) section.</span></span>

## <a name="creating-an-incident"></a><span data-ttu-id="bf661-110">Création d’un incident</span><span class="sxs-lookup"><span data-stu-id="bf661-110">Creating an Incident</span></span>

<span data-ttu-id="bf661-111">Une session de diagnostics NDF requiert un incident spécifique pour le diagnostic.</span><span class="sxs-lookup"><span data-stu-id="bf661-111">An NDF diagnostics session requires a specific incident to diagnose.</span></span> <span data-ttu-id="bf661-112">Il existe plusieurs fonctions qui peuvent être utilisées pour créer un incident.</span><span class="sxs-lookup"><span data-stu-id="bf661-112">There are several functions which can be used to create an incident.</span></span> <span data-ttu-id="bf661-113">Choisissez la fonction qui correspond le mieux à ce que l’application essayait de faire lorsque la défaillance s’est produite.</span><span class="sxs-lookup"><span data-stu-id="bf661-113">Choose the function which most closely matches what the application was trying to do when the failure occurred.</span></span>

-   <span data-ttu-id="bf661-114">[**NdfCreateConnectivityIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreateconnectivityincident): problèmes généraux de connectivité Internet qui n’ont pas besoin d’informations supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="bf661-114">[**NdfCreateConnectivityIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreateconnectivityincident): General Internet connectivity problems which do not need additional information.</span></span>
-   <span data-ttu-id="bf661-115">[**NdfCreateWebIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatewebincident) / [**NdfCreateWebIncidentEx**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatewebincidentex): connexion à une URL HTTP ou HTTPS.</span><span class="sxs-lookup"><span data-stu-id="bf661-115">[**NdfCreateWebIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatewebincident)/[**NdfCreateWebIncidentEx**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatewebincidentex): Connecting to an HTTP or HTTPS URL.</span></span>
-   <span data-ttu-id="bf661-116">[**NdfCreateSharingIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatesharingincident): accès à un chemin d’accès UNC ou à un partage de fichiers.</span><span class="sxs-lookup"><span data-stu-id="bf661-116">[**NdfCreateSharingIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatesharingincident): Accessing a UNC path or file share.</span></span>
-   <span data-ttu-id="bf661-117">[**NdfCreateDNSIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatednsincident): résolution d’un nom d’hôte DNS.</span><span class="sxs-lookup"><span data-stu-id="bf661-117">[**NdfCreateDNSIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatednsincident): Resolving a DNS host name.</span></span>
-   <span data-ttu-id="bf661-118">[**NdfCreatePnrpIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatepnrpincident): résolution d’un nom d’homologue PNRP.</span><span class="sxs-lookup"><span data-stu-id="bf661-118">[**NdfCreatePnrpIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatepnrpincident): Resolving a PNRP peer name.</span></span>
-   <span data-ttu-id="bf661-119">[**NdfCreateGroupingIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreategroupingincident): jointure d’un groupe d’égal à égal.</span><span class="sxs-lookup"><span data-stu-id="bf661-119">[**NdfCreateGroupingIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreategroupingincident): Joining a peer-to-peer group.</span></span>
-   <span data-ttu-id="bf661-120">[**NdfCreateWinSockIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatewinsockincident): connexion à une destination à l’aide d’un socket (si aucune autre fonction ne s’applique spécifiquement).</span><span class="sxs-lookup"><span data-stu-id="bf661-120">[**NdfCreateWinSockIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatewinsockincident): Connecting to a destination by using a socket (when none of the other functions specifically apply).</span></span>
-   <span data-ttu-id="bf661-121">[**NdfCreateIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreateincident): utilisé quand aucun autre scénario n’est approprié et que la classe d’assistance NDF spécifique à appeler est connue (avec les arguments requis).</span><span class="sxs-lookup"><span data-stu-id="bf661-121">[**NdfCreateIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreateincident): Used when no other scenario is appropriate and the specific NDF helper class to be invoked is known (along with the arguments it requires).</span></span> <span data-ttu-id="bf661-122">Principalement utilisé à des fins de test par des développeurs d’applications qui ont écrit leur propre classe d’assistance.</span><span class="sxs-lookup"><span data-stu-id="bf661-122">Primarily used for testing purposes by application developers who have written their own helper class.</span></span>

## <a name="running-diagnosis-and-repairs"></a><span data-ttu-id="bf661-123">Exécution du diagnostic et des réparations</span><span class="sxs-lookup"><span data-stu-id="bf661-123">Running Diagnosis and Repairs</span></span>

<span data-ttu-id="bf661-124">Il existe deux façons de lancer la fonctionnalité de diagnostic et de réparation.</span><span class="sxs-lookup"><span data-stu-id="bf661-124">There are two ways to launch the diagnosis and repair functionality.</span></span>

-   <span data-ttu-id="bf661-125">Utilisation de l’interface utilisateur Windows (recommandé)</span><span class="sxs-lookup"><span data-stu-id="bf661-125">Using the Windows User Interface (Recommended)</span></span>

    <span data-ttu-id="bf661-126">Lors de l’exécution dans l’interface utilisateur Windows standard, vous pouvez simplement appeler la fonction [**NdfExecuteDiagnosis**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfexecutediagnosis) .</span><span class="sxs-lookup"><span data-stu-id="bf661-126">When running in the standard Windows user interface, you can simply call the [**NdfExecuteDiagnosis**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfexecutediagnosis) function.</span></span> <span data-ttu-id="bf661-127">L’Assistant NDF démarre et aide l’utilisateur à identifier (et, si possible, et à résoudre) le problème.</span><span class="sxs-lookup"><span data-stu-id="bf661-127">The NDF Wizard will launch and assist the user in identifying (and if possible, and resolving) the problem.</span></span> <span data-ttu-id="bf661-128">La fonction est retournée une fois ce processus terminé.</span><span class="sxs-lookup"><span data-stu-id="bf661-128">The function will return after this process has finished.</span></span> <span data-ttu-id="bf661-129">L’interface utilisateur est éventuellement modale pour votre application.</span><span class="sxs-lookup"><span data-stu-id="bf661-129">The user interface is optionally modal to your application.</span></span>

-   <span data-ttu-id="bf661-130">Utilisation d’une interface utilisateur personnalisée (Windows 7 et versions ultérieures uniquement)</span><span class="sxs-lookup"><span data-stu-id="bf661-130">Using a Custom User Interface (Windows 7 and later only)</span></span>

    <span data-ttu-id="bf661-131">Différentes fonctions peuvent être utilisées dans les scénarios où aucune interface utilisateur n’est affichée, ou lorsque l’expérience Windows standard n’est pas utilisée (par exemple, Media Center, applications incorporées et invite de commandes).</span><span class="sxs-lookup"><span data-stu-id="bf661-131">Different functions are available to use in scenarios where no user interface is being shown, or where the standard Windows experience is not being used (such as Media Center, embedded applications, and the command prompt).</span></span> <span data-ttu-id="bf661-132">Cette option ignore la fonctionnalité expérience utilisateur fournie dans l’Assistant NDF, qui comprend la limitation des résultats aux causes de la prise en charge intégrale, ainsi que des heuristiques pour présenter les réparations à l’utilisateur dans l’ordre recommandé.</span><span class="sxs-lookup"><span data-stu-id="bf661-132">This option bypasses the user experience functionality provided in the NDF Wizard, which includes limiting the results to fully-supported root causes, as well as heuristics to present repairs to the user in recommended order.</span></span> <span data-ttu-id="bf661-133">Lorsque vous utilisez ces fonctions, vous devez fournir vous-même ces fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="bf661-133">When using these functions, you must provide any such functionality yourself.</span></span> <span data-ttu-id="bf661-134">Vous devez également veiller à libérer de la mémoire utilisée par les résultats du diagnostic.</span><span class="sxs-lookup"><span data-stu-id="bf661-134">You must also make sure to free memory used by the diagnosis results.</span></span>

    <span data-ttu-id="bf661-135">Pour commencer le diagnostic, appelez la fonction [**NdfDiagnoseIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfdiagnoseincident) .</span><span class="sxs-lookup"><span data-stu-id="bf661-135">To begin diagnosis, call the [**NdfDiagnoseIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfdiagnoseincident) function.</span></span> <span data-ttu-id="bf661-136">Tous les problèmes détectés sont retournés à l’application sous la forme d’une collection de structures [**RootCauseInfo**](/windows/win32/api/ndattrib/ns-ndattrib-rootcauseinfo) décrivant les causes racines identifiées et les réparations possibles.</span><span class="sxs-lookup"><span data-stu-id="bf661-136">Any problems found will be returned to the application as a collection of [**RootCauseInfo**](/windows/win32/api/ndattrib/ns-ndattrib-rootcauseinfo) structures describing identified root causes and possible repairs.</span></span>

    <span data-ttu-id="bf661-137">Après avoir sélectionné une réparation (ou demandé à l’utilisateur de sélectionner une réparation), [**NdfRepairIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfrepairincident) doit être appelé pour tenter la réparation et déterminer si le problème a été résolu.</span><span class="sxs-lookup"><span data-stu-id="bf661-137">After selecting a repair (or asking the user to select a repair), [**NdfRepairIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfrepairincident) should be called to attempt the repair and determine whether the problem was resolved.</span></span>

    <span data-ttu-id="bf661-138">Dans certains cas, une réparation peut être effectuée avec succès, mais ne résout pas le problème.</span><span class="sxs-lookup"><span data-stu-id="bf661-138">In some cases, a repair may be successfully performed but will not resolve the problem.</span></span> <span data-ttu-id="bf661-139">Dans ce cas, il est recommandé de fermer l’incident existant et d’en ouvrir un nouveau.</span><span class="sxs-lookup"><span data-stu-id="bf661-139">In such cases, closing the existing incident and then opening a new one is recommended.</span></span> <span data-ttu-id="bf661-140">Cela permet de s’assurer que les nouveaux problèmes démasqués par la réparation initiale sont identifiés.</span><span class="sxs-lookup"><span data-stu-id="bf661-140">This will ensure that any new problems unmasked by the initial repair are identified.</span></span> <span data-ttu-id="bf661-141">Par exemple, supposez qu’aucun réseau sans fil n’avait été visible.</span><span class="sxs-lookup"><span data-stu-id="bf661-141">For example, suppose that no wireless networks had been visible.</span></span> <span data-ttu-id="bf661-142">Après la réinitialisation de l’adaptateur, les réseaux sans fil sont visibles, mais aucun d’eux n’est répertorié dans la liste par défaut.</span><span class="sxs-lookup"><span data-stu-id="bf661-142">After resetting the adapter, wireless networks are visible, but none of them are on the preferred list.</span></span> <span data-ttu-id="bf661-143">Il s’agit d’un nouveau problème qui nécessiterait un nouveau diagnostic pour identifier.</span><span class="sxs-lookup"><span data-stu-id="bf661-143">This is a new problem that would require a new diagnosis to identify.</span></span> <span data-ttu-id="bf661-144">Si une deuxième tentative de diagnostic n’identifie pas de problèmes supplémentaires, une réparation différente peut être tentée pour résoudre le problème d’origine, ou l’utilisateur peut être informé que le problème n’a pas pu être résolu.</span><span class="sxs-lookup"><span data-stu-id="bf661-144">If such a second diagnosis attempt does not identify additional problems, a different repair can be attempted to resolve the original issue, or the user can be informed that the problem could not be resolved.</span></span>

    <span data-ttu-id="bf661-145">[**NdfDiagnoseIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfdiagnoseincident) et [**NdfRepairIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfrepairincident) sont des API synchrones.</span><span class="sxs-lookup"><span data-stu-id="bf661-145">[**NdfDiagnoseIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfdiagnoseincident) and [**NdfRepairIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfrepairincident) are synchronous APIs.</span></span> <span data-ttu-id="bf661-146">Si vous souhaitez annuler l’activité initiée par ces fonctions, appelez [**NdfCancelIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcancelincident) à partir d’un autre thread.</span><span class="sxs-lookup"><span data-stu-id="bf661-146">If you wish to cancel activity initiated by these functions, call [**NdfCancelIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcancelincident) from another thread.</span></span> <span data-ttu-id="bf661-147">La fonction retourne au point d’arrêt disponible suivant dans le processus de diagnostic ou de réparation.</span><span class="sxs-lookup"><span data-stu-id="bf661-147">The function will return at the next available stopping point in the diagnosis or repair process.</span></span>

    <span data-ttu-id="bf661-148">À tout moment, vous pouvez éventuellement appeler [**NdfGetTraceFile**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfgettracefile) pour récupérer une copie du journal NDF pour la session de diagnostic en cours et l’inclure dans les journaux de vos applications.</span><span class="sxs-lookup"><span data-stu-id="bf661-148">At any point, you may optionally call [**NdfGetTraceFile**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfgettracefile) to retrieve a copy of the NDF log for the current diagnosis session and include it with your application logs.</span></span> <span data-ttu-id="bf661-149">Le journal est vidé une fois récupéré, et les appels suivants récupèrent uniquement les événements qui se sont produits après le dernier appel à cette fonction.</span><span class="sxs-lookup"><span data-stu-id="bf661-149">The log is flushed once retrieved, and subsequent calls will only retrieve events which occurred after the last call to this function.</span></span>

## <a name="closing-an-incident"></a><span data-ttu-id="bf661-150">Fermeture d’un incident</span><span class="sxs-lookup"><span data-stu-id="bf661-150">Closing an Incident</span></span>

<span data-ttu-id="bf661-151">Lorsque vous avez terminé le diagnostic d’un incident, appelez [**NdfCloseIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcloseincident) pour libérer des ressources système associées à l’exécution de diagnostics sur cet incident.</span><span class="sxs-lookup"><span data-stu-id="bf661-151">When you are finished diagnosing an incident, call [**NdfCloseIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcloseincident) to free system resources associated with performing diagnostics on that incident.</span></span> <span data-ttu-id="bf661-152">(Notez que cela ne libère pas les objets créés par [**NdfDiagnoseIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfdiagnoseincident).</span><span class="sxs-lookup"><span data-stu-id="bf661-152">(Note that this does not free objects created by [**NdfDiagnoseIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfdiagnoseincident).</span></span>
