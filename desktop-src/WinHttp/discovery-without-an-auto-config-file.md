---
description: Si un fichier de configuration automatique de proxy n’a pas été déployé sur le réseau local, WinHttpGetProxyForUrl ne peut pas trouver de serveur proxy.
ms.assetid: a170e63a-8586-47df-af5e-4ee3621795b2
title: Détection sans fichier de configuration automatique
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b6a5ec281c2ef74e2a377cecbd30f16cbc49bd79
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "106539772"
---
# <a name="discovery-without-an-auto-config-file"></a><span data-ttu-id="630d1-103">Détection sans fichier de configuration automatique</span><span class="sxs-lookup"><span data-stu-id="630d1-103">Discovery Without an Auto-Config File</span></span>

<span data-ttu-id="630d1-104">Si un fichier de configuration automatique de proxy n’a pas été déployé sur le réseau local, [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) ne peut pas trouver de serveur proxy.</span><span class="sxs-lookup"><span data-stu-id="630d1-104">If a proxy auto-configuration file has not been deployed on the local network, [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) cannot find a proxy server.</span></span> <span data-ttu-id="630d1-105">Si **WinHttpGetProxyForUrl** échoue, il existe plusieurs stratégies de basculement possibles pour obtenir une configuration de proxy viable, en fonction de son environnement d’exécution.</span><span class="sxs-lookup"><span data-stu-id="630d1-105">If **WinHttpGetProxyForUrl** fails, there are several possible fall-back strategies for obtaining a viable proxy configuration, depending on its runtime environment.</span></span> <span data-ttu-id="630d1-106">Il s’agit notamment de demander le paramètre de proxy via une interface utilisateur, de demander à un utilisateur de stocker la configuration du proxy dans le registre à l’aide de l’utilitaire « ProxyCfg.exe » WinHTTP ou d’utiliser [**WinHttpGetIEProxyConfigForCurrentUser**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetieproxyconfigforcurrentuser) pour vérifier si un serveur proxy est listé dans les paramètres d’Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="630d1-106">These include prompting for the proxy setting through a user interface, requiring someone to store the proxy configuration in the registry using the WinHTTP "ProxyCfg.exe" utility, or using [**WinHttpGetIEProxyConfigForCurrentUser**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetieproxyconfigforcurrentuser) to check whether a proxy server is listed in Internet Explorer's settings.</span></span>

<span data-ttu-id="630d1-107">Il est possible qu’il n’existe pas de fichier de configuration automatique de proxy car le client dispose d’une connexion Internet directe, par exemple via un fournisseur de services Internet, et n’a pas besoin d’un serveur proxy.</span><span class="sxs-lookup"><span data-stu-id="630d1-107">It is possible that there is no proxy auto-configuration file because the client has a direct Internet connection, such as through an ISP, and does not need a proxy server.</span></span>

<span data-ttu-id="630d1-108">Un serveur proxy peut être requis, en revanche, mais le réseau local ne prend peut-être pas en charge WPAD.</span><span class="sxs-lookup"><span data-stu-id="630d1-108">A proxy server may be required, on the other hand, but the local network may not support WPAD.</span></span> <span data-ttu-id="630d1-109">Dans ce cas, la configuration du proxy doit être obtenue à partir de l’utilisateur ou trouvée sur l’ordinateur client.</span><span class="sxs-lookup"><span data-stu-id="630d1-109">In this case, the proxy configuration must be obtained from the user or found somewhere on the client machine.</span></span>

<span data-ttu-id="630d1-110">Une application basée sur WinHTTP qui s’exécute dans un environnement serveur de niveau intermédiaire, telle qu’une application COM+ ou ASP, doit s’appuyer sur un administrateur de serveur qui définit une configuration de proxy par défaut dans le registre à l’aide de l’utilitaire « ProxyCfg.exe ».</span><span class="sxs-lookup"><span data-stu-id="630d1-110">A WinHTTP-based application running in a middle-tier server environment, such as a COM+ or ASP application, should rely on a server administrator setting a default proxy configuration in the registry using the "ProxyCfg.exe" utility.</span></span> <span data-ttu-id="630d1-111">Ces informations de configuration par défaut peuvent ensuite être récupérées à l’aide de la fonction [**WinHttpGetDefaultProxyConfiguration**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetdefaultproxyconfiguration) , ou simplement en spécifiant l’indicateur de **\_ \_ \_ préconfiguration de type d’accès WinHTTP** dans l’appel [**WinHttpOpen**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopen) .</span><span class="sxs-lookup"><span data-stu-id="630d1-111">This default configuration information can then be retrieved either by using the [**WinHttpGetDefaultProxyConfiguration**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetdefaultproxyconfiguration) function, or simply by specifying the **WINHTTP\_ACCESS\_TYPE\_PRECONFIG** flag in the [**WinHttpOpen**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopen) call.</span></span>

<span data-ttu-id="630d1-112">En revanche, une application WinHTTP s’exécutant sur un ordinateur de bureau client peut tenter d’examiner les paramètres de proxy d’Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="630d1-112">On the other hand, a WinHTTP application running on a client desktop machine can attempt to examine Internet Explorer's proxy settings.</span></span> <span data-ttu-id="630d1-113">[**WinHttpGetIEProxyConfigForCurrentUser**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetieproxyconfigforcurrentuser) remplit une structure de configuration de proxy Internet Explorer de l' [**\_ \_ utilisateur \_ \_ \_ en cours**](/windows/win32/api/winhttp/ns-winhttp-winhttp_current_user_ie_proxy_config) , fournie par l’appelant, avec les paramètres de proxy Internet Explorer de l’utilisateur actuel pour la connexion active (accès à distance, VPN ou LAN).</span><span class="sxs-lookup"><span data-stu-id="630d1-113">[**WinHttpGetIEProxyConfigForCurrentUser**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetieproxyconfigforcurrentuser) fills in a caller-supplied [**WINHTTP\_CURRENT\_USER\_IE\_PROXY\_CONFIG**](/windows/win32/api/winhttp/ns-winhttp-winhttp_current_user_ie_proxy_config) structure with the current user's Internet Explorer proxy settings for the current active connection (dial-up, VPN or LAN).</span></span> <span data-ttu-id="630d1-114">Cette configuration peut indiquer que la détection automatique est utilisée, ou elle peut spécifier une URL pour un fichier de configuration automatique de proxy, ou elle peut spécifier un serveur proxy réel à utiliser, ou une combinaison des trois.</span><span class="sxs-lookup"><span data-stu-id="630d1-114">This configuration may indicate that auto-detection is used, or it may specify a URL for a proxy auto-configuration file, or it may specify an actual proxy server to use, or it may specify a combination of the three.</span></span> <span data-ttu-id="630d1-115">Si ces informations incluent une URL PAC ou un serveur proxy, l’application WinHTTP peut essayer de les utiliser.</span><span class="sxs-lookup"><span data-stu-id="630d1-115">If this information includes a PAC URL or a proxy server, the WinHTTP application can try using those.</span></span>

<span data-ttu-id="630d1-116">Vous trouverez un exemple qui utilise les fonctions [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) et [**WinHttpGetIEProxyConfigForCurrentUser**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetieproxyconfigforcurrentuser) dans les exemples WinHTTP du kit de développement logiciel (SDK) de la plateforme.</span><span class="sxs-lookup"><span data-stu-id="630d1-116">A sample that uses the [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) and [**WinHttpGetIEProxyConfigForCurrentUser**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetieproxyconfigforcurrentuser) functions can be found in the Platform Software Development Kit (SDK) WinHTTP samples.</span></span>

 

 



