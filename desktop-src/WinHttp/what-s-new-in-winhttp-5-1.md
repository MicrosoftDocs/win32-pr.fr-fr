---
description: Cette rubrique décrit les différences les plus importantes entre la version 5,1 de WinHTTP et la version 5,0.
ms.assetid: df3fcf27-3012-4818-b29c-b8a4dc409828
title: Nouveautés de WinHTTP 5,1
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 909d5ae8fb1d169af01782d21d2ead56b25c940c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/07/2021
ms.locfileid: "106516467"
---
# <a name="whats-new-in-winhttp-51"></a><span data-ttu-id="c13d5-103">Nouveautés de WinHTTP 5,1</span><span class="sxs-lookup"><span data-stu-id="c13d5-103">What's New in WinHTTP 5.1</span></span>

<span data-ttu-id="c13d5-104">Cette rubrique décrit les différences les plus importantes entre la version 5,1 de WinHTTP et la version 5,0.</span><span class="sxs-lookup"><span data-stu-id="c13d5-104">This topic describes the most important differences between WinHTTP version 5.1 and version 5.0.</span></span> <span data-ttu-id="c13d5-105">La plupart de ces différences requièrent des modifications de code dans les applications qui migrent de la version 5,0 vers la version 5,1.</span><span class="sxs-lookup"><span data-stu-id="c13d5-105">Many of these differences require code changes in applications migrating from version 5.0 to version 5.1.</span></span> <span data-ttu-id="c13d5-106">Certaines des fonctionnalités de la version 5,1 sont uniquement disponibles à partir de Windows Server 2003 et Windows XP avec Service Pack 2 (SP2), en particulier les fonctionnalités liées à l’amélioration de la sécurité du client contre les serveurs Web malveillants.</span><span class="sxs-lookup"><span data-stu-id="c13d5-106">Some of the features in version 5.1 are only available starting with Windows Server 2003 and Windows XP with Service Pack 2 (SP2), particularly features related to improving the security of the client against malicious Web servers.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="c13d5-107">Avec la publication de la version 5,1 de WinHTTP, le téléchargement de WinHTTP 5,0 n’est plus disponible.</span><span class="sxs-lookup"><span data-stu-id="c13d5-107">With the release of WinHTTP Version 5.1, the WinHTTP 5.0 download is no longer available.</span></span> <span data-ttu-id="c13d5-108">À compter du 1er octobre 2004, Microsoft a supprimé le téléchargement du kit de développement logiciel (SDK) WinHTTP 5,0 sur MSDN et a terminé le support technique de la version 5,0.</span><span class="sxs-lookup"><span data-stu-id="c13d5-108">As of October 1, 2004, Microsoft has removed the WinHTTP 5.0 SDK download from MSDN and has terminated product support for version 5.0.</span></span>

 

## <a name="dll-name-change"></a><span data-ttu-id="c13d5-109">Modification du nom de la DLL</span><span class="sxs-lookup"><span data-stu-id="c13d5-109">DLL Name Change</span></span>

<span data-ttu-id="c13d5-110">Le nom de la nouvelle DLL WinHTTP 5,1 est Winhttp.dll, tandis que le nom de la DLL WinHTTP 5,0 est Winhttp5.dll.</span><span class="sxs-lookup"><span data-stu-id="c13d5-110">The name of the new WinHTTP 5.1 DLL is Winhttp.dll, whereas the name of the WinHTTP 5.0 DLL is Winhttp5.dll.</span></span>

<span data-ttu-id="c13d5-111">WinHTTP 5,0 et 5,1 peuvent coexister sur le même système. WinHTTP 5,1 ne remplace pas ou ne s’installe pas sur WinHTTP 5,0.</span><span class="sxs-lookup"><span data-stu-id="c13d5-111">WinHTTP 5.0 and 5.1 can coexist on the same system; WinHTTP 5.1 does not replace, or install over, WinHTTP 5.0.</span></span>

## <a name="redistribution"></a><span data-ttu-id="c13d5-112">Redistribution</span><span class="sxs-lookup"><span data-stu-id="c13d5-112">Redistribution</span></span>

<span data-ttu-id="c13d5-113">WinHTTP 5,1 est disponible uniquement avec Windows Server 2003, Windows 2000 Professionnel avec Service Pack 3 (SP3), Windows XP avec Service Pack 1 (SP1) et les systèmes d’exploitation ultérieurs.</span><span class="sxs-lookup"><span data-stu-id="c13d5-113">WinHTTP 5.1 is available only with Windows Server 2003, Windows 2000 Professional with Service Pack 3 (SP3), Windows XP with Service Pack 1 (SP1), and later operating systems.</span></span> <span data-ttu-id="c13d5-114">Un fichier de module de fusion (. msm) redistribuable n’est pas disponible pour WinHTTP 5,1.</span><span class="sxs-lookup"><span data-stu-id="c13d5-114">A redistributable merge module (.msm) file is not available for WinHTTP 5.1.</span></span>

## <a name="winhttprequest-progid"></a><span data-ttu-id="c13d5-115">ProgID WinHttpRequest</span><span class="sxs-lookup"><span data-stu-id="c13d5-115">WinHttpRequest ProgID</span></span>

<span data-ttu-id="c13d5-116">L’identificateur de programme (ProgID) du composant WinHttpRequest est passé de « WinHttp. WinHttpRequest. 5 » à « WinHttp. WinHttpRequest. 5.1 ».</span><span class="sxs-lookup"><span data-stu-id="c13d5-116">The ProgID of the WinHttpRequest component has changed from "WinHttp.WinHttpRequest.5" to "WinHttp.WinHttpRequest.5.1".</span></span> <span data-ttu-id="c13d5-117">Le CLSID de la classe [**WinHttpRequest**](winhttprequest.md) a également changé.</span><span class="sxs-lookup"><span data-stu-id="c13d5-117">The CLSID of the [**WinHttpRequest**](winhttprequest.md) class has also changed.</span></span>

## <a name="async-callback-behavior-change"></a><span data-ttu-id="c13d5-118">Modification du comportement de rappel asynchrone</span><span class="sxs-lookup"><span data-stu-id="c13d5-118">Async Callback Behavior Change</span></span>

<span data-ttu-id="c13d5-119">Lors de l’appel des fonctions [**WinHttpWriteData**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpwritedata), [**WinHttpQueryDataAvailable**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpquerydataavailable) et [**WinHttpReadData**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpreaddata) en mode asynchrone, ne comptez pas sur les paramètres *lpdwNumberOfBytesWritten*, *lpdwNumberOfBytesAvailable* et *lpdwNumberOfBytesRead* out respectifs à définir.</span><span class="sxs-lookup"><span data-stu-id="c13d5-119">When calling the [**WinHttpWriteData**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpwritedata), [**WinHttpQueryDataAvailable**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpquerydataavailable) and [**WinHttpReadData**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpreaddata) functions in asynchronous mode, do not rely on the respective *lpdwNumberOfBytesWritten*, *lpdwNumberOfBytesAvailable*, and *lpdwNumberOfBytesRead* OUT parameters to be set.</span></span> <span data-ttu-id="c13d5-120">Si l’appel de fonction se termine de façon asynchrone, WinHTTP n’écrit pas sur ces pointeurs fournis par le code d’application.</span><span class="sxs-lookup"><span data-stu-id="c13d5-120">If the function call completes asynchronously, WinHTTP does not write to these pointers supplied by the application code.</span></span> <span data-ttu-id="c13d5-121">Au lieu de cela, l’application doit récupérer ces valeurs à l’aide des paramètres *lpvStatusInformation* et *dwStatusInformationLength* à la fonction de rappel.</span><span class="sxs-lookup"><span data-stu-id="c13d5-121">Instead, the application should retrieve these values using *lpvStatusInformation* and *dwStatusInformationLength* parameters to the callback function.</span></span>

## <a name="changes-to-default-settings"></a><span data-ttu-id="c13d5-122">Modifications apportées aux paramètres par défaut</span><span class="sxs-lookup"><span data-stu-id="c13d5-122">Changes to Default Settings</span></span>

<span data-ttu-id="c13d5-123">Les modifications apportées aux paramètres par défaut sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="c13d5-123">Changes to default settings include:</span></span>

-   <span data-ttu-id="c13d5-124">La vérification du certificat de serveur SSL est activée par défaut dans WinHTTP 5,1.</span><span class="sxs-lookup"><span data-stu-id="c13d5-124">SSL server certificate verification is enabled by default in WinHTTP 5.1.</span></span> <span data-ttu-id="c13d5-125">WinHTTP 5,0 ne gère pas les échecs rencontrés lors de la validation du certificat de serveur comme des erreurs irrécupérables ; elles sont signalées à l’application à l’aide d’une notification de rappel d' **\_ échec sécurisé** , mais n’entraîne pas l’abandon de la requête.</span><span class="sxs-lookup"><span data-stu-id="c13d5-125">WinHTTP 5.0 does not handle failures encountered when validating the server certificate as fatal errors; they are reported to the application using a **SECURE\_FAILURE** callback notification, but does not cause the request to be aborted.</span></span> <span data-ttu-id="c13d5-126">WinHTTP 5,1, sinon, gère les échecs de validation de certificat de serveur comme des erreurs irrécupérables qui abandonnent la demande.</span><span class="sxs-lookup"><span data-stu-id="c13d5-126">WinHTTP 5.1, alternatively, handles server certificate validation failures as fatal errors that abort the request.</span></span> <span data-ttu-id="c13d5-127">L’application peut demander à WinHTTP d’ignorer un petit sous-ensemble d’erreurs de certificat, telles qu’une autorité de certification inconnue, une date de certificat non valide/expirée ou un nom d’objet de certificat non valide, à l’aide de l’option des indicateurs de sécurité de l' **\_ option \_ \_ WinHTTP** .</span><span class="sxs-lookup"><span data-stu-id="c13d5-127">The application can instruct WinHTTP to ignore a small subset of certificate errors such as unknown CA, invalid/expired certificate date, or invalid certificate subject name, using the **WINHTTP\_OPTION\_SECURITY\_FLAGS** option.</span></span>
-   <span data-ttu-id="c13d5-128">La prise en charge de l’authentification Passport est désactivée par défaut dans WinHTTP 5,1.</span><span class="sxs-lookup"><span data-stu-id="c13d5-128">Passport authentication support is disabled by default in WinHTTP 5.1.</span></span> <span data-ttu-id="c13d5-129">La prise en charge de Passport peut être activée avec l’option **WinHTTP \_ configurer l' \_ \_ \_ authentification Passport** .</span><span class="sxs-lookup"><span data-stu-id="c13d5-129">Passport support can be enabled with the **WINHTTP\_OPTION\_CONFIGURE\_PASSPORT\_AUTH** option.</span></span> <span data-ttu-id="c13d5-130">La recherche automatique des informations d’identification Passport dans le porte-clés est également désactivée par défaut.</span><span class="sxs-lookup"><span data-stu-id="c13d5-130">Automatic Passport credential look-up in the Keyring is also disabled by default.</span></span>
-   <span data-ttu-id="c13d5-131">Changement de comportement de redirection : les redirections HTTP d’une URL sécurisée **https** vers une URL **http** standard ne sont plus suivies automatiquement par défaut pour des raisons de sécurité.</span><span class="sxs-lookup"><span data-stu-id="c13d5-131">Redirect behavior change: HTTP redirects from a secure **https:** URL to a regular **http:** URL are no longer followed automatically by default for security reasons.</span></span> <span data-ttu-id="c13d5-132">Il existe une nouvelle option, **la \_ \_ \_ stratégie de redirection des options WinHTTP**, pour remplacer le comportement de redirection par défaut dans WinHTTP 5,1.</span><span class="sxs-lookup"><span data-stu-id="c13d5-132">There is a new option, **WINHTTP\_OPTION\_REDIRECT\_POLICY**, to override the default redirect behavior in WinHTTP 5.1.</span></span> <span data-ttu-id="c13d5-133">Avec le composant COM **WinHttpRequest** , utilisez l’option New **WinHttpRequestOption \_ EnableHttpsToHttpRedirects** pour activer les redirections à partir de https : vers https : URL.</span><span class="sxs-lookup"><span data-stu-id="c13d5-133">With the **WinHttpRequest** COM component, use the new **WinHttpRequestOption\_EnableHttpsToHttpRedirects** option to enable redirects from https: to http: URLs.</span></span>
-   <span data-ttu-id="c13d5-134">Lorsqu’un fichier de trace WinHTTP est créé, l’accès est limité à une liste de contrôle d’accès, de sorte que seuls les administrateurs peuvent lire ou écrire le fichier.</span><span class="sxs-lookup"><span data-stu-id="c13d5-134">When a WinHTTP trace file is created, access is restricted with an ACL such that only administrators can read or write the file.</span></span> <span data-ttu-id="c13d5-135">Le compte d’utilisateur sous lequel le tracefile a été créé peut également modifier la liste de contrôle d’accès pour accorder l’accès aux autres utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="c13d5-135">The user account under which the tracefile was created can also modify the ACL to grant others access.</span></span> <span data-ttu-id="c13d5-136">Cette protection est disponible uniquement sur les systèmes de fichiers qui prennent en charge la sécurité. autrement dit, NTFS, et non FAT32).</span><span class="sxs-lookup"><span data-stu-id="c13d5-136">This protection is available only on file systems which support security; that is, NTFS, not FAT32).</span></span>
-   <span data-ttu-id="c13d5-137">À compter de Windows Server 2003 et Windows XP avec SP2, l’envoi de demandes aux ports connus, non HTTP et connus suivants est limité pour des raisons de sécurité : 21 (FTP), 25 (SMTP), 70 (GOPHER), 110 (POP3), 119 (NNTP), 143 (IMAP).</span><span class="sxs-lookup"><span data-stu-id="c13d5-137">Starting with Windows Server 2003 and Windows XP with SP2, sending requests to the following well-known, non-HTTP, ports is restricted for security reasons: 21 (FTP), 25 (SMTP), 70 (GOPHER), 110 (POP3), 119 (NNTP), 143 (IMAP).</span></span>
-   <span data-ttu-id="c13d5-138">À compter de Windows Server 2003 et Windows XP avec SP2, la quantité maximale d’en-tête de données d’en-tête que WinHTTP accepte dans une réponse HTTP est de 64 Ko par défaut.</span><span class="sxs-lookup"><span data-stu-id="c13d5-138">Starting with Windows Server 2003, and Windows XP with SP2, the maximum amount of header data WinHTTP accepts in an HTTP response is 64K, by default.</span></span> <span data-ttu-id="c13d5-139">Si la réponse HTTP du serveur contient plus de 64 Ko de données d’en-tête totales, WinHTTP échoue à la demande avec une erreur WinHTTP erreur de **\_ \_ \_ \_ réponse du serveur non valide** .</span><span class="sxs-lookup"><span data-stu-id="c13d5-139">If the server HTTP response contains more that 64K of total header data, WinHTTP fails the request with an **ERROR\_WINHTTP\_INVALID\_SERVER\_RESPONSE** error.</span></span> <span data-ttu-id="c13d5-140">Cette limite de 64 Ko peut être remplacée à l’aide de l’option **\_ \_ taille maximale d' \_ \_ en-tête \_ de réponse de l’option WinHTTP** .</span><span class="sxs-lookup"><span data-stu-id="c13d5-140">This 64K limit can be overridden using the new **WINHTTP\_OPTION\_MAX\_RESPONSE\_HEADER\_SIZE** option.</span></span>

## <a name="ipv6-support"></a><span data-ttu-id="c13d5-141">Prise en charge D’ipv6</span><span class="sxs-lookup"><span data-stu-id="c13d5-141">IPv6 Support</span></span>

<span data-ttu-id="c13d5-142">WinHTTP 5,1 ajoute la prise en charge du protocole IPv6 (Internet Protocol version 6).</span><span class="sxs-lookup"><span data-stu-id="c13d5-142">WinHTTP 5.1 adds support for Internet Protocol Version 6 (IPv6).</span></span> <span data-ttu-id="c13d5-143">WinHTTP peut envoyer des requêtes HTTP à un serveur dont le nom DNS est résolu en une adresse IPv6, et à partir de Windows Server 2003 et Windows XP avec SP2, WinHTTP prend également en charge les adresses littérales IPv6.</span><span class="sxs-lookup"><span data-stu-id="c13d5-143">WinHTTP can send HTTP requests to a server whose DNS name resolves into an IPv6 address, and starting with Windows Server 2003 and Windows XP with SP2, WinHTTP also supports IPv6 literal addresses.</span></span>

## <a name="new-options-in-the-cc-api-for-winhttp"></a><span data-ttu-id="c13d5-144">Nouvelles options de l’API C/C++ pour WinHTTP</span><span class="sxs-lookup"><span data-stu-id="c13d5-144">New Options in the C/C++ API for WinHTTP</span></span>

<span data-ttu-id="c13d5-145">WinHTTP 5,1 implémente les nouvelles options suivantes :</span><span class="sxs-lookup"><span data-stu-id="c13d5-145">WinHTTP 5.1 implements the following new options:</span></span>

<dl> <span data-ttu-id="c13d5-146">« \# définir l' \_ option \_ WinHTTP \_ déconnecter Passport \_ 86 »</span><span class="sxs-lookup"><span data-stu-id="c13d5-146">"\#define WINHTTP\_OPTION\_PASSPORT\_SIGN\_OUT 86"</span></span>  
<span data-ttu-id="c13d5-147">« \# définir l' \_ option \_ WinHTTP \_ URL de retour Passport \_ 87 »</span><span class="sxs-lookup"><span data-stu-id="c13d5-147">"\#define WINHTTP\_OPTION\_PASSPORT\_RETURN\_URL 87"</span></span>  
<span data-ttu-id="c13d5-148">« \# définir \_ la stratégie de redirection de l’OPTION WinHTTP \_ \_ 88 »</span><span class="sxs-lookup"><span data-stu-id="c13d5-148">"\#define WINHTTP\_OPTION\_REDIRECT\_POLICY 88"</span></span>  
</dl>

<span data-ttu-id="c13d5-149">À compter de Windows Server 2003 et Windows XP avec SP2, WinHTTP 5,1 implémente les nouvelles options suivantes.</span><span class="sxs-lookup"><span data-stu-id="c13d5-149">Starting with Windows Server 2003 and Windows XP with SP2, WinHTTP 5.1 implements the following new options.</span></span> <span data-ttu-id="c13d5-150">Sur Windows 2000 Professionnel avec SP3 ou Windows XP avec SP1, toutefois, les appels à [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) ou [**WinHttpQueryOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpqueryoption) avec ces ID d’option échouent :</span><span class="sxs-lookup"><span data-stu-id="c13d5-150">On Windows 2000 Professional with SP3 or Windows XP with SP1, however, calls to [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) or [**WinHttpQueryOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpqueryoption) with these option IDs fail:</span></span>

<dl> <span data-ttu-id="c13d5-151">« \# définir l' \_ option WinHTTP \_ recevoir le \_ \_ délai d’expiration de la réponse 7 »</span><span class="sxs-lookup"><span data-stu-id="c13d5-151">"\#define WINHTTP\_OPTION\_RECEIVE\_RESPONSE\_TIMEOUT 7"</span></span>  
<span data-ttu-id="c13d5-152">« \# définir l' \_ option WinHTTP \_ nombre maximal de \_ \_ \_ redirections automatiques http 89 »</span><span class="sxs-lookup"><span data-stu-id="c13d5-152">"\#define WINHTTP\_OPTION\_MAX\_HTTP\_AUTOMATIC\_REDIRECTS 89"</span></span>  
<span data-ttu-id="c13d5-153">« \# définir l' \_ option WinHTTP \_ Max \_ HTTP \_ Status \_ continue 90 »</span><span class="sxs-lookup"><span data-stu-id="c13d5-153">"\#define WINHTTP\_OPTION\_MAX\_HTTP\_STATUS\_CONTINUE 90"</span></span>  
<span data-ttu-id="c13d5-154">« \# définir l' \_ option \_ WinHTTP \_ \_ -taille maximale d’en-tête de réponse \_ 91 »</span><span class="sxs-lookup"><span data-stu-id="c13d5-154">"\#define WINHTTP\_OPTION\_MAX\_RESPONSE\_HEADER\_SIZE 91"</span></span>  
<span data-ttu-id="c13d5-155">« \# définir l' \_ option WinHTTP \_ taille maximale de drainage de la \_ réponse \_ \_ 92 »</span><span class="sxs-lookup"><span data-stu-id="c13d5-155">"\#define WINHTTP\_OPTION\_MAX\_RESPONSE\_DRAIN\_SIZE 92"</span></span>  
</dl>

## <a name="new-options-in-the-winhttprequest-51-component"></a><span data-ttu-id="c13d5-156">Nouvelles options dans le composant WinHttpRequest 5,1</span><span class="sxs-lookup"><span data-stu-id="c13d5-156">New Options in the WinHttpRequest 5.1 Component</span></span>

<span data-ttu-id="c13d5-157">Le composant WinHttpRequest 5,1 implémente les nouvelles options suivantes :</span><span class="sxs-lookup"><span data-stu-id="c13d5-157">The WinHttpRequest 5.1 component implements the following new options:</span></span>

<dl> <span data-ttu-id="c13d5-158">« WinHttpRequestOption \_ RevertImpersonationOverSsl »</span><span class="sxs-lookup"><span data-stu-id="c13d5-158">"WinHttpRequestOption\_RevertImpersonationOverSsl"</span></span>  
<span data-ttu-id="c13d5-159">« WinHttpRequestOption \_ EnableHttpsToHttpRedirects »</span><span class="sxs-lookup"><span data-stu-id="c13d5-159">"WinHttpRequestOption\_EnableHttpsToHttpRedirects"</span></span>  
<span data-ttu-id="c13d5-160">« WinHttpRequestOption \_ EnablePassportAuthentication »</span><span class="sxs-lookup"><span data-stu-id="c13d5-160">"WinHttpRequestOption\_EnablePassportAuthentication"</span></span>  
</dl>

<span data-ttu-id="c13d5-161">Les nouvelles options WinHttpRequest 5,1 suivantes sont disponibles à partir de Windows Server 2003 et Windows XP avec SP2 :</span><span class="sxs-lookup"><span data-stu-id="c13d5-161">The following new WinHttpRequest 5.1 options are available starting with Windows Server 2003 and Windows XP with SP2:</span></span>

<dl> <span data-ttu-id="c13d5-162">« WinHttpRequestOption \_ MaxAutomaticRedirects »</span><span class="sxs-lookup"><span data-stu-id="c13d5-162">"WinHttpRequestOption\_MaxAutomaticRedirects"</span></span>  
<span data-ttu-id="c13d5-163">« WinHttpRequestOption \_ MaxResponseHeaderSize »</span><span class="sxs-lookup"><span data-stu-id="c13d5-163">"WinHttpRequestOption\_MaxResponseHeaderSize"</span></span>  
<span data-ttu-id="c13d5-164">« WinHttpRequestOption \_ MaxResponseDrainSize »</span><span class="sxs-lookup"><span data-stu-id="c13d5-164">"WinHttpRequestOption\_MaxResponseDrainSize"</span></span>  
<span data-ttu-id="c13d5-165">« WinHttpRequestOptions \_ EnableHttp1 \_ 1 »</span><span class="sxs-lookup"><span data-stu-id="c13d5-165">"WinHttpRequestOptions\_EnableHttp1\_1"</span></span>  
</dl>

## <a name="proxies-are-not-trusted-when-auto-logon-security-is-set-to-high"></a><span data-ttu-id="c13d5-166">Les proxies ne sont pas approuvés lorsque la sécurité d’ouverture de session automatique est définie sur élevée</span><span class="sxs-lookup"><span data-stu-id="c13d5-166">Proxies Are Not Trusted When Auto-Logon Security is Set to High</span></span>

<span data-ttu-id="c13d5-167">Dans WinHTTP 5,0, les serveurs proxy sont toujours approuvés pour la connexion automatique.</span><span class="sxs-lookup"><span data-stu-id="c13d5-167">In WinHTTP 5.0, proxy servers are always trusted for auto-logon.</span></span> <span data-ttu-id="c13d5-168">Cette valeur n’est plus valide pour WinHTTP 5,1 s’exécutant sur Windows Server 2003 et Windows XP avec SP2 lorsque l’option de stratégie niveau de sécurité d’ouverture de session automatique WinHTTP est définie. **\_ \_ \_ \_**</span><span class="sxs-lookup"><span data-stu-id="c13d5-168">This is no longer valid for WinHTTP 5.1 running on Windows Server 2003 and Windows XP with SP2 when the **WINHTTP\_AUTOLOGON\_SECURITY\_LEVEL\_HIGH** policy option is set.</span></span>

## <a name="web-proxy-auto-discovery-autoproxy-api"></a><span data-ttu-id="c13d5-169">API de détection automatique de proxy Web (AutoProxy)</span><span class="sxs-lookup"><span data-stu-id="c13d5-169">Web Proxy Auto-Discovery (AutoProxy) API</span></span>

<span data-ttu-id="c13d5-170">Pour faciliter la configuration des paramètres de proxy pour les applications basées sur WinHTTP, WinHTTP implémente désormais le protocole WPAD (Web Proxy Auto-Discovery), également appelé « *proxy* automatique ».</span><span class="sxs-lookup"><span data-stu-id="c13d5-170">To ease the configuration of proxy settings for WinHTTP-based applications, WinHTTP now implements the Web Proxy Auto-Discovery (WPAD) protocol, also referred to as *autoproxy*.</span></span> <span data-ttu-id="c13d5-171">Il s’agit du même protocole que celui utilisé par les navigateurs Web, tels qu’Internet Explorer, pour détecter automatiquement la configuration du proxy sans obliger l’utilisateur final à spécifier un serveur proxy manuellement.</span><span class="sxs-lookup"><span data-stu-id="c13d5-171">This is the same protocol that web browsers, such as Internet Explorer, implement to discover the proxy configuration automatically without requiring an end-user to specify a proxy server manually.</span></span> <span data-ttu-id="c13d5-172">Pour prendre en charge le proxy AutoProxy, WinHTTP 5,1 implémente une nouvelle fonction C/C++, [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl), ainsi que deux fonctions de prise en charge, [**WinHttpDetectAutoProxyConfigUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpdetectautoproxyconfigurl) et [**WinHttpGetIEProxyConfigForCurrentUser**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetieproxyconfigforcurrentuser).</span><span class="sxs-lookup"><span data-stu-id="c13d5-172">To support autoproxy, WinHTTP 5.1 implements a new C/C++ function, [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl), plus two supporting functions, [**WinHttpDetectAutoProxyConfigUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpdetectautoproxyconfigurl) and [**WinHttpGetIEProxyConfigForCurrentUser**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetieproxyconfigforcurrentuser).</span></span>

## <a name="known-issues"></a><span data-ttu-id="c13d5-173">Problèmes connus</span><span class="sxs-lookup"><span data-stu-id="c13d5-173">Known Issues</span></span>

<span data-ttu-id="c13d5-174">Les problèmes suivants sont connus pour exister dans WinHTTP 5,1 sur Windows 2000 Professionnel avec SP3 et Windows XP avec SP1.</span><span class="sxs-lookup"><span data-stu-id="c13d5-174">The following issues are known to exist in WinHTTP 5.1 on Windows 2000 Professional with SP3 and Windows XP with SP1.</span></span> <span data-ttu-id="c13d5-175">Ces problèmes sont résolus pour WinHTTP à partir de Windows Server 2003 et Windows XP avec SP2 :</span><span class="sxs-lookup"><span data-stu-id="c13d5-175">These issues are resolved for WinHTTP starting with Windows Server 2003 and Windows XP with SP2:</span></span>

-   <span data-ttu-id="c13d5-176">Si l’application utilise la fonction [**WinHttpSetTimeouts**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsettimeouts) ou la méthode [**SetTimeouts**](iwinhttprequest-settimeouts.md) sur le composant [**WinHttpRequest**](iwinhttprequest-interface.md) pour définir un délai d’expiration de résolution DNS non infini, tel que le paramètre *dwResolveTimeout* , une fuite de handle de thread se produit chaque fois que WinHTTP résout un nom DNS.</span><span class="sxs-lookup"><span data-stu-id="c13d5-176">If the application uses the [**WinHttpSetTimeouts**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsettimeouts) function or the [**SetTimeouts**](iwinhttprequest-settimeouts.md) method on the [**WinHttpRequest**](iwinhttprequest-interface.md) component to set a non-infinite DNS resolve timeout such as the *dwResolveTimeout* parameter, a thread handle leak occurs each time WinHTTP resolves a DNS name.</span></span> <span data-ttu-id="c13d5-177">Sur un grand nombre de requêtes HTTP, cela entraîne une fuite de mémoire importante.</span><span class="sxs-lookup"><span data-stu-id="c13d5-177">Over a large number of HTTP requests, this causes a significant memory leak.</span></span> <span data-ttu-id="c13d5-178">La solution de contournement consiste à conserver le paramètre de délai de résolution infini par défaut comme étant inchangé (une valeur de 0 spécifie un délai d’expiration infini).</span><span class="sxs-lookup"><span data-stu-id="c13d5-178">The workaround is to leave the default infinite resolve timeout setting unchanged (a value of 0 specifies an infinite timeout).</span></span> <span data-ttu-id="c13d5-179">Cela est fortement recommandé dans tous les cas, car la prise en charge des délais d’attente sur les résolutions de noms DNS dans WinHTTP est coûteuse en termes de performances.</span><span class="sxs-lookup"><span data-stu-id="c13d5-179">This is strongly recommended in any case as supporting timeouts on DNS name resolutions in WinHTTP is expensive in terms of performance.</span></span> <span data-ttu-id="c13d5-180">Pour Windows 2000 et versions ultérieures, la définition d’un délai d’expiration de résolution DNS dans WinHTTP n’est pas nécessaire, car le service client DNS sous-jacent implémente son propre délai de résolution.</span><span class="sxs-lookup"><span data-stu-id="c13d5-180">For Windows 2000 and later, setting a DNS resolve timeout in WinHTTP is unnecessary as the underlying DNS client service implements its own resolve timeout.</span></span>
-   <span data-ttu-id="c13d5-181">Lors du traitement de requêtes asynchrones, WinHTTP ne gère pas correctement l’emprunt d’identité de thread.</span><span class="sxs-lookup"><span data-stu-id="c13d5-181">When processing asynchronous requests, WinHTTP does not handle thread impersonation properly.</span></span> <span data-ttu-id="c13d5-182">Cela entraîne l’échec des demandes qui requièrent l’authentification NTLM/Negotiate, sauf si les informations d’identification sont fournies explicitement à l’aide des fonctions [**WinHttpSetCredentials**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetcredentials) ou [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) .</span><span class="sxs-lookup"><span data-stu-id="c13d5-182">This causes requests that require NTLM/Negotiate authentication to fail, unless credentials are explicitly given using the [**WinHttpSetCredentials**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetcredentials) or [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) functions.</span></span>

 

 



