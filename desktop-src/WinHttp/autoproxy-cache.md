---
description: Cache du proxy AutoProxy
ms.assetid: 087104e8-ab38-4ba4-be70-23a5ea2bb130
title: Cache du proxy AutoProxy
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6d0492bec116bad8a82da0e961cf6d851d27c787
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/08/2021
ms.locfileid: "106526934"
---
# <a name="autoproxy-cache"></a><span data-ttu-id="d9a8f-103">Cache du proxy AutoProxy</span><span class="sxs-lookup"><span data-stu-id="d9a8f-103">AutoProxy Cache</span></span>

<span data-ttu-id="d9a8f-104">La fonction [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) effectue une recherche de proxy AutoProxy à la demande pour l’URL spécifiée.</span><span class="sxs-lookup"><span data-stu-id="d9a8f-104">The [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) function performs autoproxy lookup on a per-request basis for the specified URL.</span></span> <span data-ttu-id="d9a8f-105">Si plusieurs proxies sont retournés, les applications clientes doivent tester chaque proxy avant d’envoyer la demande (pour plus d’informations, consultez la section le [seul serveur proxy est actuellement pris en charge](autoproxy-issues-in-winhttp.md) dans les problèmes liés à proxy dans WinHTTP).</span><span class="sxs-lookup"><span data-stu-id="d9a8f-105">If multiple proxies are returned, client applications should test each proxy before sending the request (for more information, see the [Only One Proxy Server is Currently Supported](autoproxy-issues-in-winhttp.md) section in AutoProxy Issues in WinHTTP).</span></span> <span data-ttu-id="d9a8f-106">Les informations contenues dans cette rubrique s’appliquent aux appels à **WinHttpGetProxyForUrl** lorsque le client spécifie la détection automatique de proxy.</span><span class="sxs-lookup"><span data-stu-id="d9a8f-106">The information in this topic applies to calls to **WinHttpGetProxyForUrl** when the client specifies automatic proxy discovery.</span></span>

<span data-ttu-id="d9a8f-107">[**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) localise éventuellement l’URL du proxy AutoProxy et télécharge le script du proxy AutoProxy à partir de ce site.</span><span class="sxs-lookup"><span data-stu-id="d9a8f-107">[**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) optionally locates the autoproxy URL and downloads the autoproxy script from that site.</span></span> <span data-ttu-id="d9a8f-108">WinHttp utilise le script de proxy AutoProxy pour localiser les serveurs proxy.</span><span class="sxs-lookup"><span data-stu-id="d9a8f-108">WinHttp uses the autoproxy script to locate the proxy servers.</span></span> <span data-ttu-id="d9a8f-109">L’URL du proxy et le script du proxy AutoProxy sont mis en cache pour la session spécifiée.</span><span class="sxs-lookup"><span data-stu-id="d9a8f-109">Both the autoproxy URL and the autoproxy script are cached for the specified session.</span></span> <span data-ttu-id="d9a8f-110">Une seule URL et un seul script de proxy AutoProxy sont mis en cache pour chaque session.</span><span class="sxs-lookup"><span data-stu-id="d9a8f-110">Only one autoproxy URL and script are cached for each session.</span></span> <span data-ttu-id="d9a8f-111">En règle générale, le script et l’URL du proxy AutoProxy sont mis en cache jusqu’à ce que l’adresse IP associée à l’ordinateur soit modifiée.</span><span class="sxs-lookup"><span data-stu-id="d9a8f-111">Typically, the autoproxy script and URL are cached until the IP address associated with the computer changes.</span></span> <span data-ttu-id="d9a8f-112">Si une nouvelle adresse IP est détectée lors d’un appel à **WinHttpGetProxyForUrl**, l’appel tente de localiser une nouvelle URL et un script de proxy et met en cache les résultats.</span><span class="sxs-lookup"><span data-stu-id="d9a8f-112">If a new IP address is detected during a call to **WinHttpGetProxyForUrl**, the call will attempt to locate a new autoproxy URL and script and cache the results.</span></span> <span data-ttu-id="d9a8f-113">Un seul utilisateur doit être autorisé par session, afin que les données mises en cache ne soient pas partagées avec d’autres utilisateurs sur l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="d9a8f-113">Only one user should be allowed per session, so that the cached data is not shared with other users on the computer.</span></span> <span data-ttu-id="d9a8f-114">Pour plus d’informations, consultez [vue d’ensemble des sessions WinHTTP](winhttp-sessions-overview.md).</span><span class="sxs-lookup"><span data-stu-id="d9a8f-114">For more information, see [WinHTTP Sessions Overview](winhttp-sessions-overview.md).</span></span>

<span data-ttu-id="d9a8f-115">Si le service hors processus est actif lors de l’appel de [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) , l’URL et le script du proxy AutoProxy mis en cache sont disponibles pour l’ensemble de l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="d9a8f-115">If the out-of-process service is active when [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) is called, the cached autoproxy URL and script are available to the whole computer.</span></span> <span data-ttu-id="d9a8f-116">Toutefois, si le service out-of-process est utilisé et que l’indicateur **fAutoLogonIfChallenged** dans la structure *pAutoProxyOptions* a la valeur true, l’URL et le script du proxy AutoProxy ne sont pas mis en cache.</span><span class="sxs-lookup"><span data-stu-id="d9a8f-116">However, if the out-of-process service is used, and the **fAutoLogonIfChallenged** flag in the *pAutoProxyOptions* structure is true, then the autoproxy URL and script are not cached.</span></span> <span data-ttu-id="d9a8f-117">Par conséquent, l’appel de **WinHttpGetProxyForUrl** avec le membre **FAutoLogonIfChallenged** défini sur **true** entraîne des opérations de surcharge supplémentaires qui peuvent affecter les performances.</span><span class="sxs-lookup"><span data-stu-id="d9a8f-117">Therefore, calling **WinHttpGetProxyForUrl** with the **fAutoLogonIfChallenged** member set to **TRUE** results in additional overhead operations that may affect performance.</span></span> <span data-ttu-id="d9a8f-118">Les étapes suivantes peuvent être utilisées pour améliorer les performances.</span><span class="sxs-lookup"><span data-stu-id="d9a8f-118">The following steps can be used to improve performance.</span></span>

<span data-ttu-id="d9a8f-119">**Pour améliorer les performances**</span><span class="sxs-lookup"><span data-stu-id="d9a8f-119">**To improve performance**</span></span>

1.  <span data-ttu-id="d9a8f-120">Appelez [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) avec le paramètre fAutoLogonIfChallenged défini sur **false**.</span><span class="sxs-lookup"><span data-stu-id="d9a8f-120">Call [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) with the fAutoLogonIfChallenged parameter set to **false**.</span></span> <span data-ttu-id="d9a8f-121">L’URL et le script du proxy AutoProxy sont mis en cache pour les futurs appels à **WinHttpGetProxyForUrl**.</span><span class="sxs-lookup"><span data-stu-id="d9a8f-121">The autoproxy URL and script are cached for future calls to **WinHttpGetProxyForUrl**.</span></span>
2.  <span data-ttu-id="d9a8f-122">Si l’étape 1 échoue, avec l' **erreur d' \_ \_ \_ échec de connexion WinHTTP**, appelez [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) avec le membre **fAutoLogonIfChallenged** défini sur **true**.</span><span class="sxs-lookup"><span data-stu-id="d9a8f-122">If Step 1 fails, with **ERROR\_WINHTTP\_LOGIN\_FAILURE**, then call [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) with the **fAutoLogonIfChallenged** member set to **TRUE**.</span></span>

 

 



