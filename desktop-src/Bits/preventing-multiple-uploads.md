---
title: Empêcher plusieurs chargements
description: Lorsque vous téléchargez un fichier, le service BITS crée un ID de session qui identifie la session de téléchargement sur le client BITS et le serveur BITS.
ms.assetid: 97283f8e-d2fa-4383-9b92-a05f46680443
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ae59bb1d605af7e4dd53b0c1d66618b6816e7886
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "104028659"
---
# <a name="preventing-multiple-uploads"></a><span data-ttu-id="43772-103">Empêcher plusieurs chargements</span><span class="sxs-lookup"><span data-stu-id="43772-103">Preventing Multiple Uploads</span></span>

<span data-ttu-id="43772-104">Lorsque vous téléchargez un fichier, le service BITS crée un ID de session qui identifie la session de téléchargement sur le client BITS et le serveur BITS.</span><span class="sxs-lookup"><span data-stu-id="43772-104">When you upload a file, BITS creates a session ID that identifies the upload session to both the BITS client and BITS server.</span></span> <span data-ttu-id="43772-105">Si la connexion entre le client BITS et le serveur est interrompue pendant que BITS charge un fichier, le client utilise l’ID de session pour tenter de reprendre le téléchargement.</span><span class="sxs-lookup"><span data-stu-id="43772-105">If the connection between the BITS client and server is broken while BITS is uploading a file, the client will use the session ID to try to resume the upload.</span></span>

<span data-ttu-id="43772-106">Si le client BITS se connecte au même serveur qu’auparavant, le serveur reconnaîtra l’ID de session et le chargement reprendra à partir du point d’interruption.</span><span class="sxs-lookup"><span data-stu-id="43772-106">If the BITS client connects to the same server as before, the server will recognize the session ID and the upload will resume from the point of interruption.</span></span> <span data-ttu-id="43772-107">Toutefois, si le client se connecte à un autre serveur, le client doit démarrer le téléchargement depuis le début, car le nouveau serveur n’a pas le contexte de session ou les données précédemment chargées.</span><span class="sxs-lookup"><span data-stu-id="43772-107">However, if the client connects to a different server, the client must start the upload from the beginning because the new server does not have the session context or the previously uploaded data.</span></span> <span data-ttu-id="43772-108">BITS peut se connecter à un autre serveur lorsque le serveur BITS est hébergé sur une batterie de serveurs Web et que la propriété d’extension IIS BITS, [BITSHostId](bits-iis-extension-properties.md), n’est pas définie.</span><span class="sxs-lookup"><span data-stu-id="43772-108">BITS may connect to a different server when the BITS server is hosted on a web farm and the BITS IIS extension property, [BITSHostId](bits-iis-extension-properties.md), is not set.</span></span> <span data-ttu-id="43772-109">La propriété BITSHostId empêche le redémarrage en forçant le client BITS à se connecter à l’adresse unique du serveur précédent au lieu de l’adresse du serveur partagé.</span><span class="sxs-lookup"><span data-stu-id="43772-109">The BITSHostId property prevents restarts by forcing the BITS client to connect to the previous server's unique address instead of the shared server address.</span></span>

<span data-ttu-id="43772-110">Le serveur BITS tentera d’envoyer le fichier de téléchargement une seule fois à l’application serveur, mais il est possible que le fichier soit envoyé plusieurs fois.</span><span class="sxs-lookup"><span data-stu-id="43772-110">The BITS server will attempt to send the upload file only once to the server application, but it is possible that the file may be sent more than one time.</span></span> <span data-ttu-id="43772-111">Cela peut se produire, par exemple, si le serveur BITS envoie le fichier à l’application serveur, puis se termine en attendant la réponse de l’application serveur.</span><span class="sxs-lookup"><span data-stu-id="43772-111">This can occur, for example, if the BITS server sends the file to the server application and then terminates while waiting for the reply from the server application.</span></span> <span data-ttu-id="43772-112">Le client BITS reçoit un code d’erreur de la couche HTTP et réessaie le chargement après un certain délai.</span><span class="sxs-lookup"><span data-stu-id="43772-112">The BITS client will receive an error code from the HTTP layer, and retry the upload after a delay.</span></span> <span data-ttu-id="43772-113">Si le serveur reste hors connexion pendant une durée plus longue que le délai d’expiration de [BITSHostIdFallbackTimeout](bits-iis-extension-properties.md) , le client envoie à nouveau la requête à l’adresse du serveur partagé. un autre serveur BITS recevra le fichier et le remetra à nouveau à l’application serveur.</span><span class="sxs-lookup"><span data-stu-id="43772-113">If the server stays offline for longer than the [BITSHostIdFallbackTimeout](bits-iis-extension-properties.md) timeout, then the client will eventually send the request to the shared server address again; a different BITS server will receive the file and deliver it again to the server application.</span></span>

<span data-ttu-id="43772-114">Un même cas de figure peut se produire même avec un serveur frontal unique.</span><span class="sxs-lookup"><span data-stu-id="43772-114">A similar case can occur even with a single front-end server.</span></span> <span data-ttu-id="43772-115">Par exemple, lorsque le client a téléchargé la totalité du fichier sur le serveur, le bloc final fait en sorte que le serveur transfère le fichier à l’application serveur.</span><span class="sxs-lookup"><span data-stu-id="43772-115">For example, when the client has uploaded the entire file to the server, the final block causes the server to forward the file to the server application.</span></span> <span data-ttu-id="43772-116">Si le serveur BITS ou l’application serveur se termine après le traitement du fichier mais avant que l’accusé de réception ne soit envoyé au client, le client recevra un code d’erreur et réessaiera ultérieurement.</span><span class="sxs-lookup"><span data-stu-id="43772-116">If the BITS server or the server application terminate after the file is processed but before the acknowledgment is sent to the client, then the client will receive an error code and retry later.</span></span> <span data-ttu-id="43772-117">Lorsque le client effectue une nouvelle tentative, le serveur BITS voit que le dernier bloc a été chargé, et il transfère à nouveau le fichier à l’application serveur.</span><span class="sxs-lookup"><span data-stu-id="43772-117">When the client retries, the BITS server will see that the final block has been uploaded, and it will again forward the file to the server application.</span></span> <span data-ttu-id="43772-118">Si la réception du fichier de téléchargement à plusieurs moments est un problème pour votre application serveur, vous devez envisager d’inclure un identificateur de transaction dans les données.</span><span class="sxs-lookup"><span data-stu-id="43772-118">If receiving the upload file multiple times is an issue for your server application, you should consider including a transaction identifier in the data.</span></span>

 

 




