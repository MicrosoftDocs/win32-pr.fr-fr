---
title: Définition des autorisations sur les répertoires virtuels
description: Pour des raisons de sécurité, Service de transfert intelligent en arrière-plan (BITS) ne télécharge pas les fichiers vers un répertoire virtuel pour lequel les autorisations de script et d’exécution sont activées.
ms.assetid: cf5c8b50-066f-431e-8bdf-ed0692219b20
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e6753c326e926724a57e1905c3fb9fe24e28fdc7
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104031458"
---
# <a name="setting-permissions-on-virtual-directories"></a><span data-ttu-id="e0887-103">Définition des autorisations sur les répertoires virtuels</span><span class="sxs-lookup"><span data-stu-id="e0887-103">Setting Permissions on Virtual Directories</span></span>

<span data-ttu-id="e0887-104">Pour des raisons de sécurité, Service de transfert intelligent en arrière-plan (BITS) ne télécharge pas les fichiers vers un répertoire virtuel pour lequel les autorisations de script et d’exécution sont activées.</span><span class="sxs-lookup"><span data-stu-id="e0887-104">For security reasons, Background Intelligent Transfer Service (BITS) does not upload files to a virtual directory that has scripting and execute permissions enabled.</span></span> <span data-ttu-id="e0887-105">Si vous chargez un fichier dans un répertoire virtuel pour lequel ces autorisations sont activées, le travail échoue avec un code d’erreur d' \_ exécution du serveur BG E \_ \_ \_ activé.</span><span class="sxs-lookup"><span data-stu-id="e0887-105">If you upload a file to a virtual directory that has these permissions enabled, the job fails with an error code of BG\_E\_SERVER\_EXECUTE\_ENABLED.</span></span>

<span data-ttu-id="e0887-106">Le service BITS ne nécessite pas l’activation de l’écriture dans le répertoire virtuel. il est donc recommandé de désactiver l’accès en écriture au répertoire virtuel.</span><span class="sxs-lookup"><span data-stu-id="e0887-106">BITS does not require the virtual directory to be write enabled, so it is recommended that you turn off write access to the virtual directory.</span></span>

<span data-ttu-id="e0887-107">L’utilisateur authentifié (ou l’utilisateur anonyme d’IIS pour l’authentification anonyme) doit disposer d’autorisations de modification sur le répertoire physique auquel le répertoire virtuel est mappé ; l’octroi d’autorisations en écriture ne suffit pas.</span><span class="sxs-lookup"><span data-stu-id="e0887-107">The authenticated user (or IIS's Anonymous user for anonymous authentication) must have Change permissions on the physical directory to which the virtual directory is mapped; granting Write permissions does not suffice.</span></span>

## <a name="specifying-permissions-for-notifications"></a><span data-ttu-id="e0887-108">Spécification des autorisations pour les notifications</span><span class="sxs-lookup"><span data-stu-id="e0887-108">Specifying Permissions for Notifications</span></span>

<span data-ttu-id="e0887-109">Le schéma d’authentification que vous spécifiez pour le répertoire virtuel et l’URL de notification (voir la propriété [BITSServerNotificationURL](bits-iis-extension-properties.md) ) doit être compatible.</span><span class="sxs-lookup"><span data-stu-id="e0887-109">The authentication scheme you specify for the virtual directory and notification URL (see the [BITSServerNotificationURL](bits-iis-extension-properties.md) property) must be compatible.</span></span> <span data-ttu-id="e0887-110">Le service BITS utilise le schéma d’authentification spécifié pour que le répertoire virtuel accède à l’URL de notification.</span><span class="sxs-lookup"><span data-stu-id="e0887-110">BITS uses the authentication scheme specified for the virtual directory to access the notification URL.</span></span> <span data-ttu-id="e0887-111">Le travail de chargement échoue si le service BITS ne peut pas accéder à l’URL de notification en raison d’un échec d’authentification.</span><span class="sxs-lookup"><span data-stu-id="e0887-111">The upload job fails if BITS is unable to access the notification URL due to authentication failure.</span></span>

<span data-ttu-id="e0887-112">Si le type de notification (voir la propriété [BITSServerNotificationType](bits-iis-extension-properties.md) ) est [par référence](using-bits-notification-request-response-headers.md), l’application doit s’assurer que l’utilisateur a accès au fichier référencé (consultez l’en-tête [bits-Request-DataFile-Name](notification-protocol-for-server-applications.md) ).</span><span class="sxs-lookup"><span data-stu-id="e0887-112">If the notification type (see the [BITSServerNotificationType](bits-iis-extension-properties.md) property) is [by reference](using-bits-notification-request-response-headers.md), the application must ensure the user has access to the referenced file (see the [BITS-Request-DataFile-Name](notification-protocol-for-server-applications.md) header).</span></span> <span data-ttu-id="e0887-113">BITS définit les listes de contrôle d’accès sur le fichier référencé sur celles du répertoire physique auquel le répertoire virtuel est mappé.</span><span class="sxs-lookup"><span data-stu-id="e0887-113">BITS sets the ACLs on the referenced file to those of the physical directory to which the virtual directory is mapped.</span></span>

> [!Note]  
> <span data-ttu-id="e0887-114">L’application notifiée doit être en mesure de mapper et d’accéder au fichier distant même si l’URL de notification est desservie par un serveur Web situé sur un autre ordinateur que le répertoire de chargement physique.</span><span class="sxs-lookup"><span data-stu-id="e0887-114">The notified application must be able to map and access the remote file even if the notification URL is serviced by a web server that is on a different computer than the physical upload directory.</span></span> <span data-ttu-id="e0887-115">L’en-tête [bits-Request-DataFile-Name](notification-protocol-for-server-applications.md) contient toujours une spécification de chemin d’accès relative à l’ordinateur hébergeant le composant extensions bits.</span><span class="sxs-lookup"><span data-stu-id="e0887-115">The [BITS-Request-DataFile-Name](notification-protocol-for-server-applications.md) header always contains a path specification that is relative to the computer hosting the BITS Extensions component.</span></span> <span data-ttu-id="e0887-116">Une application s’exécutant sur un autre ordinateur peut avoir besoin de convertir le chemin en chemin UNC avant d’y accéder.</span><span class="sxs-lookup"><span data-stu-id="e0887-116">An application running on another computer might need to convert the path to an UNC path before accessing it.</span></span>

 

<span data-ttu-id="e0887-117">BITS prend en charge de nombreuses combinaisons de schémas d’authentification.</span><span class="sxs-lookup"><span data-stu-id="e0887-117">BITS supports many combinations of authentication schemes.</span></span> <span data-ttu-id="e0887-118">Toutefois, vous devez utiliser le schéma d’authentification suivant pour le répertoire virtuel et l’URL de notification correspondante.</span><span class="sxs-lookup"><span data-stu-id="e0887-118">However, you should use the following authentication scheme for the virtual directory and the matching notification URL.</span></span>

-   <span data-ttu-id="e0887-119">Pour prendre en charge les notifications de référence, le répertoire virtuel doit être configuré pour utiliser l’authentification NTLM (Negotiate) si le répertoire de chargement physique (le répertoire vers lequel pointe le répertoire virtuel) utilise un schéma d’authentification autre que anonyme.</span><span class="sxs-lookup"><span data-stu-id="e0887-119">To support by reference notifications, the virtual directory should be configured to use NTLM (negotiate) authentication if the physical upload directory (the directory to which the virtual directory points) uses an authentication scheme other than anonymous.</span></span> <span data-ttu-id="e0887-120">Si le répertoire de chargement physique autorise les requêtes anonymes (aucune authentification), le répertoire virtuel doit activer l’authentification anonyme (aucune authentification).</span><span class="sxs-lookup"><span data-stu-id="e0887-120">If the physical upload directory allows anonymous requests (no authentication), the virtual directory should enable anonymous (no authentication).</span></span>

    <span data-ttu-id="e0887-121">Les listes de contrôle d’accès du répertoire de chargement physique doivent être définies de sorte que l’utilisateur authentifié puisse lire les fichiers du répertoire vers lequel pointe l’URL de notification.</span><span class="sxs-lookup"><span data-stu-id="e0887-121">The ACLs on the physical upload directory must be set such that the authenticated user can read files on the directory to which the notification URL points.</span></span> <span data-ttu-id="e0887-122">BITS utilise les listes de contrôle d’accès du répertoire de chargement physique pour définir les listes de contrôle d’accès du fichier de téléchargement temporaire (l’en-tête [bits-Request-DataFile-Name](notification-protocol-for-server-applications.md) contient le chemin d’accès au fichier temporaire).</span><span class="sxs-lookup"><span data-stu-id="e0887-122">BITS uses the ACLs of the physical upload directory to set the ACLs of temporary upload file (the [BITS-Request-DataFile-Name](notification-protocol-for-server-applications.md) header contains the path to the temporary file).</span></span>

-   <span data-ttu-id="e0887-123">Étant donné que les notifications [par valeur](using-bits-notification-request-response-headers.md) ne nécessitent pas que l’application notifiée accède à un fichier temporaire qui contient le contenu de téléchargement, le schéma d’authentification peut être anonyme ou négocier (NTLM).</span><span class="sxs-lookup"><span data-stu-id="e0887-123">Because [by value](using-bits-notification-request-response-headers.md) notifications do not require the notified application to access a temporary file that contains the upload contents, the authentication scheme can be either anonymous or negotiate (NTLM).</span></span> <span data-ttu-id="e0887-124">La seule exigence est que l’utilisateur authentifié pour le répertoire virtuel doit également être autorisé à accéder à l’URL de notification.</span><span class="sxs-lookup"><span data-stu-id="e0887-124">The only requirement is that the authenticated user for the virtual directory must also be authorized to access the notification URL.</span></span>

## <a name="specifying-permissions-for-remote-shares"></a><span data-ttu-id="e0887-125">Spécification des autorisations pour les partages distants</span><span class="sxs-lookup"><span data-stu-id="e0887-125">Specifying Permissions for Remote Shares</span></span>

<span data-ttu-id="e0887-126">Un répertoire virtuel peut pointer vers un lecteur mappé sur un autre ordinateur ou un partage réseau.</span><span class="sxs-lookup"><span data-stu-id="e0887-126">A virtual directory can point to a mapped drive on a different machine or a network share.</span></span> <span data-ttu-id="e0887-127">S’il pointe vers un lecteur réseau mappé, les informations d’identification utilisées pour mapper le lecteur doivent disposer d’un contrôle total sur le partage distant.</span><span class="sxs-lookup"><span data-stu-id="e0887-127">If it points to a mapped network drive, the credentials used to map the drive should have full control on the remote share.</span></span>

<span data-ttu-id="e0887-128">Si le répertoire virtuel pointe vers un partage réseau, le service BITS utilise les informations d’identification de **connexion en tant qu'** utilisateur du répertoire virtuel pour accéder au partage distant.</span><span class="sxs-lookup"><span data-stu-id="e0887-128">If the virtual directory points to a network share, BITS uses the virtual directory's **Connect As** user credentials to access the remote share.</span></span> <span data-ttu-id="e0887-129">Pour accéder à un partage distant, le compte de **connexion** doit disposer des privilèges décrits dans la documentation de la fonction [**LogonUser**](/windows/desktop/api/winbase/nf-winbase-logonusera) .</span><span class="sxs-lookup"><span data-stu-id="e0887-129">To access a remote share, the **Connect As** account needs to have privileges as described in the documentation for the [**LogonUser**](/windows/desktop/api/winbase/nf-winbase-logonusera) function.</span></span> <span data-ttu-id="e0887-130">BITS se connecte à l’aide des types d’ouverture de session \_ \_ interactive LOGON32 batch ou LOGON32 \_ Logon \_ .</span><span class="sxs-lookup"><span data-stu-id="e0887-130">BITS logs on using LOGON32\_LOGON\_BATCH or LOGON32\_LOGON\_INTERACTIVE logon types.</span></span> <span data-ttu-id="e0887-131">Le compte **se connecter en tant qu'** utilisateur a besoin d’autorisations Full-Access sur le partage distant. l’octroi d’autorisations en écriture ne suffit pas.</span><span class="sxs-lookup"><span data-stu-id="e0887-131">The **Connect As** user account needs Full-Access permissions to the remote share; granting Write permissions does not suffice.</span></span>

<span data-ttu-id="e0887-132">Lorsque le répertoire de chargement physique est mappé à un partage réseau, l’identité de l’appelant qui demande l’URL de notification est soit l’utilisateur **se connecter en tant qu'** utilisateur, soit l’utilisateur authentifié du répertoire de chargement physique (uniquement disponible dans IIS 6,0 et versions ultérieures, lorsque la case à cocher **utiliser toujours les informations d’identification de l’utilisateur authentifié lors de la validation de l’accès à la ressource réseau** est sélectionnée dans la boîte de dialogue **se connecter**</span><span class="sxs-lookup"><span data-stu-id="e0887-132">When the physical upload directory is mapped to a network share, the identity of the caller requesting the notification URL is either the **Connect As** user, or the authenticated user of the physical upload directory (only available in IIS 6.0 and later, when the check box **Always use the authenticated user's credentials when validating access to the network resource** is selected on the **Connect As** dialog box).</span></span>

 

 