---
title: Propriétés des extensions IIS BITS
description: Service de transfert intelligent en arrière-plan (BITS) utilise une ISAPI pour étendre IIS afin de prendre en charge les travaux de chargement.
ms.assetid: 08a40cc1-ec6d-4b65-971a-15c7b06df148
keywords:
- BITS des propriétés d’extension IIS BITS
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c09412f6aa0be1ab76e6e45ea0920e1caf1054d7
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104508037"
---
# <a name="bits-iis-extension-properties"></a><span data-ttu-id="9926d-104">Propriétés des extensions IIS BITS</span><span class="sxs-lookup"><span data-stu-id="9926d-104">BITS IIS Extension Properties</span></span>

<span data-ttu-id="9926d-105">Service de transfert intelligent en arrière-plan (BITS) utilise une ISAPI pour étendre IIS afin de prendre en charge les [**travaux de chargement**](/windows/win32/api/bits/ne-bits-bg_job_type).</span><span class="sxs-lookup"><span data-stu-id="9926d-105">Background Intelligent Transfer Service (BITS) uses an ISAPI to extend IIS to support [**upload jobs**](/windows/win32/api/bits/ne-bits-bg_job_type).</span></span> <span data-ttu-id="9926d-106">Le tableau suivant répertorie les propriétés que BITS ajoute à la métabase IIS pour le composant de répertoire virtuel.</span><span class="sxs-lookup"><span data-stu-id="9926d-106">The following table lists the properties that BITS adds to the IIS metabase for the virtual directory component.</span></span> <span data-ttu-id="9926d-107">BITS utilise ces propriétés pour déterminer comment télécharger les fichiers.</span><span class="sxs-lookup"><span data-stu-id="9926d-107">BITS uses these properties to determine how to upload the files.</span></span> <span data-ttu-id="9926d-108">Les propriétés d’extension IIS BITS peuvent être héritées, à l’exception de **BITSUploadEnabled**.</span><span class="sxs-lookup"><span data-stu-id="9926d-108">The BITS IIS extension properties are inheritable, except for **BITSUploadEnabled**.</span></span>



<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><span data-ttu-id="9926d-109">Propriété</span><span class="sxs-lookup"><span data-stu-id="9926d-109">Property</span></span></th>
<th><span data-ttu-id="9926d-110">Description</span><span class="sxs-lookup"><span data-stu-id="9926d-110">Description</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span data-ttu-id="9926d-111"><strong>BITSUploadEnabled</strong> Type de données : <strong>booléen</strong></span><span class="sxs-lookup"><span data-stu-id="9926d-111"><strong>BITSUploadEnabled</strong>Data type: <strong>Boolean</strong></span></span><br/></td>
<td><span data-ttu-id="9926d-112">Indique si les téléchargements BITS sont activés sur le répertoire virtuel.</span><span class="sxs-lookup"><span data-stu-id="9926d-112">Indicates whether BITS uploads are enabled on the virtual directory.</span></span> <span data-ttu-id="9926d-113">Si le paramètre n’est pas présent ou s’il est égal à 0, les téléchargements BITS sont désactivés.</span><span class="sxs-lookup"><span data-stu-id="9926d-113">If the setting is not present or is 0, BITS uploads are disabled.</span></span><br/> <span data-ttu-id="9926d-114">Il s’agit d’une propriété en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="9926d-114">This is a read-only property.</span></span> <span data-ttu-id="9926d-115">Pour définir cette propriété, appelez la méthode <a href="/windows/win32/api/bitscfg/nf-bitscfg-ibitsextensionsetup-enablebitsuploads"><strong>EnableBITSUploads</strong></a> ou <a href="/windows/win32/api/bitscfg/nf-bitscfg-ibitsextensionsetup-disablebitsuploads"><strong>DisableBITSUploads</strong></a> de l’interface <a href="/windows/win32/api/bitscfg/nn-bitscfg-ibitsextensionsetup"><strong>IBITSExtensionSetup</strong></a> .</span><span class="sxs-lookup"><span data-stu-id="9926d-115">To set this property, call the <a href="/windows/win32/api/bitscfg/nf-bitscfg-ibitsextensionsetup-enablebitsuploads"><strong>EnableBITSUploads</strong></a> or <a href="/windows/win32/api/bitscfg/nf-bitscfg-ibitsextensionsetup-disablebitsuploads"><strong>DisableBITSUploads</strong></a> method of the <a href="/windows/win32/api/bitscfg/nn-bitscfg-ibitsextensionsetup"><strong>IBITSExtensionSetup</strong></a> interface.</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="9926d-116"><strong>BITSSessionTimeout</strong> Type de données : <strong>DWORD</strong></span><span class="sxs-lookup"><span data-stu-id="9926d-116"><strong>BITSSessionTimeout</strong>Data type: <strong>DWORD</strong></span></span><br/></td>
<td><span data-ttu-id="9926d-117">Nombre de secondes pendant lesquelles la connexion est conservée si aucune progression n’est effectuée lors du chargement du fichier ; la minuterie est réinitialisée lorsque la progression est effectuée.</span><span class="sxs-lookup"><span data-stu-id="9926d-117">Number of seconds the connection is maintained if no progress is made uploading the file; the timer is reset when progress is made.</span></span> <span data-ttu-id="9926d-118">Le service BITS ferme la connexion si le délai d’expiration est atteint et nettoie les données associées à la session.</span><span class="sxs-lookup"><span data-stu-id="9926d-118">BITS closes the connection if the time-out is reached and cleans up data associated with the session.</span></span><br/> <span data-ttu-id="9926d-119">La définition d’un délai d’expiration de session court peut être un problème pour les travaux de chargement-réponse, car la réponse est téléchargée uniquement lorsque l’utilisateur est connecté et connecté au réseau.</span><span class="sxs-lookup"><span data-stu-id="9926d-119">Setting a short session time-out can be an issue for upload-reply jobs because the reply is only downloaded when the user is logged on and connected to the network.</span></span> <span data-ttu-id="9926d-120">Il est possible que la session expire avant le téléchargement de la réponse. dans ce cas, la session est annulée et le fichier de réponse est supprimé.</span><span class="sxs-lookup"><span data-stu-id="9926d-120">It is possible for the session to time out before the reply is downloaded, in which case the session is canceled and the reply file is deleted.</span></span><br/> <span data-ttu-id="9926d-121">Notez que le service BITS annule le travail si la valeur de stratégie de groupe <a href="/windows/win32/bits/group-policies">paramètre jobinactivitytimeout</a> (la valeur par défaut est 90 jours) est atteinte, quel que soit ce paramètre.</span><span class="sxs-lookup"><span data-stu-id="9926d-121">Note that BITS cancels the job if the <a href="/windows/win32/bits/group-policies">JobInactivityTimeout</a> Group Policy value (default is 90 days) is reached, regardless of this setting.</span></span><br/> <span data-ttu-id="9926d-122">La valeur par défaut est 1 209 600 (14 jours).</span><span class="sxs-lookup"><span data-stu-id="9926d-122">Default value is 1,209,600 (14 days).</span></span><br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="9926d-123"><strong>BITSMaximumUploadSize</strong> Type de données : <strong>chaîne</strong></span><span class="sxs-lookup"><span data-stu-id="9926d-123"><strong>BITSMaximumUploadSize</strong>Data type: <strong>String</strong></span></span><br/></td>
<td><span data-ttu-id="9926d-124">Nombre maximal d’octets qui peuvent être téléchargés par travail.</span><span class="sxs-lookup"><span data-stu-id="9926d-124">Maximum number of bytes that can be uploaded per job.</span></span> <span data-ttu-id="9926d-125">Spécifiez le nombre maximal d’octets sous la forme d’une chaîne décimale ; la valeur de chaîne doit être inférieure ou égale à &quot; 1844674407370955 &quot; .</span><span class="sxs-lookup"><span data-stu-id="9926d-125">Specify the maximum number of bytes as a decimal string; the string value must be less than or equal to &quot;1844674407370955&quot;.</span></span> <span data-ttu-id="9926d-126">Une chaîne vide est identique à la spécification de &quot; 1844674407370955 &quot; .</span><span class="sxs-lookup"><span data-stu-id="9926d-126">An empty string is the same as specifying &quot;1844674407370955&quot;.</span></span><br/> <span data-ttu-id="9926d-127">La valeur par défaut est une chaîne vide.</span><span class="sxs-lookup"><span data-stu-id="9926d-127">Default value is an empty string.</span></span><br/>
<blockquote>
[!Note]<br />
<span data-ttu-id="9926d-128">Dans IIS 7, la limite de téléchargement par défaut est de 30 millions octets.</span><span class="sxs-lookup"><span data-stu-id="9926d-128">In IIS 7, the default upload limit is 30 million bytes.</span></span> <span data-ttu-id="9926d-129">La valeur de la propriété <strong>BITSMaximumUploadSize</strong> ne peut pas dépasser la limite d’IIS.</span><span class="sxs-lookup"><span data-stu-id="9926d-129">The value of the <strong>BITSMaximumUploadSize</strong> property cannot exceed the IIS limit.</span></span> <span data-ttu-id="9926d-130">Pour plus d’informations sur la modification de la valeur par défaut IIS, consultez <a href="https://support.microsoft.com//kb/942074">KB942074</a>.</span><span class="sxs-lookup"><span data-stu-id="9926d-130">For details and information on changing the IIS default, see <a href="https://support.microsoft.com//kb/942074">KB942074</a>.</span></span>
</blockquote>
<br/> <br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="9926d-131"><strong>BITSServerNotificationType</strong> Type de données : <strong>DWORD</strong></span><span class="sxs-lookup"><span data-stu-id="9926d-131"><strong>BITSServerNotificationType</strong>Data type: <strong>DWORD</strong></span></span><br/></td>
<td><span data-ttu-id="9926d-132">Spécifie comment envoyer le fichier de téléchargement à l’application serveur.</span><span class="sxs-lookup"><span data-stu-id="9926d-132">Specifies how to send the upload file to the server application.</span></span> <span data-ttu-id="9926d-133">Les valeurs possibles sont les suivantes : 0, 1 et 2.</span><span class="sxs-lookup"><span data-stu-id="9926d-133">The possible values are: 0, 1, and 2.</span></span><br/> <span data-ttu-id="9926d-134">La valeur 0 signifie que le fichier n’est pas envoyé à l’application serveur.</span><span class="sxs-lookup"><span data-stu-id="9926d-134">A value of 0 means the file is not sent to the server application.</span></span> <span data-ttu-id="9926d-135">Le service BITS place le fichier de téléchargement dans le répertoire spécifié dans le nom distant (le nom distant spécifié quand vous avez <a href="/windows/win32/api/bits/nf-bits-ibackgroundcopyjob-addfile">ajouté le fichier</a> au travail) sans en avertir l’application serveur.</span><span class="sxs-lookup"><span data-stu-id="9926d-135">BITS puts the upload file in the directory specified in the remote name (the remote name specified when you <a href="/windows/win32/api/bits/nf-bits-ibackgroundcopyjob-addfile">added the file</a> to the job) without notifying the server application.</span></span> <span data-ttu-id="9926d-136">Si le fichier existe actuellement dans le répertoire de destination, il est remplacé par le fichier de téléchargement.</span><span class="sxs-lookup"><span data-stu-id="9926d-136">If the file currently exists in the destination directory, it is replaced with the upload file.</span></span><br/> <span data-ttu-id="9926d-137">La valeur 1 signifie que le service BITS passe l’emplacement du fichier de téléchargement à l’application serveur spécifiée dans la propriété <strong>BITSServerNotificationURL</strong> .</span><span class="sxs-lookup"><span data-stu-id="9926d-137">A value of 1 means BITS passes the location of the upload file to the server application specified in the <strong>BITSServerNotificationURL</strong> property.</span></span> <span data-ttu-id="9926d-138">L’application serveur traite le fichier et génère un fichier de réponse, si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="9926d-138">The server application processes the file and generates a reply file, if needed.</span></span> <span data-ttu-id="9926d-139">Par défaut, le service BITS supprime les fichiers de chargement et de réponse du serveur après avoir reçu la réponse de l’application serveur.</span><span class="sxs-lookup"><span data-stu-id="9926d-139">By default, BITS removes the upload and reply files from the server after it receives the response from the server application.</span></span> <span data-ttu-id="9926d-140">Pour que le service BITS copie le fichier de téléchargement à l’emplacement spécifié par le nom de fichier distant dans le travail, incluez l’en-tête <a href="/windows/win32/bits/notification-protocol-for-server-applications">bits-Copy-file-to-destination</a> dans votre réponse.</span><span class="sxs-lookup"><span data-stu-id="9926d-140">To have BITS copy the upload file to the location specified by the remote file name in the job, include the <a href="/windows/win32/bits/notification-protocol-for-server-applications">BITS-Copy-File-To-Destination</a> header in your response.</span></span> <span data-ttu-id="9926d-141">Si vous n’incluez pas l’en-tête et que vous souhaitez enregistrer les fichiers de téléchargement et de réponse, vous devez copier les fichiers de chargement et de réponse dans un nouvel emplacement avant de répondre.</span><span class="sxs-lookup"><span data-stu-id="9926d-141">If you do not include the header and you want to save the upload and reply files, you must copy the upload and reply files to a new location before responding.</span></span><br/> <span data-ttu-id="9926d-142">La valeur 2 signifie que le service BITS passe le fichier de téléchargement dans le corps de la requête à l’application serveur spécifiée dans la propriété <strong>BITSServerNotificationURL</strong> .</span><span class="sxs-lookup"><span data-stu-id="9926d-142">A value of 2 means BITS passes the upload file in the body of the request to the server application specified in the <strong>BITSServerNotificationURL</strong> property.</span></span> <span data-ttu-id="9926d-143">L’application serveur traite le fichier et transmet la réponse dans le corps de la réponse, si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="9926d-143">The server application processes the file and passes back the reply in the body of the response, if needed.</span></span><br/> <span data-ttu-id="9926d-144">Pour plus d’informations sur les en-têtes de demande et de réponse, consultez <a href="/windows/win32/bits/notification-protocol-for-server-applications">protocole de notification pour les applications serveur</a>.</span><span class="sxs-lookup"><span data-stu-id="9926d-144">For details on the request and response headers, see <a href="/windows/win32/bits/notification-protocol-for-server-applications">Notification Protocol for Server Applications</a>.</span></span><br/> <span data-ttu-id="9926d-145">L’application serveur doit fournir une réponse dans un délai de cinq minutes.</span><span class="sxs-lookup"><span data-stu-id="9926d-145">The server application must provide a response within five minutes.</span></span> <span data-ttu-id="9926d-146">Si l’application serveur ne répond pas dans les cinq minutes, le travail passe à l’état d’erreur temporaire.</span><span class="sxs-lookup"><span data-stu-id="9926d-146">If the server application does not reply within five minutes, the job enters the transient error state.</span></span> <span data-ttu-id="9926d-147">Lorsque le <a href="/windows/win32/api/bits/nf-bits-ibackgroundcopyjob-setminimumretrydelay"><strong>délai</strong></a> entre deux tentatives expire, le serveur bits envoie une autre notification à l’application serveur (l’application serveur doit être écrite pour gérer les notifications dupliquées). <strong>BITS 1,5 :</strong> Le délai d’attente de la notification est de 30 secondes.</span><span class="sxs-lookup"><span data-stu-id="9926d-147">When the <a href="/windows/win32/api/bits/nf-bits-ibackgroundcopyjob-setminimumretrydelay"><strong>retry delay</strong></a> expires, the BITS server will send another notification to the server application (the server application should be written to handle duplicate notifications).<strong>BITS 1.5:</strong> The notification time-out is 30 seconds.</span></span><br/> <br/> <span data-ttu-id="9926d-148">La valeur par défaut est 0.</span><span class="sxs-lookup"><span data-stu-id="9926d-148">Default value is 0.</span></span><br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="9926d-149"><strong>BITSServerNotificationURL</strong> Type de données : <strong>chaîne</strong></span><span class="sxs-lookup"><span data-stu-id="9926d-149"><strong>BITSServerNotificationURL</strong>Data type: <strong>String</strong></span></span><br/></td>
<td><span data-ttu-id="9926d-150">Optionnel.</span><span class="sxs-lookup"><span data-stu-id="9926d-150">Optional.</span></span> <span data-ttu-id="9926d-151">Contient l’URL de l’application serveur vers laquelle BITS publie le fichier de téléchargement.</span><span class="sxs-lookup"><span data-stu-id="9926d-151">Contains the URL of the server application to which BITS posts the upload file.</span></span> <span data-ttu-id="9926d-152">Vous devez spécifier une URL si la valeur de la propriété <strong>BITSServerNotificationType</strong> est 1 ou 2.</span><span class="sxs-lookup"><span data-stu-id="9926d-152">You must specify a URL if the value of the <strong>BITSServerNotificationType</strong> property is 1 or 2.</span></span> <span data-ttu-id="9926d-153">L’URL est limitée à 2 200 caractères, à l’exclusion de la marque de fin null.</span><span class="sxs-lookup"><span data-stu-id="9926d-153">The URL is limited to 2,200 characters, not including the null terminator.</span></span> <span data-ttu-id="9926d-154">L’URL doit être une URL HTTP ; BITS ne prend pas en charge les URL de notification HTTPs.</span><span class="sxs-lookup"><span data-stu-id="9926d-154">The URL must be an HTTP URL; BITS does not support HTTPS notification URLs.</span></span><br/> <span data-ttu-id="9926d-155">Si l’URL n’est pas disponible au moment du chargement, le service BITS tente à nouveau le téléchargement jusqu’à ce que l’URL de notification existe ou que la période de nouvelle tentative expire.</span><span class="sxs-lookup"><span data-stu-id="9926d-155">If the URL is not available at the time of upload, BITS will retry the upload until the notification URL exists or until the retry period expires.</span></span><br/> <span data-ttu-id="9926d-156">Notez que si le nom distant spécifié dans le travail contient une chaîne de requête, la chaîne de requête est ajoutée à l’URL que vous spécifiez.</span><span class="sxs-lookup"><span data-stu-id="9926d-156">Note that if the remote name specified in the job contains a query string, the query string is appended to the URL that you specify.</span></span> <span data-ttu-id="9926d-157">Par exemple, si le nom distant contient https://myserver/myvdir/subdir/file.asp?ACCOUNT=86433 et que vous spécifiez le paramètre <strong>BITSServerNotificationURL</strong> comme https://otherserver/myvdir2/bag.asp , l’URL vers laquelle bits est publié est https://otherserver/myvdir2/bag.asp?ACCOUNT=86433 .</span><span class="sxs-lookup"><span data-stu-id="9926d-157">For example, if the remote name contains https://myserver/myvdir/subdir/file.asp?ACCOUNT=86433 and you specify the <strong>BITSServerNotificationURL</strong> setting as https://otherserver/myvdir2/bag.asp, the URL to which BITS posts is https://otherserver/myvdir2/bag.asp?ACCOUNT=86433.</span></span><br/> <span data-ttu-id="9926d-158">Si l’URL d’origine est https://myserver/myvdir/file.txt et que l’URL de notification est myasp. asp, bits utilise http//MyServer/myvdir/myasp. asp comme URL de notification.</span><span class="sxs-lookup"><span data-stu-id="9926d-158">If the original URL is https://myserver/myvdir/file.txt and the notification URL is myasp.asp, BITS uses http//myserver/myvdir/myasp.asp as the notification URL.</span></span><br/> <span data-ttu-id="9926d-159">Si la partie du chemin d’accès et du nom de fichier de l’URL contient des caractères Unicode qui ne sont pas en commun à la page de codes sur le client et le serveur, la traduction d’URL échoue sur le serveur et le travail BITS est placé dans l’état d’erreur.</span><span class="sxs-lookup"><span data-stu-id="9926d-159">If the path and file name portion of the URL contains Unicode characters not in common to the code page on both the client and server, the URL translation will fail on the server and the BITS job will be placed in the error state.</span></span> <span data-ttu-id="9926d-160">Si la partie serveur de l’URL contient des caractères Unicode, vous devez encoder la partie serveur à l’aide de <a href="/windows/win32/intl/handling-internationalized-domain-names--idns">noms de domaine internationaux</a> (IDN).</span><span class="sxs-lookup"><span data-stu-id="9926d-160">If the server portion of the URL contains Unicode characters, you must encode the server portion using <a href="/windows/win32/intl/handling-internationalized-domain-names--idns">Internationalized Domain Names</a> (IDN).</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="9926d-161"><strong>BITSHostId</strong> Type de données : <strong>chaîne</strong></span><span class="sxs-lookup"><span data-stu-id="9926d-161"><strong>BITSHostId</strong>Data Type: <strong>String</strong></span></span><br/></td>
<td><span data-ttu-id="9926d-162">Définissez cette propriété si l’installation du serveur est une batterie de serveurs Web qui n’utilise pas de stockage partagé.</span><span class="sxs-lookup"><span data-stu-id="9926d-162">Set this property if the server installation is a web farm that does not use shared storage.</span></span><br/> <span data-ttu-id="9926d-163">Spécifiez le nom du serveur ou l’adresse IP du serveur auquel se reconnecter une fois le processus de téléchargement interrompu.</span><span class="sxs-lookup"><span data-stu-id="9926d-163">Specify the server name or IP address of the server to reconnect to after the upload process is interrupted.</span></span> <span data-ttu-id="9926d-164">En règle générale, vous spécifiez le nom du serveur que vous configurez.</span><span class="sxs-lookup"><span data-stu-id="9926d-164">Typically, you specify the name of the server you are configuring.</span></span> <span data-ttu-id="9926d-165">L’URL est limitée à 300 caractères, à l’exclusion de la marque de fin null.</span><span class="sxs-lookup"><span data-stu-id="9926d-165">The URL is limited to 300 characters, not including the null terminator.</span></span><br/> <span data-ttu-id="9926d-166">Si vous ne spécifiez pas cette propriété et que le processus de téléchargement est interrompu, il est possible que le service BITS reprenne le travail sur un autre serveur de la batterie.</span><span class="sxs-lookup"><span data-stu-id="9926d-166">If you do not specify this property and the upload process is interrupted, it is possible that BITS will resume the job on another server in the farm.</span></span> <span data-ttu-id="9926d-167">Toutefois, le serveur précédent contient toujours le fichier de téléchargement partiel avant l’interruption.</span><span class="sxs-lookup"><span data-stu-id="9926d-167">However, the previous server still contains the partial upload file from before the interruption.</span></span> <span data-ttu-id="9926d-168">BITS supprime le fichier partiel après l’expiration du <strong>BITSSessionTimeout</strong> .</span><span class="sxs-lookup"><span data-stu-id="9926d-168">BITS removes the partial file after the <strong>BITSSessionTimeout</strong> expires.</span></span><br/>
<blockquote>
[!Note]<br />
<span data-ttu-id="9926d-169">N’utilisez pas la propriété <strong>BITSHostId</strong> si le protocole SSL est utilisé dans une batterie de serveurs Web qui utilise l’équilibrage de charge réseau (NLB) ou les noms DNS avec plusieurs adresses IP, sauf si vous incluez le nom du cluster et des noms de serveurs individuels dans le certificat.</span><span class="sxs-lookup"><span data-stu-id="9926d-169">Do not use the <strong>BITSHostId</strong> property if SSL is used in a web farm that uses Network Load Balancing (NLB) or DNS names with multiple IP addresses, unless you include the cluster name and individual server names in the certificate.</span></span> <span data-ttu-id="9926d-170">(Si le nom du serveur spécifié dans <strong>BITSHostId</strong> ne correspond pas au nom commun du certificat, le travail échoue.) Au lieu de cela, pour l’équilibrage de la charge réseau, affectez la valeur <strong>Single</strong> au paramètre <a href="/previous-versions/tn-archive/bb687542(v=technet.10)">Affinity</a> pour vous assurer que le client communique avec le même serveur à l’avenir.</span><span class="sxs-lookup"><span data-stu-id="9926d-170">(If the server name specified in <strong>BITSHostId</strong> does not match the common name on the certificate, the job will fail.) Instead, for NLB, set the <a href="/previous-versions/tn-archive/bb687542(v=technet.10)">Affinity</a> parameter to <strong>Single</strong> to ensure that the client communicates with the same server in the future.</span></span>
</blockquote>
<br/> <br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="9926d-171"><strong>BITSHostIdFallbackTimeout</strong> Type de données : <strong>DWORD</strong></span><span class="sxs-lookup"><span data-stu-id="9926d-171"><strong>BITSHostIdFallbackTimeout</strong>Data type: <strong>DWORD</strong></span></span><br/></td>
<td><span data-ttu-id="9926d-172">Nombre de secondes pendant lesquelles le client BITS tente de se reconnecter au nom du serveur <strong>BITSHostId</strong> avant de revenir au nom d’hôte spécifié dans le nom de fichier distant du travail.</span><span class="sxs-lookup"><span data-stu-id="9926d-172">Number of seconds the BITS client tries to reconnect to the <strong>BITSHostId</strong> server name before reverting to the host name specified in the remote file name of the job.</span></span> <span data-ttu-id="9926d-173">La minuterie commence lorsque le service BITS ne parvient pas à se connecter au serveur <strong>BITSHostId</strong> .</span><span class="sxs-lookup"><span data-stu-id="9926d-173">The timer begins when BITS is unable to connect to the <strong>BITSHostId</strong> server.</span></span> <span data-ttu-id="9926d-174">La minuterie est réinitialisée lorsque le client se connecte correctement au serveur.</span><span class="sxs-lookup"><span data-stu-id="9926d-174">The timer is reset when the client successfully connects to the server.</span></span><br/> <span data-ttu-id="9926d-175">Notez que la valeur du délai d’attente de non-progression du travail (consultez <a href="/windows/win32/api/bits/nf-bits-ibackgroundcopyjob-setnoprogresstimeout"><strong>méthode ibackgroundcopyjob :: SetNoProgressTimeout</strong></a>) doit être supérieure à cette valeur de délai d’attente.</span><span class="sxs-lookup"><span data-stu-id="9926d-175">Note that the no progress timeout value of the job (see <a href="/windows/win32/api/bits/nf-bits-ibackgroundcopyjob-setnoprogresstimeout"><strong>IBackgroundCopyJob::SetNoProgressTimeout</strong></a>) should be longer than this timeout value.</span></span> <span data-ttu-id="9926d-176">Si ce n’est pas le cas, le travail échoue avant l’expiration de la valeur du délai d’attente de secours.</span><span class="sxs-lookup"><span data-stu-id="9926d-176">If not, the job will fail before fallback timeout value expires.</span></span><br/> <span data-ttu-id="9926d-177">Définissez cette propriété uniquement si vous définissez la propriété <strong>BITSHostId</strong> .</span><span class="sxs-lookup"><span data-stu-id="9926d-177">Set this property only if you set the <strong>BITSHostId</strong> property.</span></span><br/> <span data-ttu-id="9926d-178">La valeur par défaut est 86 400 (1 jour).</span><span class="sxs-lookup"><span data-stu-id="9926d-178">Default value is 86,400 (1 day).</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="9926d-179"><strong>BITSAllowOverwrites</strong> Type de données : <strong>entier</strong></span><span class="sxs-lookup"><span data-stu-id="9926d-179"><strong>BITSAllowOverwrites</strong>Data type: <strong>Integer</strong></span></span><br/></td>
<td><span data-ttu-id="9926d-180">Indique si un fichier de téléchargement peut remplacer un fichier existant portant le même nom.</span><span class="sxs-lookup"><span data-stu-id="9926d-180">Indicates whether an upload file can overwrite an existing file with the same name.</span></span> <span data-ttu-id="9926d-181">Le fichier de chargement remplace le fichier existant si <strong>BITSAllowOverwrites</strong> est 1.</span><span class="sxs-lookup"><span data-stu-id="9926d-181">The upload file overwrites the existing file if <strong>BITSAllowOverwrites</strong> is 1.</span></span><br/> <span data-ttu-id="9926d-182">La valeur par défaut est 0.</span><span class="sxs-lookup"><span data-stu-id="9926d-182">Default value is 0.</span></span><br/> <span data-ttu-id="9926d-183"><strong>IIS 6,0 :</strong> Vous pouvez définir cette propriété uniquement à partir d’un script, vous ne pouvez pas la définir à l’aide de la page Propriétés de l’extension BITS dans l’interface utilisateur IIS.</span><span class="sxs-lookup"><span data-stu-id="9926d-183"><strong>IIS 6.0:</strong> You can set this property only from a script, you cannot set it using the BITS extension properties page in the IIS user interface.</span></span><br/> <br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="9926d-184"><strong>BITSCleanupUseDefault</strong> Type de données : <strong>booléen</strong></span><span class="sxs-lookup"><span data-stu-id="9926d-184"><strong>BITSCleanupUseDefault</strong>Data type: <strong>Boolean</strong></span></span><br/></td>
<td><span data-ttu-id="9926d-185">Indique si la tâche de nettoyage utilise les planifications par défaut.</span><span class="sxs-lookup"><span data-stu-id="9926d-185">Indicates whether the cleanup task uses the default schedules.</span></span> <span data-ttu-id="9926d-186">Par défaut, la tâche de nettoyage est exécutée toutes les 12 heures.</span><span class="sxs-lookup"><span data-stu-id="9926d-186">By default, the cleanup task is run every 12 hours.</span></span><br/> <span data-ttu-id="9926d-187">Définir sur 1 pour utiliser la planification par défaut ; dans le cas contraire, 0 pour spécifier une planification.</span><span class="sxs-lookup"><span data-stu-id="9926d-187">Set to 1 to use the default schedule; otherwise, 0 to specify a schedule.</span></span><br/> <span data-ttu-id="9926d-188">Pour spécifier une planification, utilisez les propriétés <strong>BITSCleanupCount</strong> et <strong>BITSCleanupUnits</strong> .</span><span class="sxs-lookup"><span data-stu-id="9926d-188">To specify a schedule, use the <strong>BITSCleanupCount</strong> and <strong>BITSCleanupUnits</strong> properties.</span></span><br/> <span data-ttu-id="9926d-189">La tâche de nettoyage nettoie le répertoire virtuel en supprimant les travaux qui n’ont pas été modifiés au cours du délai d’attente de la session (voir <strong>BITSSessionTimeout</strong>).</span><span class="sxs-lookup"><span data-stu-id="9926d-189">The cleanup task cleans up the virtual directory by deleting jobs that have not been modified within the session time-out period (see <strong>BITSSessionTimeout</strong>).</span></span><br/> <span data-ttu-id="9926d-190">La valeur par défaut est 1 utiliser la planification par défaut.</span><span class="sxs-lookup"><span data-stu-id="9926d-190">The default is 1 use the default schedule.</span></span><br/> <span data-ttu-id="9926d-191"><strong>IIS 6,0 :</strong> Non pris en charge.</span><span class="sxs-lookup"><span data-stu-id="9926d-191"><strong>IIS 6.0:</strong> Not supported.</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="9926d-192"><strong>BITSCleanupCount</strong> Type de données : <strong>entier</strong></span><span class="sxs-lookup"><span data-stu-id="9926d-192"><strong>BITSCleanupCount</strong>Data type: <strong>Integer</strong></span></span><br/></td>
<td><span data-ttu-id="9926d-193">Spécifie l’intervalle d’attente entre l’exécution de la tâche de nettoyage.</span><span class="sxs-lookup"><span data-stu-id="9926d-193">Specifies the interval to wait between running the cleanup task.</span></span> <span data-ttu-id="9926d-194">L’intervalle que vous pouvez spécifier dépend des unités.</span><span class="sxs-lookup"><span data-stu-id="9926d-194">The interval that you can specify depends on the units.</span></span> <span data-ttu-id="9926d-195">Pour connaître les valeurs d’intervalle possibles, consultez la propriété <strong>BITSCleanupUnits</strong> .</span><span class="sxs-lookup"><span data-stu-id="9926d-195">For possible interval values, see the <strong>BITSCleanupUnits</strong> property.</span></span><br/> <span data-ttu-id="9926d-196">Cette propriété est ignorée si <strong>BITSCleanupUseDefault</strong> est égal à 0.</span><span class="sxs-lookup"><span data-stu-id="9926d-196">This property is ignored if <strong>BITSCleanupUseDefault</strong> is 0.</span></span><br/> <span data-ttu-id="9926d-197"><strong>IIS 6,0 :</strong> Non pris en charge.</span><span class="sxs-lookup"><span data-stu-id="9926d-197"><strong>IIS 6.0:</strong> Not supported.</span></span><br/> <br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="9926d-198"><strong>BITSCleanupUnits</strong> Type de données : <strong>entier</strong></span><span class="sxs-lookup"><span data-stu-id="9926d-198"><strong>BITSCleanupUnits</strong>Data type: <strong>Integer</strong></span></span><br/></td>
<td><span data-ttu-id="9926d-199">Spécifie les unités pour l’intervalle de nettoyage spécifié dans la propriété <strong>BITSCleanupCount</strong> .</span><span class="sxs-lookup"><span data-stu-id="9926d-199">Specifies the units for the cleanup interval specified in the <strong>BITSCleanupCount</strong> property.</span></span> <span data-ttu-id="9926d-200">Cette propriété est ignorée si <strong>BITSCleanupUseDefault</strong> est égal à 0.</span><span class="sxs-lookup"><span data-stu-id="9926d-200">This property is ignored if <strong>BITSCleanupUseDefault</strong> is 0.</span></span><br/> <span data-ttu-id="9926d-201">Les valeurs possibles sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="9926d-201">The possible values are:</span></span><dl> <span data-ttu-id="9926d-202">0 : les unités sont des minutes.</span><span class="sxs-lookup"><span data-stu-id="9926d-202">0: The units are minutes.</span></span> <span data-ttu-id="9926d-203">Les valeurs possibles sont comprises entre 1 et 60.</span><span class="sxs-lookup"><span data-stu-id="9926d-203">Possible values are 1 to 60.</span></span><br />
<span data-ttu-id="9926d-204">1 : les unités sont des heures.</span><span class="sxs-lookup"><span data-stu-id="9926d-204">1: The units are hours.</span></span> <span data-ttu-id="9926d-205">Il s’agit de la valeur par défaut.</span><span class="sxs-lookup"><span data-stu-id="9926d-205">This is the default.</span></span> <span data-ttu-id="9926d-206">Les valeurs possibles sont comprises entre 1 et 24.</span><span class="sxs-lookup"><span data-stu-id="9926d-206">Possible values are 1 to 24.</span></span><br />
<span data-ttu-id="9926d-207">2 : les unités sont des jours.</span><span class="sxs-lookup"><span data-stu-id="9926d-207">2: The units are days.</span></span> <span data-ttu-id="9926d-208">Les valeurs possibles sont comprises entre 1 et 360.</span><span class="sxs-lookup"><span data-stu-id="9926d-208">Possible values are 1 to 360.</span></span><br />
</dl> <br/> <span data-ttu-id="9926d-209"><strong>IIS 6,0 :</strong> Non pris en charge.</span><span class="sxs-lookup"><span data-stu-id="9926d-209"><strong>IIS 6.0:</strong> Not supported.</span></span><br/> <br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="9926d-210"><strong>BITSNumberOfSessionsLimit</strong> Type de données : <strong>entier</strong></span><span class="sxs-lookup"><span data-stu-id="9926d-210"><strong>BITSNumberOfSessionsLimit</strong>Data type: <strong>Integer</strong></span></span><br/></td>
<td><span data-ttu-id="9926d-211">Limite le nombre de sessions de téléchargement pouvant exister simultanément pour un utilisateur.</span><span class="sxs-lookup"><span data-stu-id="9926d-211">Limits the number of upload sessions that can exist concurrently for a user.</span></span> <span data-ttu-id="9926d-212">Si le nombre de sessions d’un utilisateur dépasse cette limite, lorsque la tâche de nettoyage s’exécute, elle supprime les sessions les plus récentes jusqu’à ce que le nombre de sessions pour l’utilisateur soit inférieur à la limite.</span><span class="sxs-lookup"><span data-stu-id="9926d-212">If the number of sessions for a user is more than this limit, when the cleanup task runs it will delete the most recent sessions until the number of sessions for the user is below the limit.</span></span><br/> <span data-ttu-id="9926d-213">La valeur par défaut est 50 sessions.</span><span class="sxs-lookup"><span data-stu-id="9926d-213">The default is 50 sessions.</span></span><br/> <span data-ttu-id="9926d-214"><strong>IIS 6,0 :</strong> Non pris en charge.</span><span class="sxs-lookup"><span data-stu-id="9926d-214"><strong>IIS 6.0:</strong> Not supported.</span></span><br/> <br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="9926d-215"><strong>BITSSessionLimitEnable</strong> Type de données : <strong>booléen</strong></span><span class="sxs-lookup"><span data-stu-id="9926d-215"><strong>BITSSessionLimitEnable</strong>Data type: <strong>Boolean</strong></span></span><br/></td>
<td><span data-ttu-id="9926d-216">Indique si BITS limite le nombre de sessions de téléchargement par utilisateur.</span><span class="sxs-lookup"><span data-stu-id="9926d-216">Indicates whether BITS limits the number of upload sessions per user.</span></span> <span data-ttu-id="9926d-217">Si le paramètre n’est pas présent ou s’il est égal à 0, la limite est désactivée.</span><span class="sxs-lookup"><span data-stu-id="9926d-217">If the setting is not present or is 0, the limit is disabled.</span></span><br/> <span data-ttu-id="9926d-218">Pour spécifier la limite, définissez la propriété <strong>BITSNumberOfSessionsLimit</strong> .</span><span class="sxs-lookup"><span data-stu-id="9926d-218">To specify the limit, set the <strong>BITSNumberOfSessionsLimit</strong> property.</span></span><br/> <span data-ttu-id="9926d-219">La valeur par défaut est 1.</span><span class="sxs-lookup"><span data-stu-id="9926d-219">The default is 1.</span></span><br/> <span data-ttu-id="9926d-220"><strong>IIS 6,0 :</strong> Non pris en charge.</span><span class="sxs-lookup"><span data-stu-id="9926d-220"><strong>IIS 6.0:</strong> Not supported.</span></span><br/> <br/></td>
</tr>
</tbody>
</table>



 

<span data-ttu-id="9926d-221">L’exemple suivant montre comment définir les propriétés d’extension IIS BITS à l’aide de Windows Script Host.</span><span class="sxs-lookup"><span data-stu-id="9926d-221">The following example shows how to set the BITS IIS extension properties using Windows Script Host.</span></span> <span data-ttu-id="9926d-222">Si le répertoire virtuel pointe vers un partage distant, définissez également les propriétés IIS **UNCUserName** et **UNCPassword** .</span><span class="sxs-lookup"><span data-stu-id="9926d-222">If the virtual directory points to a remote share, also set the **UNCUserName** and **UNCPassword** IIS properties.</span></span>


```JScript
if (WScript.Arguments.length < 2)
{
    WScript.Echo("Usage: bitsvdir virtual_directory local_directory");
    WScript.Quit(1);
}

VirtualDirectoryName = WScript.Arguments(0);
LocalDirectoryName = WScript.Arguments(1);

ServerObj = GetObject("IIS://LocalHost/W3SVC/1/ROOT");
VirtualDir = ServerObj.Create("IIsWebVirtualDir", VirtualDirectoryName );

VirtualDir.Path = LocalDirectoryName;
VirtualDir.AppIsolated = 0;
VirtualDir.AccessScript = true;
VirtualDir.AccessRead = false;
VirtualDir.AccessWrite = false;
VirtualDir.SetInfo();

// Set BITS specific IIS configuration settings
VirtualDir.EnableBITSUploads();
VirtualDir.BITSMaximumUploadSize = "4294967296";
VirtualDir.SetInfo();

WScript.Echo( "Created virtual directory " + VirtualDirectoryName + 
              " with a local directory of " + LocalDirectoryName );
WScript.Quit( 0 );
```



 

