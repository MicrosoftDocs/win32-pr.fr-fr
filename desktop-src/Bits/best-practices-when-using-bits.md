---
title: Meilleures pratiques lors de l’utilisation de BITS
description: Cette section contient des informations que vous devez prendre en compte lors de la conception d’une application qui utilise BITS.
ms.assetid: f4a09a80-2a85-4b59-b0fd-c23c128973f7
ms.topic: article
ms.date: 7/12/2019
ms.openlocfilehash: bbf69e75b99994eea3e8986d1be9920ff1a12bc5
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/16/2019
ms.locfileid: "103939733"
---
# <a name="best-practices-when-using-bits"></a><span data-ttu-id="866c9-103">Meilleures pratiques lors de l’utilisation de BITS</span><span class="sxs-lookup"><span data-stu-id="866c9-103">Best Practices When Using BITS</span></span>

<span data-ttu-id="866c9-104">Cette section contient des informations que vous devez prendre en compte lors de la conception d’une application qui utilise BITS.</span><span class="sxs-lookup"><span data-stu-id="866c9-104">This section contains information you should consider when designing an application that uses BITS.</span></span>

## <a name="user-context-or-service-context"></a><span data-ttu-id="866c9-105">Contexte utilisateur ou contexte de service</span><span class="sxs-lookup"><span data-stu-id="866c9-105">User context or service context</span></span>

<span data-ttu-id="866c9-106">BITS transfère les fichiers uniquement lorsque le propriétaire du travail est connecté à l’ordinateur (l’utilisateur doit avoir ouvert une session de manière interactive).</span><span class="sxs-lookup"><span data-stu-id="866c9-106">BITS transfers files only when the job's owner is logged on to the computer (the user must have logged on interactively).</span></span> <span data-ttu-id="866c9-107">BITS ne prend pas en charge la commande **runas** .</span><span class="sxs-lookup"><span data-stu-id="866c9-107">BITS does not support the **RunAs** command.</span></span> <span data-ttu-id="866c9-108">Pour plus d’informations, consultez [utilisateurs et connexions réseau](users-and-network-connections.md).</span><span class="sxs-lookup"><span data-stu-id="866c9-108">For more details, see [Users and Network Connections](users-and-network-connections.md).</span></span>

<span data-ttu-id="866c9-109">Si vous n’avez pas besoin du contexte d’un utilisateur pour votre application, envisagez d’écrire un service qui s’exécute en tant que LocalSystem, LocalService ou NetworkService à la place.</span><span class="sxs-lookup"><span data-stu-id="866c9-109">If you do not require a user's context for your application, consider writing a service running as LocalSystem, LocalService, or NetworkService instead.</span></span> <span data-ttu-id="866c9-110">Ces comptes système étant toujours connectés, le transfert n’est pas soumis à un utilisateur qui se déconnecte.</span><span class="sxs-lookup"><span data-stu-id="866c9-110">These system accounts are always logged on, so the transfer is not subject to a user logging off.</span></span> <span data-ttu-id="866c9-111">Toutefois, si vous empruntez l’identité d’un utilisateur lors de la création du travail, les règles de connexion interactives s’appliquent.</span><span class="sxs-lookup"><span data-stu-id="866c9-111">However, if you impersonate a user when you create the job, the interactive logon rules apply.</span></span> <span data-ttu-id="866c9-112">Pour plus d’informations, consultez [comptes de service et bits](service-accounts-and-bits.md).</span><span class="sxs-lookup"><span data-stu-id="866c9-112">For more details, see [Service Accounts and BITS](service-accounts-and-bits.md).</span></span>

## <a name="jobs-are-persistent"></a><span data-ttu-id="866c9-113">Les travaux sont persistants</span><span class="sxs-lookup"><span data-stu-id="866c9-113">Jobs are persistent</span></span>

<span data-ttu-id="866c9-114">Les travaux restent dans la file d’attente jusqu’à ce que vous appeliez la méthode [**méthode ibackgroundcopyjob :: Complete**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-complete) ou [**méthode ibackgroundcopyjob :: Cancel**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-cancel) .</span><span class="sxs-lookup"><span data-stu-id="866c9-114">Jobs remain in the queue until you call the [**IBackgroundCopyJob::Complete**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-complete) or [**IBackgroundCopyJob::Cancel**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-cancel) method.</span></span> <span data-ttu-id="866c9-115">Les fichiers du travail ne sont pas accessibles à l’utilisateur tant que vous n’avez pas **terminé**.</span><span class="sxs-lookup"><span data-stu-id="866c9-115">The files in the job are not available to the user until you call **Complete**.</span></span> <span data-ttu-id="866c9-116">En règle générale, vous appelez **Complete** lorsque l’état du travail est **État du \_ travail BG \_ \_ transféré** et que vous appelez **Annuler** lorsque le travail est dans l’état d’erreur temporaire de l' **\_ État du travail \_ \_ \_ BG** ou de l' **\_ État du travail \_ \_ BG** et qu’il ne peut plus progresser.</span><span class="sxs-lookup"><span data-stu-id="866c9-116">Typically, you call **Complete** when the state of the job is **BG\_JOB\_STATE\_TRANSFERRED**, and you call **Cancel** when the job is in the **BG\_JOB\_STATE\_TRANSIENT\_ERROR** or **BG\_JOB\_STATE\_ERROR** state and can no longer make progress.</span></span>

<span data-ttu-id="866c9-117">Si vous n’appelez pas la méthode [**Complete**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-complete) ou la méthode [**Cancel**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-cancel) dans un délai de 90 jours (valeur par défaut [paramètre jobinactivitytimeout](group-policies.md) stratégie de groupe), le service annule le travail.</span><span class="sxs-lookup"><span data-stu-id="866c9-117">If you do not call the [**Complete**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-complete) method or the [**Cancel**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-cancel) method within 90 days (default [JobInactivityTimeout](group-policies.md) Group Policy), the service cancels the job.</span></span> <span data-ttu-id="866c9-118">Vous devez toujours appeler la méthode **Complete** ou **Cancel** et ne pas compter sur la stratégie paramètre jobinactivitytimeout pour nettoyer vos travaux.</span><span class="sxs-lookup"><span data-stu-id="866c9-118">You should always call the **Complete** or the **Cancel** method and not rely on the JobInactivityTimeout policy to cleanup your jobs.</span></span> <span data-ttu-id="866c9-119">Les travaux laissés dans la file d’attente peuvent empêcher les utilisateurs de créer d’autres travaux si la limite de stratégie MaxJobsPerUser ou MaxJobsPerMachine est atteinte.</span><span class="sxs-lookup"><span data-stu-id="866c9-119">Jobs left in the queue may prevent users from creating other jobs if the MaxJobsPerUser or MaxJobsPerMachine policy limit is reached.</span></span>

## <a name="when-to-use-foreground-or-background-priority"></a><span data-ttu-id="866c9-120">Quand utiliser la priorité de premier plan ou d’arrière-plan</span><span class="sxs-lookup"><span data-stu-id="866c9-120">When to use foreground or background priority</span></span>

<span data-ttu-id="866c9-121">À moins que le travail soit critique dans le temps ou que l’utilisateur attende activement, vous devez toujours utiliser une priorité d’arrière-plan.</span><span class="sxs-lookup"><span data-stu-id="866c9-121">Unless the job is time critical or the user is actively waiting, you should always use a background priority.</span></span> <span data-ttu-id="866c9-122">Toutefois, il peut arriver que vous souhaitiez passer de la priorité d’arrière-plan à la priorité de premier plan, par exemple lorsque le proxy ou le serveur ne prend pas en charge l’en-tête Content-Range, ou que le logiciel antivirus sur le client supprime la demande d’en-tête Range.</span><span class="sxs-lookup"><span data-stu-id="866c9-122">However, there are times when you may want to switch from background priority to foreground priority, for example, when the proxy or server does not support the Content-Range header, or antivirus software on the client removes the range header request.</span></span> <span data-ttu-id="866c9-123">Le passage à la priorité de premier plan fonctionne uniquement pour les fichiers dont la taille de fichier est inférieure à 2 Go.</span><span class="sxs-lookup"><span data-stu-id="866c9-123">Switching to foreground priority works only for those files whose file size is less than 2 GB.</span></span> <span data-ttu-id="866c9-124">Pour obtenir un exemple, consultez l’implémentation de la méthode [**IBackgroundCopyCallback :: JobError**](/windows/desktop/api/Bits/nn-bits-ibackgroundcopycallback) .</span><span class="sxs-lookup"><span data-stu-id="866c9-124">For an example, see the implementation for the [**IBackgroundCopyCallback::JobError**](/windows/desktop/api/Bits/nn-bits-ibackgroundcopycallback) method.</span></span> <span data-ttu-id="866c9-125">Notez également que si la tâche de premier plan est ensuite interrompue en raison d’une déconnexion du réseau ou de la fermeture de session de l’utilisateur, le travail échouera car le service BITS enverra une demande de plage pour tenter de redémarrer le transfert à partir de là où il s’était arrêté.</span><span class="sxs-lookup"><span data-stu-id="866c9-125">Also note that if the foreground job is then interrupted due to a network disconnect or the user logging off, the job will fail because BITS will send a range request to try to restart the transfer from where it left off.</span></span>

<span data-ttu-id="866c9-126">À compter de Windows 8, vous devez configurer les travaux de téléchargement avec le **\_ \_ \_ \_ contenu dynamique de propriété de travail bits** et le premier niveau de **\_ \_ priorité \_ du travail BG** lorsque vous ciblez des serveurs qui ne répondent pas aux [exigences http pour les téléchargements bits](http-requirements-for-bits-downloads.md).</span><span class="sxs-lookup"><span data-stu-id="866c9-126">Starting with Windows 8, you should configure download jobs with **BITS\_JOB\_PROPERTY\_DYNAMIC\_CONTENT** and **BG\_JOB\_PRIORITY\_FOREGROUND** when targeting servers that do not meet the [HTTP Requirements for BITS Downloads](http-requirements-for-bits-downloads.md).</span></span> <span data-ttu-id="866c9-127">Gardez à l’esprit que cela entraînera le redémarrage du téléchargement par BITS s’il est interrompu (par exemple, en raison de problèmes de connectivité ou de redémarrage du système).</span><span class="sxs-lookup"><span data-stu-id="866c9-127">Bear in mind that this will result in BITS having to restart the download from the beginning if it ever gets interrupted (for example, due to connectivity issues or system reboot).</span></span>

<span data-ttu-id="866c9-128">Pour plus d’informations sur les priorités disponibles et la façon dont le service BITS utilise le niveau de priorité pour planifier des travaux, consultez la page [**\_ \_ priorité du travail BG**](/windows/desktop/api/Bits/ne-bits-bg_job_priority).</span><span class="sxs-lookup"><span data-stu-id="866c9-128">For information on the available priorities and how BITS uses the priority level to schedule jobs, see [**BG\_JOB\_PRIORITY**](/windows/desktop/api/Bits/ne-bits-bg_job_priority).</span></span>

## <a name="transient-and-fatal-errors"></a><span data-ttu-id="866c9-129">Erreurs temporaires et irrécupérables</span><span class="sxs-lookup"><span data-stu-id="866c9-129">Transient and fatal errors</span></span>

<span data-ttu-id="866c9-130">Certaines erreurs sont récupérables et d’autres non.</span><span class="sxs-lookup"><span data-stu-id="866c9-130">Some errors are recoverable and some are not.</span></span> <span data-ttu-id="866c9-131">Par exemple, l’erreur « le serveur n’est pas disponible » est une erreur récupérable et l’erreur « Accès refusé » est une erreur irrécupérable.</span><span class="sxs-lookup"><span data-stu-id="866c9-131">For example, the error "Server is Unavailable" is a recoverable error, and the error "Access Denied" is a fatal error.</span></span> <span data-ttu-id="866c9-132">BITS place les erreurs récupérables dans un état d’erreur temporaire et tente à nouveau la tâche après un intervalle spécifié.</span><span class="sxs-lookup"><span data-stu-id="866c9-132">BITS puts recoverable errors in a transient error state and tries the job again after a specified interval.</span></span> <span data-ttu-id="866c9-133">Si le travail ne parvient pas à progresser, le service BITS déplace la tâche vers un état d’erreur irrécupérable.</span><span class="sxs-lookup"><span data-stu-id="866c9-133">If the job is unable to make progress, BITS moves the job to a fatal error state.</span></span> <span data-ttu-id="866c9-134">Utilisez les méthodes [**méthode ibackgroundcopyjob :: SetMinimumRetryDelay**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-setminimumretrydelay) et [**méthode ibackgroundcopyjob :: SetNoProgressTimeout**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-setnoprogresstimeout) pour contrôler la façon dont bits traite les erreurs temporaires.</span><span class="sxs-lookup"><span data-stu-id="866c9-134">Use the [**IBackgroundCopyJob::SetMinimumRetryDelay**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-setminimumretrydelay) and [**IBackgroundCopyJob::SetNoProgressTimeout**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-setnoprogresstimeout) methods to control how BITS processes transient errors.</span></span>

<span data-ttu-id="866c9-135">Pour les tâches de premier plan, vous devez limiter la durée pendant laquelle vous laissez un travail dans l’état d’erreur temporaire et essayez de récupérer.</span><span class="sxs-lookup"><span data-stu-id="866c9-135">For foreground jobs, you should limit the amount of time you let a job stay in the transient error state and try to recover.</span></span> <span data-ttu-id="866c9-136">Utilisez la méthode [**SetNoProgressTimeout**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-setnoprogresstimeout) pour limiter la durée pendant laquelle un travail reste dans un état d’erreur temporaire ou pour forcer le travail dans l’état d’erreur irrécupérable.</span><span class="sxs-lookup"><span data-stu-id="866c9-136">Use the [**SetNoProgressTimeout**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-setnoprogresstimeout) method to limit the amount of time a job stays in the transient error state or to force the job into the fatal error state.</span></span> <span data-ttu-id="866c9-137">Si vous laissez la tâche essayer de récupérer, vous devez utiliser la méthode [**SetMinimumRetryDelay**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-setminimumretrydelay) pour définir le délai minimal entre deux tentatives sur 60 secondes ou appeler la méthode [**méthode ibackgroundcopyjob :: Resume**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-resume) pour réactiver la tâche.</span><span class="sxs-lookup"><span data-stu-id="866c9-137">If you let the job try to recover, you should use the [**SetMinimumRetryDelay**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-setminimumretrydelay) method to set the minimum retry delay to 60 seconds or call the [**IBackgroundCopyJob::Resume**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-resume) method to activate the job again.</span></span>

<span data-ttu-id="866c9-138">Pour plus d’informations, [**consultez \_ \_ État de la tâche BG**](/windows/desktop/api/Bits/ne-bits-bg_job_state), [cycle de vie d’une tâche bits](life-cycle-of-a-bits-job.md)et [gestion des erreurs](handling-errors.md).</span><span class="sxs-lookup"><span data-stu-id="866c9-138">For more information, see [**BG\_JOB\_STATE**](/windows/desktop/api/Bits/ne-bits-bg_job_state), [Life Cycle of a BITS Job](life-cycle-of-a-bits-job.md), and [Handling Errors](handling-errors.md).</span></span>

## <a name="measuring-network-bandwidth-usage"></a><span data-ttu-id="866c9-139">Mesure de l’utilisation de la bande passante réseau</span><span class="sxs-lookup"><span data-stu-id="866c9-139">Measuring network bandwidth usage</span></span>

<span data-ttu-id="866c9-140">BITS peut utiliser la carte réseau du client pour estimer la bande passante réseau disponible.</span><span class="sxs-lookup"><span data-stu-id="866c9-140">BITS might use the client's network adapter to estimate available network bandwidth.</span></span> <span data-ttu-id="866c9-141">Étant donné que le service BITS n’est pas en mesure de mesurer la bande passante au-delà du client, BITS peut encombrer la liaison WAN.</span><span class="sxs-lookup"><span data-stu-id="866c9-141">Because BITS is not able to measure bandwidth beyond the client, BITS may congest the WAN link.</span></span> <span data-ttu-id="866c9-142">Pour réduire l’encombrement sur la liaison de réseau étendu (WAN), vous pouvez utiliser la stratégie de groupe **MaxInternetBandwidth** pour limiter la quantité de bande passante utilisée par le client.</span><span class="sxs-lookup"><span data-stu-id="866c9-142">To reduce congestion on the WAN link, you can use the **MaxInternetBandwidth** group policy to limit the amount of bandwidth that the client uses.</span></span> <span data-ttu-id="866c9-143">Pour plus d’informations, consultez [bande passante réseau](network-bandwidth.md) et [stratégies de groupe](group-policies.md).</span><span class="sxs-lookup"><span data-stu-id="866c9-143">For more information, see [Network Bandwidth](network-bandwidth.md) and [Group Policies](group-policies.md).</span></span>

<span data-ttu-id="866c9-144">Si vous écrivez une application que de nombreux clients utiliseront pour télécharger des fichiers à partir d’un serveur donné, vous devez envisager un modèle qui étale les demandes de téléchargement afin de ne pas surcharger le serveur avec les demandes.</span><span class="sxs-lookup"><span data-stu-id="866c9-144">If you are writing an application that many clients will use to download files from a given server, you should consider a scheme that staggers the download requests so you do not overload the server with requests.</span></span>

## <a name="setting-credentials-for-proxy-and-server-authentication"></a><span data-ttu-id="866c9-145">Définition des informations d’identification pour l’authentification du proxy et du serveur</span><span class="sxs-lookup"><span data-stu-id="866c9-145">Setting credentials for proxy and server authentication</span></span>

<span data-ttu-id="866c9-146">Si vous vous attendez à ce que le proxy ou le serveur requière des informations d’identification de l’utilisateur, vous devez fournir les informations d’identification au service BITS.</span><span class="sxs-lookup"><span data-stu-id="866c9-146">If you expect the proxy or server to require user credentials, you must provide the credentials to BITS.</span></span> <span data-ttu-id="866c9-147">Pour spécifier les informations d’identification, appelez la méthode [**IBackgroundCopyJob2 :: SetCredentials**](/windows/desktop/api/Bits1_5/nf-bits1_5-ibackgroundcopyjob2-setcredentials) .</span><span class="sxs-lookup"><span data-stu-id="866c9-147">To specify the credentials, call the [**IBackgroundCopyJob2::SetCredentials**](/windows/desktop/api/Bits1_5/nf-bits1_5-ibackgroundcopyjob2-setcredentials) method.</span></span> <span data-ttu-id="866c9-148">BITS prend en charge les schémas d’authentification de base, Digest, Negotiate, NTLM et Passport.</span><span class="sxs-lookup"><span data-stu-id="866c9-148">BITS supports Basic, Digest, Negotiate, NTLM, and Passport authentication schemes.</span></span>

<span data-ttu-id="866c9-149">Pour plus d’informations sur l’authentification, consultez [authentification](authentication.md).</span><span class="sxs-lookup"><span data-stu-id="866c9-149">For details on authentication, see [Authentication](authentication.md).</span></span>

## <a name="specifying-proxy-settings-for-user-accounts-and-service-accounts"></a><span data-ttu-id="866c9-150">Spécification des paramètres de proxy pour les comptes d’utilisateur et les comptes de service</span><span class="sxs-lookup"><span data-stu-id="866c9-150">Specifying proxy settings for user accounts and service accounts</span></span>

<span data-ttu-id="866c9-151">Par défaut, le service BITS utilise les paramètres de proxy d’Internet Explorer de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="866c9-151">By default, BITS uses the user's Internet Explorer proxy settings.</span></span> <span data-ttu-id="866c9-152">Pour remplacer les paramètres de proxy d’Internet Explorer de l’utilisateur, appelez la méthode [**méthode ibackgroundcopyjob :: setproxysettings n'**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-setproxysettings) .</span><span class="sxs-lookup"><span data-stu-id="866c9-152">To override the user's Internet Explorer proxy settings, call the [**IBackgroundCopyJob::SetProxySettings**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-setproxysettings) method.</span></span>

<span data-ttu-id="866c9-153">Les paramètres de proxy d’Internet Explorer ne s’appliquent pas aux comptes système. par conséquent, le comportement du proxy par défaut (**\_ \_ \_ \_ préconfiguration de l’utilisation du proxy de la tâche BG**) fonctionne uniquement dans les déploiements du protocole WPAD (Web Proxy Auto-Discovery), sauf si des étapes de configuration supplémentaires sont effectuées.</span><span class="sxs-lookup"><span data-stu-id="866c9-153">The Internet Explorer proxy settings do not apply to system accounts, so the default proxy behavior (**BG\_JOB\_PROXY\_USAGE\_PRECONFIG**) will only work correctly in Web Proxy Auto-Discovery Protocol (WPAD) deployments, unless additional configuration steps are taken.</span></span> <span data-ttu-id="866c9-154">Si votre application est un service qui s’exécute en tant que LocalSystem, LocalService ou NetworkService, envisagez de configurer un jeton d’assistance sur vos travaux BITS ou de définir explicitement les paramètres de proxy appropriés en appelant [**méthode ibackgroundcopyjob :: setproxysettings n'**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-setproxysettings) avec le **\_ \_ \_ \_ remplacement de l’utilisation du proxy de tâche BG**.</span><span class="sxs-lookup"><span data-stu-id="866c9-154">If your application is a service running as LocalSystem, LocalService, or NetworkService, consider configuring a helper token on your BITS jobs, or explicitly setting the correct proxy settings by calling [**IBackgroundCopyJob::SetProxySettings**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-setproxysettings) with **BG\_JOB\_PROXY\_USAGE\_OVERRIDE**.</span></span> <span data-ttu-id="866c9-155">Vous pouvez également utiliser les commutateurs **/util/SetIEProxy** de BitsAdmin.exe pour définir les paramètres de proxy d’Internet Explorer pour le compte système LocalSystem, LocalService ou NetworkService.</span><span class="sxs-lookup"><span data-stu-id="866c9-155">As an alternative, you can use the **/Util /SetIEProxy** switches of BitsAdmin.exe to set Internet Explorer proxy settings for the LocalSystem, LocalService, or NetworkService system account.</span></span> <span data-ttu-id="866c9-156">Pour plus d’informations, consultez [BitsAdmin Tool](bitsadmin-tool.md).</span><span class="sxs-lookup"><span data-stu-id="866c9-156">For details, see [BitsAdmin Tool](bitsadmin-tool.md).</span></span>

<span data-ttu-id="866c9-157">Le service BITS ne reconnaît pas les paramètres de proxy qui sont définis à l’aide du fichier Proxycfg.exe.</span><span class="sxs-lookup"><span data-stu-id="866c9-157">BITS does not recognize the proxy settings that are set using the Proxycfg.exe file.</span></span>

<span data-ttu-id="866c9-158">À compter de la mise à jour 2018 de Windows 10 octobre (10,0 ; Build 17763), BITS utilise la même commande de proxy que celle utilisée par WinHttp avec AUTOMATIC_PROXY.</span><span class="sxs-lookup"><span data-stu-id="866c9-158">Starting with the Windows 10 October 2018 Update (10.0; Build 17763), BITS uses the same proxy order that WinHttp uses with AUTOMATIC_PROXY.</span></span> <span data-ttu-id="866c9-159">BITS utilise ce classement plus compatible lorsque BG_JOB_PROXY_USAGE_PRECONFIG est spécifié.</span><span class="sxs-lookup"><span data-stu-id="866c9-159">BITS uses this more compatible ordering when BG_JOB_PROXY_USAGE_PRECONFIG is specified.</span></span> <span data-ttu-id="866c9-160">BG_JOB_PROXY_USAGE_PRECONFIG est la valeur par défaut pour la spécification du proxy HTTP.</span><span class="sxs-lookup"><span data-stu-id="866c9-160">BG_JOB_PROXY_USAGE_PRECONFIG is the default value for specifying the HTTP proxy.</span></span>

## <a name="specifying-user-specific-settings-for-authenticating-proxies"></a><span data-ttu-id="866c9-161">Spécification de paramètres spécifiques à l’utilisateur pour l’authentification des proxies</span><span class="sxs-lookup"><span data-stu-id="866c9-161">Specifying user-specific settings for authenticating proxies</span></span>

<span data-ttu-id="866c9-162">Si vous utilisez BITS dans un environnement qui requiert l’authentification du proxy lors de l’exécution en tant que compte sans informations d’identification NTLM ou Kerberos utilisables dans le domaine réseau de l’ordinateur, vous devez effectuer des étapes supplémentaires pour vous authentifier correctement à l’aide des informations d’identification d’un autre compte d’utilisateur qui possède des informations d’identification sur le domaine.</span><span class="sxs-lookup"><span data-stu-id="866c9-162">If you are using BITS in an environment that requires proxy authentication while running as an account without usable NTLM or Kerberos credentials in the machine's network domain, you must take extra steps to authenticate properly by using the credentials of another user account that does have credentials on the domain.</span></span> <span data-ttu-id="866c9-163">Il s’agit d’un scénario classique dans lequel votre code BITS s’exécute en tant que service système tel que LocalService, NetworkService ou LocalSystem, car ces comptes n’ont pas d’informations d’identification NTLM ou Kerberos utilisables.</span><span class="sxs-lookup"><span data-stu-id="866c9-163">This is a typical scenario when your BITS code is running as a system service such as LocalService, NetworkService, or LocalSystem, as those accounts do not have usable NTLM or Kerberos credentials.</span></span>

<span data-ttu-id="866c9-164">Pour plus d’informations sur le fonctionnement de l’authentification dans ce scénario, consultez [authentification.](authentication.md)</span><span class="sxs-lookup"><span data-stu-id="866c9-164">For details on how authentication works in this scenario, see [Authentication.](authentication.md)</span></span>

## <a name="scalability"></a><span data-ttu-id="866c9-165">Extensibilité</span><span class="sxs-lookup"><span data-stu-id="866c9-165">Scalability</span></span>

<span data-ttu-id="866c9-166">Si plus de 100 travaux se trouvent dans la file d’attente, les performances peuvent commencer à diminuer en fonction de la composition du travail.</span><span class="sxs-lookup"><span data-stu-id="866c9-166">If more than 100 jobs are in the queue, performance may start to decrease depending on the composition of the job.</span></span> <span data-ttu-id="866c9-167">BITS utilise le paramètre de stratégie [MaxJobsPerMachine](group-policies.md) pour imposer une limite inconditionnelle du nombre de travaux dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="866c9-167">BITS uses the [MaxJobsPerMachine](group-policies.md) policy setting to impose a hard limit on the number of jobs in the queue.</span></span> <span data-ttu-id="866c9-168">Les applications doivent limiter le nombre de leurs travaux à environ 10, de sorte que plusieurs applications auront moins de chance de dépasser les indications 100-Job.</span><span class="sxs-lookup"><span data-stu-id="866c9-168">Applications should limit the number of their jobs to about 10, so that multiple applications will have less of a chance of exceeding the 100-job guideline.</span></span> <span data-ttu-id="866c9-169">En règle générale, une application avec un grand nombre de tâches à soumettre commence par envoyer 10 tâches, puis envoie l’une après l’autre, à la fin de chaque travail.</span><span class="sxs-lookup"><span data-stu-id="866c9-169">Typically, an application with a large number of jobs to submit would first submit 10 jobs and then submit one at a time as each job finishes.</span></span>

<span data-ttu-id="866c9-170">Le nombre de fichiers dans le travail doit également être limité à un maximum de 10 fichiers.</span><span class="sxs-lookup"><span data-stu-id="866c9-170">The number of files in the job should also be limited to a maximum of 10 files.</span></span> <span data-ttu-id="866c9-171">Si vous souhaitez transférer un grand nombre de fichiers pour un travail, envisagez de créer un fichier CAB qui contient tous les fichiers à la place.</span><span class="sxs-lookup"><span data-stu-id="866c9-171">If you want to transfer a large number of files for a job, consider creating a CAB file that contains all the files instead.</span></span>

## <a name="http-headers-can-be-in-any-case"></a><span data-ttu-id="866c9-172">Les en-têtes HTTP peuvent être dans tous les cas</span><span class="sxs-lookup"><span data-stu-id="866c9-172">HTTP Headers can be in any case</span></span>

<span data-ttu-id="866c9-173">Les normes HTTP ont toujours dit que les en-têtes HTTP doivent être traités comme ne respectant pas la casse (RFC 7230 section 3,2).</span><span class="sxs-lookup"><span data-stu-id="866c9-173">The HTTP standards have always said that HTTP headers must be treated as case-insensitive (RFC 7230 section 3.2).</span></span> <span data-ttu-id="866c9-174">La norme HTTP la plus récente, RFC 7540, va plus loin et indique que le trafic HTTP/2 doit comparer les en-têtes comme non sensibles à la casse et doit présenter des en-têtes en minuscules (RFC 6540, section 8.1.2).</span><span class="sxs-lookup"><span data-stu-id="866c9-174">The most recent HTTP standard, RFC 7540, goes further and says that HTTP/2 traffic must compare the headers as case-insensitive and must present headers in lower case (RFC 6540, section 8.1.2).</span></span> <span data-ttu-id="866c9-175">Même lorsque le trafic est envoyé avec des en-têtes qui ne sont pas en minuscules, les proxies peuvent choisir de forcer les en-têtes en minuscules.</span><span class="sxs-lookup"><span data-stu-id="866c9-175">Even when traffic is sent with non lower-case headers, proxies may well choose to force the headers to lower-case.</span></span>

## <a name="avoiding-personally-identifiable-information-pii"></a><span data-ttu-id="866c9-176">Éviter les informations d’identification personnelle (PII)</span><span class="sxs-lookup"><span data-stu-id="866c9-176">Avoiding personally identifiable information (PII)</span></span>

<span data-ttu-id="866c9-177">Les tâches BITS, y compris le nom d’affichage et la description et les noms de fichiers, sont visibles par tous les utilisateurs disposant de privilèges d’administrateur.</span><span class="sxs-lookup"><span data-stu-id="866c9-177">BITS jobs including the job display name and description and file names are visible to all users with admin privileges.</span></span> <span data-ttu-id="866c9-178">Ils peuvent également être ajoutés à la télémétrie Windows.</span><span class="sxs-lookup"><span data-stu-id="866c9-178">They may also be added to Windows Telemetry.</span></span> <span data-ttu-id="866c9-179">Vous devez éviter de placer des données sensibles (telles que le nom de l’utilisateur) dans les détails du travail.</span><span class="sxs-lookup"><span data-stu-id="866c9-179">You should avoid putting sensitive data (like the user's own name) in the job details.</span></span>
