---
title: Contrôle de compte d’utilisateur et BITS
description: Lorsqu’un utilisateur administrateur ouvre une session sur l’ordinateur, deux jetons d’accès sont créés. L’un est un jeton d’accès utilisateur standard filtré et l’autre est un jeton d’accès administrateur complet.
ms.assetid: 02439ab3-b885-4a2f-b507-0c48d2b30b76
ms.topic: article
ms.date: 7/12/2019
ms.openlocfilehash: 3017b3a0d816ba393d1427c5c1d2315a68b2dcc0
ms.sourcegitcommit: be77ed1f97d3be57a2f42070589de21b66034adf
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/29/2020
ms.locfileid: "103940763"
---
# <a name="bits-security-tokens-and-administrator-accounts"></a><span data-ttu-id="50a7a-104">Sécurité BITS, jetons et comptes d’administrateur</span><span class="sxs-lookup"><span data-stu-id="50a7a-104">BITS Security, Tokens, and Administrator Accounts</span></span>

## <a name="http-server-certificate-callbacks"></a><span data-ttu-id="50a7a-105">Rappels de certificat de serveur HTTP</span><span class="sxs-lookup"><span data-stu-id="50a7a-105">HTTP Server certificate callbacks</span></span>
<span data-ttu-id="50a7a-106">La validation correcte des certificats de serveur est un élément essentiel de la gestion de la sécurité HTTPs.</span><span class="sxs-lookup"><span data-stu-id="50a7a-106">Correctly validating server certificates is a key part of maintaining HTTPS security.</span></span> <span data-ttu-id="50a7a-107">BITS permet de toujours valider les certificats de serveur par rapport à une liste de spécifications spécifiée par [**SetSecurityFlags**](/windows/desktop/api/bits2_5/nf-bits2_5-ibackgroundcopyjobhttpoptions-setsecurityflags).</span><span class="sxs-lookup"><span data-stu-id="50a7a-107">BITS helps by always validating server certificates against a list of requirements specified by [**SetSecurityFlags**](/windows/desktop/api/bits2_5/nf-bits2_5-ibackgroundcopyjobhttpoptions-setsecurityflags).</span></span> <span data-ttu-id="50a7a-108">Par défaut, BITS utilise la validation du certificat de style « Browser ».</span><span class="sxs-lookup"><span data-stu-id="50a7a-108">By default, BITS uses "browser" style certificate validation.</span></span>

<span data-ttu-id="50a7a-109">Vous pouvez également spécifier une fonction personnalisée à appeler afin de valider davantage le certificat.</span><span class="sxs-lookup"><span data-stu-id="50a7a-109">You can also specify a custom function to call in order to further validate the certificate.</span></span> <span data-ttu-id="50a7a-110">Définissez le rappel de certificat de serveur à l’aide de la méthode [**SetServerCertificateValidationInterface**](/windows/desktop/api/Bits10_3/nf-bits10_3-ibackgroundcopyjobhttpoptions3-setservercertificatevalidationinterface) .</span><span class="sxs-lookup"><span data-stu-id="50a7a-110">Set the server certificate callback with the [**SetServerCertificateValidationInterface**](/windows/desktop/api/Bits10_3/nf-bits10_3-ibackgroundcopyjobhttpoptions3-setservercertificatevalidationinterface) method.</span></span> <span data-ttu-id="50a7a-111">Votre méthode est appelée uniquement une fois que le système d’exploitation a validé le certificat sur la base de l’appel [ **SetSecurityFlag** s](/windows/desktop/api/bits2_5/nf-bits2_5-ibackgroundcopyjobhttpoptions-setsecurityflags) .</span><span class="sxs-lookup"><span data-stu-id="50a7a-111">Your method will only be called after the operating system has validated the certificate based on the [**SetSecurityFlag** s](/windows/desktop/api/bits2_5/nf-bits2_5-ibackgroundcopyjobhttpoptions-setsecurityflags) call.</span></span> 

## <a name="http-client-certificates"></a><span data-ttu-id="50a7a-112">Certificats clients HTTP</span><span class="sxs-lookup"><span data-stu-id="50a7a-112">HTTP Client certificates</span></span>
<span data-ttu-id="50a7a-113">Vous pouvez définir un certificat client sur un travail HTTP avec deux méthodes de paramètres de certificat différentes.</span><span class="sxs-lookup"><span data-stu-id="50a7a-113">You can set a client certificate on an HTTP job with two different certificate settings methods.</span></span> <span data-ttu-id="50a7a-114">Vous pouvez définir un certificat par [ID](/windows/desktop/api/bits2_5/nf-bits2_5-ibackgroundcopyjobhttpoptions-setclientcertificatebyid) ou par le nom d' [objet](/windows/desktop/api/bits2_5/nf-bits2_5-ibackgroundcopyjobhttpoptions-setclientcertificatebyname)du certificat.</span><span class="sxs-lookup"><span data-stu-id="50a7a-114">You can set a certificate either by [ID](/windows/desktop/api/bits2_5/nf-bits2_5-ibackgroundcopyjobhttpoptions-setclientcertificatebyid) or by the certificate [subject name](/windows/desktop/api/bits2_5/nf-bits2_5-ibackgroundcopyjobhttpoptions-setclientcertificatebyname).</span></span> <span data-ttu-id="50a7a-115">Le certificat client est utilisé lors de la négociation TLS (ou de la renégociation) si le serveur requiert l’authentification du client.</span><span class="sxs-lookup"><span data-stu-id="50a7a-115">The client certificate will be used during TLS negotiation (or renegotiation) if the server requires client authentication.</span></span>

## <a name="write-only-http-headers"></a><span data-ttu-id="50a7a-116">En-têtes HTTP en écriture seule</span><span class="sxs-lookup"><span data-stu-id="50a7a-116">Write-only HTTP headers</span></span>
<span data-ttu-id="50a7a-117">BITS vous aide à protéger les jetons d’authentification HTTP contre les accès indésirables.</span><span class="sxs-lookup"><span data-stu-id="50a7a-117">BITS helps you protect HTTP authentication tokens from unwanted access.</span></span> <span data-ttu-id="50a7a-118">Souvent, un serveur HTTP nécessite un type de jeton de sécurité ou de chaîne lors du téléchargement ou du chargement d’un fichier sur les serveurs HTTP.</span><span class="sxs-lookup"><span data-stu-id="50a7a-118">Often an HTTP server will need some kind of security token or string when downloading or uploading a file to HTTP servers.</span></span>

<span data-ttu-id="50a7a-119">BITS protège ces jetons d’authentification de plusieurs façons.</span><span class="sxs-lookup"><span data-stu-id="50a7a-119">BITS protects these authentication tokens in several ways.</span></span>
* <span data-ttu-id="50a7a-120">BITS vous permet d’utiliser des connexions HTTP protégées par TLS et SSL en spécifiant une URL HTTPs.</span><span class="sxs-lookup"><span data-stu-id="50a7a-120">BITS lets you use TLS- and SSL-protected HTTP connections by specifying an HTTPS URL.</span></span>
* <span data-ttu-id="50a7a-121">Les en-têtes personnalisés sont toujours conservés dans un format chiffré sur le disque.</span><span class="sxs-lookup"><span data-stu-id="50a7a-121">Custom headers are always persisted in an encrypted format on disk.</span></span>
* <span data-ttu-id="50a7a-122">Vous pouvez empêcher que les en-têtes des clients soient renvoyés à d’autres programmes avec la méthode [**IBackgroundCopyJobHttpOptions3 :: MakeCustomHeadersWriteOnly**](/windows/win32/api/Bits10_3/nf-bits10_3-ibackgroundcopyjobhttpoptions3-makecustomheaderswriteonly) .</span><span class="sxs-lookup"><span data-stu-id="50a7a-122">You can prevent customer headers from being returned to other programs with the [**IBackgroundCopyJobHttpOptions3::MakeCustomHeadersWriteOnly**](/windows/win32/api/Bits10_3/nf-bits10_3-ibackgroundcopyjobhttpoptions3-makecustomheaderswriteonly) method.</span></span>


## <a name="standard-and-administrator-users"></a><span data-ttu-id="50a7a-123">Utilisateurs standard et administrateurs</span><span class="sxs-lookup"><span data-stu-id="50a7a-123">Standard and Administrator users</span></span>
<span data-ttu-id="50a7a-124">Un utilisateur qui se trouve dans le groupe administrateurs peut exécuter un processus avec un accès utilisateur standard ou dans un état élevé (avec des privilèges d’administrateur).</span><span class="sxs-lookup"><span data-stu-id="50a7a-124">A user who is in the administrator group can run a process with standard user access or in an elevated state (with administrator privileges).</span></span> <span data-ttu-id="50a7a-125">Le service BITS exécute le travail dans l’un ou l’autre des États tant que l’utilisateur a ouvert une session sur l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="50a7a-125">BITS will run the job in either state as long as the user is logged onto the computer.</span></span> <span data-ttu-id="50a7a-126">Toutefois, si l’utilisateur a créé le travail ou a pris possession du travail dans un état élevé, l’utilisateur doit se trouver dans l’état élevé pour récupérer ou modifier le travail (sinon, l’appel échoue avec l’accès refusé (0x80070005)).</span><span class="sxs-lookup"><span data-stu-id="50a7a-126">However, if the user created the job or took ownership of the job in an elevated state, the user must be in the elevated state to retrieve or modify the job (otherwise, the call fails with Access Denied (0x80070005)).</span></span> <span data-ttu-id="50a7a-127">Pour déterminer l’état élevé d’un travail, appelez la méthode [**IBackgroundCopyJob4 :: GetOwnerElevationState**](/windows/desktop/api/Bits3_0/nf-bits3_0-ibackgroundcopyjob4-getownerelevationstate) .</span><span class="sxs-lookup"><span data-stu-id="50a7a-127">To determine the elevated state of a job, call the [**IBackgroundCopyJob4::GetOwnerElevationState**](/windows/desktop/api/Bits3_0/nf-bits3_0-ibackgroundcopyjob4-getownerelevationstate) method.</span></span>

<span data-ttu-id="50a7a-128">Un utilisateur standard ne peut pas énumérer ou modifier des travaux appartenant à d’autres utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="50a7a-128">A standard user cannot enumerate or modify jobs owned by other users.</span></span>

## <a name="integrity-level"></a><span data-ttu-id="50a7a-129">Niveau d’intégrité</span><span class="sxs-lookup"><span data-stu-id="50a7a-129">Integrity level</span></span>
<span data-ttu-id="50a7a-130">En plus de l’état élevé, le niveau d’intégrité du jeton peut déterminer si l’utilisateur peut modifier un travail.</span><span class="sxs-lookup"><span data-stu-id="50a7a-130">In addition to the elevated state, the integrity level of the token can determine if the user can modify a job.</span></span> <span data-ttu-id="50a7a-131">Un client ne peut pas modifier les travaux créés par un jeton avec un niveau d’intégrité supérieur.</span><span class="sxs-lookup"><span data-stu-id="50a7a-131">A client cannot modify jobs created by a token with a higher integrity level.</span></span> <span data-ttu-id="50a7a-132">En particulier, de nombreux jetons de système local ont un niveau d’intégrité supérieur au niveau d’intégrité d’une fenêtre avec élévation de privilèges, et ne peuvent donc pas être modifiés par un administrateur à partir d’une fenêtre de commande avec élévation de privilèges ordinaire.</span><span class="sxs-lookup"><span data-stu-id="50a7a-132">In particular, many local-system tokens carry an integrity level higher than the integrity level of an elevated window, and so they cannot be modified by an administrator from an ordinary elevated command window.</span></span> <span data-ttu-id="50a7a-133">Par exemple, les Windows Update et les tâches SMS s’exécutent en tant que LocalSystem qui a un niveau d’intégrité supérieur à celui d’un jeton élevé, de sorte qu’un administrateur ne peut pas modifier ou supprimer ces travaux.</span><span class="sxs-lookup"><span data-stu-id="50a7a-133">For example, Windows Update and SMS jobs run as LocalSystem which has a higher integrity level than an elevated token so an administrator cannot modify or delete these jobs.</span></span> <span data-ttu-id="50a7a-134">Pour modifier ce travail, créez une tâche Planificateur de tâches qui s’exécute en tant que système local.</span><span class="sxs-lookup"><span data-stu-id="50a7a-134">To modify these job, create a Task Scheduler task that runs as local system.</span></span> <span data-ttu-id="50a7a-135">La tâche peut exécuter une application console qui utilise l’API BITS, ou la tâche peut exécuter un script qui appelle BitsAdmin.exe.</span><span class="sxs-lookup"><span data-stu-id="50a7a-135">The task can execute a console application that uses the BITS API, or the task could execute a script that calls BitsAdmin.exe.</span></span> <span data-ttu-id="50a7a-136">Pour déterminer le niveau d’intégrité utilisé, appelez la méthode [**IBackgroundCopyJob4 :: GetOwnerIntegrityLevel**](/windows/desktop/api/Bits3_0/nf-bits3_0-ibackgroundcopyjob4-getownerintegritylevel) .</span><span class="sxs-lookup"><span data-stu-id="50a7a-136">To determine the integrity level used, call the [**IBackgroundCopyJob4::GetOwnerIntegrityLevel**](/windows/desktop/api/Bits3_0/nf-bits3_0-ibackgroundcopyjob4-getownerintegritylevel) method.</span></span>

## <a name="service-identity"></a><span data-ttu-id="50a7a-137">Identité du service</span><span class="sxs-lookup"><span data-stu-id="50a7a-137">Service identity</span></span>
<span data-ttu-id="50a7a-138">À partir de la mise à jour de Windows 10 mai 2019 (10,0 ; Build 18362), les travaux BITS démarrés à partir d’un service conserveront l’identité de service.</span><span class="sxs-lookup"><span data-stu-id="50a7a-138">Starting in the Windows 10 May 2019 Update (10.0; Build 18362), BITS jobs started from a service will maintain the service identity.</span></span> <span data-ttu-id="50a7a-139">Cela permet aux services qui souhaitent utiliser BITS de télécharger des fichiers vers ou de télécharger des fichiers à partir d’un répertoire dont les autorisations sont liées au SID de service.</span><span class="sxs-lookup"><span data-stu-id="50a7a-139">This allows for services that wish to use BITS to download files to or upload files from a directory whose permissions are tied to the service SID.</span></span> <span data-ttu-id="50a7a-140">En outre, le trafic réseau est correctement attribué au service qui a demandé le travail BITS au lieu d’être attribué à BITS.</span><span class="sxs-lookup"><span data-stu-id="50a7a-140">Additionally, network traffic will be correctly attributed to the service that requested the BITS job instead of being attributed to BITS.</span></span>

 




