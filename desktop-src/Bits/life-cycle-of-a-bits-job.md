---
title: Cycle de vie d’une tâche BITS
description: Le cycle de vie d’un travail BITS commence lorsque vous créez un travail.
ms.assetid: b765a8ef-74bd-475e-9cd9-e9e2cf4f0305
ms.topic: article
ms.date: 11/13/2018
ms.openlocfilehash: c6ac23c598d28681968e9c0cbed776ba24c57e98
ms.sourcegitcommit: de72a1294df274b0a71dc0fdc42d757e5f6df0f3
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/05/2021
ms.locfileid: "106537183"
---
# <a name="bits-job-states"></a><span data-ttu-id="b3d91-103">États du travail BITS</span><span class="sxs-lookup"><span data-stu-id="b3d91-103">BITS Job states</span></span>
<span data-ttu-id="b3d91-104">Il existe quatre classes d' [**États**](/windows/desktop/api/Bits/ne-bits-bg_job_state)bits : Starting, action, transfered et final.</span><span class="sxs-lookup"><span data-stu-id="b3d91-104">There are four classes of BITS [**states**](/windows/desktop/api/Bits/ne-bits-bg_job_state): starting, action, transferred, and final.</span></span> <span data-ttu-id="b3d91-105">Lorsqu’un travail s’exécute, il passe d’un État à l’autre dans les différentes classes d’État.</span><span class="sxs-lookup"><span data-stu-id="b3d91-105">As a job runs, it transitions between states in the different state classes.</span></span> <span data-ttu-id="b3d91-106">Une fois qu’un travail est dans un état final, il ne quitte pas l’état final et ne s’affiche pas dans une [énumération de travaux](/windows/desktop/api/bits/nf-bits-ibackgroundcopymanager-enumjobs).</span><span class="sxs-lookup"><span data-stu-id="b3d91-106">Once a job is in a final state, it won't move out of the final state and won't show up in a [job enumeration](/windows/desktop/api/bits/nf-bits-ibackgroundcopymanager-enumjobs).</span></span>

## <a name="state-changing-methods"></a><span data-ttu-id="b3d91-107">Méthodes de modification d’État</span><span class="sxs-lookup"><span data-stu-id="b3d91-107">State-changing methods</span></span>
<span data-ttu-id="b3d91-108">Il existe quatre méthodes de modification de l’état d’un travail : [**Annuler**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-cancel), [**Terminer**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-complete), [**reprendre**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-resume)et [**suspendre**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-suspend).</span><span class="sxs-lookup"><span data-stu-id="b3d91-108">There are four state-changing methods on a job: [**Cancel**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-cancel), [**Complete**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-complete), [**Resume**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-resume), and [**Suspend**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-suspend).</span></span> <span data-ttu-id="b3d91-109">Tant qu’un travail n’est pas dans un état final, vous pouvez appeler n’importe quelle méthode de modification de l’État.</span><span class="sxs-lookup"><span data-stu-id="b3d91-109">As long as a job is not in a final state, you can call any of the state-changing methods.</span></span> 

<span data-ttu-id="b3d91-110">La méthode [**suspend**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-suspend) est utilisée pour faire passer un travail à l’État Suspended.</span><span class="sxs-lookup"><span data-stu-id="b3d91-110">The [**Suspend**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-suspend) method is used to switch a job to the SUSPENDED state.</span></span> <span data-ttu-id="b3d91-111">Lorsqu’un travail est suspendu, tous ses transferts sont arrêtés et ne reprennent pas tant que vous n’appelez pas Resume.</span><span class="sxs-lookup"><span data-stu-id="b3d91-111">When a job is suspended, all of its transfers will be stopped and won't resume until you call Resume.</span></span>
<span data-ttu-id="b3d91-112">Un travail qui est déjà suspendu reste simplement suspendu.</span><span class="sxs-lookup"><span data-stu-id="b3d91-112">A job that's already suspended will simply stay suspended.</span></span>

<span data-ttu-id="b3d91-113">La méthode [**Resume**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-resume) est utilisée pour démarrer un travail qui est suspendu.</span><span class="sxs-lookup"><span data-stu-id="b3d91-113">The [**Resume**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-resume) method is used to start a job that's suspended.</span></span> <span data-ttu-id="b3d91-114">Les travaux en état d’erreur ou d’erreur temporaire seront configurés pour une nouvelle tentative.</span><span class="sxs-lookup"><span data-stu-id="b3d91-114">Jobs in an error or transient error state will be set up to be retried.</span></span> <span data-ttu-id="b3d91-115">Les travaux qui sont actuellement dans un état d’action restent dans cet État.</span><span class="sxs-lookup"><span data-stu-id="b3d91-115">Jobs that are currently in an action state will stay in that state.</span></span>

<span data-ttu-id="b3d91-116">La méthode [**Cancel**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-cancel) est utilisée pour annuler un travail.</span><span class="sxs-lookup"><span data-stu-id="b3d91-116">The [**Cancel**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-cancel) method is used to cancel a job.</span></span> <span data-ttu-id="b3d91-117">L’état passe à annulé.</span><span class="sxs-lookup"><span data-stu-id="b3d91-117">The state will switch to cancelled.</span></span> <span data-ttu-id="b3d91-118">Les fichiers en cours de transfert ne seront pas terminés.</span><span class="sxs-lookup"><span data-stu-id="b3d91-118">Any files currently being transferred will not be completed.</span></span> <span data-ttu-id="b3d91-119">Tous les fichiers entièrement transférés et transférés partiellement seront supprimés.</span><span class="sxs-lookup"><span data-stu-id="b3d91-119">All completely transferred and partially transferred files will be deleted.</span></span>

<span data-ttu-id="b3d91-120">La méthode [**Complete**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-complete) termine un transfert.</span><span class="sxs-lookup"><span data-stu-id="b3d91-120">The [**Complete**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-complete) method will finish a transfer.</span></span> <span data-ttu-id="b3d91-121">Tous les fichiers entièrement téléchargés sont conservés. les fichiers qui ne sont pas entièrement transférés seront supprimés.</span><span class="sxs-lookup"><span data-stu-id="b3d91-121">Any fully downloaded files will be kept; files that are not fully transferred will be deleted.</span></span>

<span data-ttu-id="b3d91-122">Vous devez appeler annuler ou terminer pour déplacer votre travail vers un état final et le nettoyer.</span><span class="sxs-lookup"><span data-stu-id="b3d91-122">You must call either Cancel or Complete to move your job to a final state and be cleaned up.</span></span> <span data-ttu-id="b3d91-123">Les tâches qui ne sont pas transférées vers un état final gaspillent les ressources système.</span><span class="sxs-lookup"><span data-stu-id="b3d91-123">Jobs that aren't transitioned to a final state will waste system resources.</span></span> <span data-ttu-id="b3d91-124">Le service BITS annule ensuite automatiquement les anciens travaux.</span><span class="sxs-lookup"><span data-stu-id="b3d91-124">BITS will eventually automatically cancel old jobs.</span></span> <span data-ttu-id="b3d91-125">Le [paramètre jobinactivitytimeout](/windows/desktop/Bits/group-policies) par défaut consiste à annuler les travaux au bout de 90 jours.</span><span class="sxs-lookup"><span data-stu-id="b3d91-125">The default [JobInactivityTimeout](/windows/desktop/Bits/group-policies) is to cancel jobs after 90 days.</span></span>


## <a name="starting-state"></a><span data-ttu-id="b3d91-126">État initial</span><span class="sxs-lookup"><span data-stu-id="b3d91-126">Starting state</span></span> 
<span data-ttu-id="b3d91-127">L’état de démarrage est **suspendu**.</span><span class="sxs-lookup"><span data-stu-id="b3d91-127">The starting state is **SUSPENDED**.</span></span> <span data-ttu-id="b3d91-128">À partir de là, vous pouvez ajouter des fichiers au travail et définir les propriétés des travaux et des fichiers.</span><span class="sxs-lookup"><span data-stu-id="b3d91-128">From here, you can add files to the job and set job and file properties.</span></span> <span data-ttu-id="b3d91-129">Pour démarrer un travail de transfert, appelez Resume sur le travail.</span><span class="sxs-lookup"><span data-stu-id="b3d91-129">To start a job transferring, call Resume on the job.</span></span> <span data-ttu-id="b3d91-130">Si vous reprenez un travail sans fichier, il renverra un code d’erreur BG_E_EMPTY et le travail restera suspendu.</span><span class="sxs-lookup"><span data-stu-id="b3d91-130">If you resume a job with no files, it will return a BG_E_EMPTY error code and the job will stay suspended.</span></span>

## <a name="action-states"></a><span data-ttu-id="b3d91-131">États d’action</span><span class="sxs-lookup"><span data-stu-id="b3d91-131">Action states</span></span>
<span data-ttu-id="b3d91-132">Les États de mise en **file d’attente**, de **connexion** et de **transfert** affichent l’activité interne actuelle de votre travail.</span><span class="sxs-lookup"><span data-stu-id="b3d91-132">The **QUEUED**, **CONNECTING** and **TRANSFERRING** states show the current internal activity of your job.</span></span> <span data-ttu-id="b3d91-133">Un travail mis en file d’attente est prêt à être planifié, probablement en attente du planificateur BITS ou en attente de connexion de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="b3d91-133">A job that's QUEUED is ready to be scheduled, possibly waiting for the BITS scheduler or waiting for the user to log in.</span></span> <span data-ttu-id="b3d91-134">Un travail qui se CONNECTe tente de se connecter au serveur pour commencer à transférer des fichiers.</span><span class="sxs-lookup"><span data-stu-id="b3d91-134">A job that's CONNECTING is attempting to connect to the server to start transferring files.</span></span> <span data-ttu-id="b3d91-135">Un travail qui transfère est en train de charger ou de télécharger vos fichiers.</span><span class="sxs-lookup"><span data-stu-id="b3d91-135">A job that's TRANSFERRING is actively uploading or downloading your files.</span></span>

<span data-ttu-id="b3d91-136">L’état d' **erreur temporaire** signifie que la tâche a été tentée et qu’elle n’a pas réussi à transférer le fichier.</span><span class="sxs-lookup"><span data-stu-id="b3d91-136">The **TRANSIENT ERROR** state means that the job tried and failed to transfer the file.</span></span> <span data-ttu-id="b3d91-137">Cela peut être pour des raisons de stratégie réseau. le travail est peut-être bloqué, car le réseau actuel est trop onéreux.</span><span class="sxs-lookup"><span data-stu-id="b3d91-137">This might be for network policy reasons; the job might be blocked because the current network is too expensive.</span></span> <span data-ttu-id="b3d91-138">Elle peut également être bloquée pour des raisons de système telles que le système se trouve dans l’économiseur de batterie ou le mode jeu, ou parce qu’il n’y a pas de connectivité Internet.</span><span class="sxs-lookup"><span data-stu-id="b3d91-138">It might also be blocked for system reasons like the system being in battery saver or game mode, or because there's no internet connectivity.</span></span> 

<span data-ttu-id="b3d91-139">Les travaux en état d’erreur temporaire sont retentés automatiquement par BITS, le cas échéant.</span><span class="sxs-lookup"><span data-stu-id="b3d91-139">Jobs in the transient error state will be retried automatically by BITS when appropriate.</span></span> <span data-ttu-id="b3d91-140">BITS comprend une valeur [MinimumRetryDelay](/windows/desktop/api/bits/nf-bits-ibackgroundcopyjob-setminimumretrydelay) et [NoProgressTimeout](/windows/desktop/api/bits/nf-bits-ibackgroundcopyjob-setnoprogresstimeout) pour contrôler le moment auquel un travail est relancé et le moment où bits arrête la nouvelle tentative.</span><span class="sxs-lookup"><span data-stu-id="b3d91-140">BITS includes a [MinimumRetryDelay](/windows/desktop/api/bits/nf-bits-ibackgroundcopyjob-setminimumretrydelay) and [NoProgressTimeout](/windows/desktop/api/bits/nf-bits-ibackgroundcopyjob-setnoprogresstimeout) value to control when a job is retried and when BITS will finally stop retrying.</span></span>


## <a name="transferred-states"></a><span data-ttu-id="b3d91-141">États transférés</span><span class="sxs-lookup"><span data-stu-id="b3d91-141">Transferred states</span></span>
<span data-ttu-id="b3d91-142">Les États transférés se produisent lorsqu’il n’y a plus de transfert à effectuer.</span><span class="sxs-lookup"><span data-stu-id="b3d91-142">The transferred states happen when there's no more transferring to be done.</span></span> <span data-ttu-id="b3d91-143">Vous devez annuler ou terminer un travail dans cet État.</span><span class="sxs-lookup"><span data-stu-id="b3d91-143">You must either cancel or complete a job in this state.</span></span> <span data-ttu-id="b3d91-144">Vous pouvez également ajouter d’autres fichiers à transférer et appeler RESUME (), mais ce n’est pas une pratique courante.</span><span class="sxs-lookup"><span data-stu-id="b3d91-144">You may also add more files to transfer and call Resume(), but this isn't a common practice.</span></span>

<span data-ttu-id="b3d91-145">L’état d' **erreur** se produit lorsqu’un transfert est effectué (il ne sera pas retenté), mais ne s’est pas terminé correctement.</span><span class="sxs-lookup"><span data-stu-id="b3d91-145">The **ERROR** state happens when a transfer is done (it won't be retried), but didn't fully succeed.</span></span> <span data-ttu-id="b3d91-146">Tous les fichiers doivent être transférés pour réussir. en cas d’échec définitif du travail, le travail est erroné.</span><span class="sxs-lookup"><span data-stu-id="b3d91-146">All the files must be transferred to be successful; if any have permanently failed the job will be in error.</span></span> <span data-ttu-id="b3d91-147">En général, vous appelez la fonction CANCEL ou Complete pour déplacer le travail vers un état final.</span><span class="sxs-lookup"><span data-stu-id="b3d91-147">You will typically either call Cancel or Complete to move the job to a final state.</span></span> <span data-ttu-id="b3d91-148">La différence pratique est que lorsque vous appelez Cancel, tout fichier transféré avec succès sera supprimé, mais si vous appelez Complete, aucun fichier transféré avec succès ne sera supprimé.</span><span class="sxs-lookup"><span data-stu-id="b3d91-148">The practical difference is that when you call Cancel, any successfully transferred file will be deleted, but if you call Complete, any successfully transferred file will not be deleted.</span></span>

<span data-ttu-id="b3d91-149">Les raisons de l’état d’erreur sont les suivants :</span><span class="sxs-lookup"><span data-stu-id="b3d91-149">Reasons for being in an ERROR state include</span></span> 
* <span data-ttu-id="b3d91-150">Rester trop longtemps dans un état d’erreur temporaire (au-delà du paramètre [NoProgressTimeout](/windows/desktop/api/bits/nf-bits-ibackgroundcopyjob-setnoprogresstimeout) ).</span><span class="sxs-lookup"><span data-stu-id="b3d91-150">Staying too long in a TRANSIENT ERROR state (beyond the [NoProgressTimeout](/windows/desktop/api/bits/nf-bits-ibackgroundcopyjob-setnoprogresstimeout) setting).</span></span>
* <span data-ttu-id="b3d91-151">Obtenir une erreur de BG_E_TOKEN_REQUIRED et avoir besoin d’aide avec les [jetons d’assistance](/windows/desktop/Bits/helper-tokens-for-bits-transfer-jobs)</span><span class="sxs-lookup"><span data-stu-id="b3d91-151">Getting a BG_E_TOKEN_REQUIRED error and needing assistance with [helper tokens](/windows/desktop/Bits/helper-tokens-for-bits-transfer-jobs)</span></span>

<span data-ttu-id="b3d91-152">Il est courant de reconfigurer un travail d’erreur, puis d’appeler Resume pour retenter la tâche.</span><span class="sxs-lookup"><span data-stu-id="b3d91-152">It's a common practice to reconfigure an ERROR'd job and then call Resume to retry the job.</span></span> <span data-ttu-id="b3d91-153">Par exemple, votre application peut avoir besoin de mettre à jour le nom distant d’un fichier via [SetRemoteName](/windows/desktop/api/bits2_0/nf-bits2_0-ibackgroundcopyfile2-setremotename).</span><span class="sxs-lookup"><span data-stu-id="b3d91-153">For example, your app might need to update a file's remote name via [SetRemoteName](/windows/desktop/api/bits2_0/nf-bits2_0-ibackgroundcopyfile2-setremotename).</span></span>

<span data-ttu-id="b3d91-154">L’état **transféré** se produit lorsqu’un transfert est terminé et qu’il a réussi.</span><span class="sxs-lookup"><span data-stu-id="b3d91-154">The **TRANSFERRED** state happens when a transfer is done and it succeeded.</span></span> <span data-ttu-id="b3d91-155">Vous devez appeler Complete pour finaliser le travail ; pour les tâches de téléchargement, les fichiers téléchargés ne sont pas disponibles tant que vous n’avez pas terminé l’appel.</span><span class="sxs-lookup"><span data-stu-id="b3d91-155">You must call Complete to finalize the job; for download jobs the downloaded files won't be available until after you call Complete.</span></span> <span data-ttu-id="b3d91-156">La seule exception à cette règle concerne les tâches à haut niveau de performances (et vous devez toujours appeler Complete).</span><span class="sxs-lookup"><span data-stu-id="b3d91-156">The exception to this rule is jobs which are the high performance jobs (and you should still call Complete).</span></span>

## <a name="final-states"></a><span data-ttu-id="b3d91-157">États finaux</span><span class="sxs-lookup"><span data-stu-id="b3d91-157">Final states</span></span>
<span data-ttu-id="b3d91-158">Une fois qu’un travail est dans un état final, vous ne pouvez pas appeler les méthodes de modification d’État.</span><span class="sxs-lookup"><span data-stu-id="b3d91-158">Once a job is in a final state, you can't call any of the state-changing methods.</span></span> <span data-ttu-id="b3d91-159">La tâche est **confirmée** après l’appel de Complete () et tous les fichiers téléchargés terminés sont disponibles.</span><span class="sxs-lookup"><span data-stu-id="b3d91-159">The job will be **ACKNOWLEDGED** after you call Complete() and all completed downloaded files will be available.</span></span> <span data-ttu-id="b3d91-160">La tâche est **annulée** une fois que vous avez appelé Cancel () et que tous les fichiers téléchargés sont supprimés.</span><span class="sxs-lookup"><span data-stu-id="b3d91-160">The job will be **CANCELLED** after you call Cancel() and all downloaded files will be deleted.</span></span> 


## <a name="life-cycle-of-a-bits-job"></a><span data-ttu-id="b3d91-161">Cycle de vie d’une tâche BITS</span><span class="sxs-lookup"><span data-stu-id="b3d91-161">Life Cycle of a BITS job</span></span>

<span data-ttu-id="b3d91-162">Le cycle de vie d’un travail BITS commence lorsque vous créez un travail.</span><span class="sxs-lookup"><span data-stu-id="b3d91-162">The life cycle of a BITS job begins when you create a job.</span></span> <span data-ttu-id="b3d91-163">Un travail est un conteneur qui contient un ou plusieurs fichiers à transférer.</span><span class="sxs-lookup"><span data-stu-id="b3d91-163">A job is a container that contains one or more files to transfer.</span></span> <span data-ttu-id="b3d91-164">Un travail possède également des propriétés qui spécifient comment BITS transfère les fichiers et interagit avec votre application.</span><span class="sxs-lookup"><span data-stu-id="b3d91-164">A job also has properties that specify how BITS transfers the files and interacts with your application.</span></span> <span data-ttu-id="b3d91-165">Par exemple, vous pouvez spécifier la priorité du travail, s’il s’agit d’un travail de chargement ou de téléchargement, et pour quels événements vous souhaitez recevoir des notifications.</span><span class="sxs-lookup"><span data-stu-id="b3d91-165">For example, you can specify the priority of the job, whether the job is an upload or download job, and for which events you want to receive notification.</span></span>

<span data-ttu-id="b3d91-166">Après avoir créé le travail, ajoutez un ou plusieurs fichiers (les travaux de chargement ne peuvent contenir qu’un seul fichier) au travail et modifiez les valeurs de propriété en fonction de votre application.</span><span class="sxs-lookup"><span data-stu-id="b3d91-166">After you create the job, add one or more files (upload jobs can contain only one file) to the job and change any of the property values as appropriate for your application.</span></span> <span data-ttu-id="b3d91-167">Lorsque vous ajoutez un fichier au travail, spécifiez à la fois le nom local (client) et le nom distant (serveur) du fichier.</span><span class="sxs-lookup"><span data-stu-id="b3d91-167">When you add a file to the job, specify both the local (client) and remote (server) name of the file.</span></span> <span data-ttu-id="b3d91-168">Le nom du fichier distant doit utiliser le protocole HTTP, HTTPs ou SMB.</span><span class="sxs-lookup"><span data-stu-id="b3d91-168">The remote file name must use the HTTP, HTTPS, or SMB protocol.</span></span> <span data-ttu-id="b3d91-169">Les fichiers d’un travail sont traités séquentiellement (premier dans, premier sorti).</span><span class="sxs-lookup"><span data-stu-id="b3d91-169">Files within a job are processed sequentially (first in, first out).</span></span>

<span data-ttu-id="b3d91-170">Le service BITS interrompt automatiquement les travaux lorsqu’ils sont créés.</span><span class="sxs-lookup"><span data-stu-id="b3d91-170">BITS automatically suspends jobs when they are created.</span></span> <span data-ttu-id="b3d91-171">Vous devez reprendre la tâche pour l’activer dans la file d’attente de transfert.</span><span class="sxs-lookup"><span data-stu-id="b3d91-171">You must resume the job to activate it in the transfer queue.</span></span> <span data-ttu-id="b3d91-172">Vous pouvez suspendre ou reprendre un travail à tout moment.</span><span class="sxs-lookup"><span data-stu-id="b3d91-172">You can suspend or resume a job at any time.</span></span> <span data-ttu-id="b3d91-173">La reprise du travail déplace le travail de l’état suspendu à l’État en file d’attente.</span><span class="sxs-lookup"><span data-stu-id="b3d91-173">Resuming the job moves the job from the suspended state to the queued state.</span></span> <span data-ttu-id="b3d91-174">Le travail reste dans l’état de mise en file d’attente jusqu’à ce que le planificateur détermine qu’il est le tour du travail de transférer des fichiers.</span><span class="sxs-lookup"><span data-stu-id="b3d91-174">The job stays in the queued state until the scheduler determines it is the job's turn to transfer files.</span></span> <span data-ttu-id="b3d91-175">Tous les travaux de premier plan s’exécutent simultanément avec un travail en arrière-plan.</span><span class="sxs-lookup"><span data-stu-id="b3d91-175">All foreground jobs run concurrently with one background job.</span></span> <span data-ttu-id="b3d91-176">BITS traite les fichiers dans les travaux de premier plan en série.</span><span class="sxs-lookup"><span data-stu-id="b3d91-176">BITS processes the files within foreground jobs serially.</span></span>

<span data-ttu-id="b3d91-177">Lorsqu’il s’agit d’une tâche de transfert de fichiers, le travail passe à l’État connexion pendant que BITS se connecte au serveur distant (spécifié dans le nom du fichier distant).</span><span class="sxs-lookup"><span data-stu-id="b3d91-177">When it is a job's turn to transfer files, the job moves to the connecting state while BITS connects to the remote server (specified in the remote file name).</span></span> <span data-ttu-id="b3d91-178">Si le service BITS est en mesure de se connecter au serveur distant, le travail passe à l’État transfert où il reste jusqu’à ce que sa tranche de temps se termine, que le transfert soit terminé, qu’une erreur se produise ou que l’application interrompe le travail.</span><span class="sxs-lookup"><span data-stu-id="b3d91-178">If BITS is able to connect to the remote server, the job moves to the transferring state where it stays until its time slice ends, the transfer is complete, an error occurs, or the application suspends the job.</span></span>

<span data-ttu-id="b3d91-179">Le travail se déplace entre les États de mise en file d’attente, de connexion et de transfert jusqu’à ce que le service BITS transfère tous les fichiers du travail.</span><span class="sxs-lookup"><span data-stu-id="b3d91-179">The job moves between the queued, connecting, and transferring states until BITS transfers all files in the job.</span></span> <span data-ttu-id="b3d91-180">À ce stade, le travail passe à l’état transféré.</span><span class="sxs-lookup"><span data-stu-id="b3d91-180">At that point, the job moves to the transferred state.</span></span> <span data-ttu-id="b3d91-181">BITS utilise la planification par tourniquet (Round Robin) pour planifier les tâches qui sont au même niveau de priorité.</span><span class="sxs-lookup"><span data-stu-id="b3d91-181">BITS uses round-robin scheduling to schedule jobs that are at the same priority level.</span></span> <span data-ttu-id="b3d91-182">Chaque travail reçoit une tranche de temps pour traiter ses fichiers.</span><span class="sxs-lookup"><span data-stu-id="b3d91-182">Each job is given a slice of time to process its files.</span></span> <span data-ttu-id="b3d91-183">Si la tâche ne se termine pas pendant sa tranche de temps, le travail revient à l’État en file d’attente et la tâche suivante dans la file d’attente est activée.</span><span class="sxs-lookup"><span data-stu-id="b3d91-183">If the job does not complete during its time slice, the job goes back to the queued state and the next job in the queue is activated.</span></span> <span data-ttu-id="b3d91-184">Cela évite que des travaux de grande taille bloquent des tâches plus petites.</span><span class="sxs-lookup"><span data-stu-id="b3d91-184">This prevents large jobs from blocking smaller jobs.</span></span> <span data-ttu-id="b3d91-185">Les travaux sont traités en grande partie selon le principe du premier entré, premier sorti (FIFO). Toutefois, le service BITS ne peut pas garantir le traitement FIFO en raison de la planification par tourniquet (Round Robin), des erreurs de travail et des redémarrages du service.</span><span class="sxs-lookup"><span data-stu-id="b3d91-185">Jobs are processed largely on a first in, first out (FIFO) basis; however, BITS cannot guarantee FIFO processing because of round-robin scheduling, job errors, and service restarts.</span></span>

<span data-ttu-id="b3d91-186">Les fichiers transférés ne sont pas disponibles pour le client tant que l’application n’a pas appelé la méthode [**méthode ibackgroundcopyjob :: Complete**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-complete) pour transférer la propriété des fichiers de bits à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="b3d91-186">The transferred files are not available to the client until the application calls the [**IBackgroundCopyJob::Complete**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-complete) method to transfer ownership of the files from BITS to the user.</span></span> <span data-ttu-id="b3d91-187">Les travaux de chargement sont également définis sur l’état transféré lorsque le fichier est reçu avec succès par le serveur.</span><span class="sxs-lookup"><span data-stu-id="b3d91-187">Upload jobs are also set to the transferred state when the file is successfully received by the server.</span></span> <span data-ttu-id="b3d91-188">Les travaux de chargement-réponse sont définis sur l’état transféré une fois que le fichier a été envoyé au serveur et que la réponse de l’application serveur est transférée avec succès au client.</span><span class="sxs-lookup"><span data-stu-id="b3d91-188">Upload-reply jobs are set to the transferred state after the file is successfully sent to the server and the reply from the server application is successfully transferred to the client.</span></span>

<span data-ttu-id="b3d91-189">Si une erreur se produit, le travail passe à l’état d’erreur irrécupérable ou temporaire.</span><span class="sxs-lookup"><span data-stu-id="b3d91-189">If an error occurs, the job moves to either the fatal or transient error state.</span></span> <span data-ttu-id="b3d91-190">Les erreurs irrécupérables sont des erreurs que BITS ne peut pas récupérer à partir de ou qui nécessitent une intervention pour résoudre le problème.</span><span class="sxs-lookup"><span data-stu-id="b3d91-190">Fatal errors are errors that BITS cannot recover from or which require intervention to fix.</span></span> <span data-ttu-id="b3d91-191">Si l’application est en mesure de corriger l’erreur, l’application reprend la tâche et le service BITS déplace la tâche à l’État en file d’attente.</span><span class="sxs-lookup"><span data-stu-id="b3d91-191">If the application is able to fix the error, the application resumes the job and BITS moves the job to the queued state.</span></span> <span data-ttu-id="b3d91-192">Les erreurs temporaires sont des erreurs qui peuvent se résoudre eux-mêmes.</span><span class="sxs-lookup"><span data-stu-id="b3d91-192">Transient errors are errors that may resolve themselves.</span></span> <span data-ttu-id="b3d91-193">BITS réessaie les travaux en état d’erreur temporaire jusqu’à ce que le transfert soit réussi ou que le délai d’attente du travail soit dépassé. Le travail expire quand aucune progression n’est effectuée au cours d’une période spécifiée par l’application.</span><span class="sxs-lookup"><span data-stu-id="b3d91-193">BITS retries jobs in the transient error state until the transfer is successful or the job times out. The job times out when no progress is made within an application-specified period.</span></span> <span data-ttu-id="b3d91-194">Si le travail expire, le service BITS déplace le travail vers l’état d’erreur irrécupérable.</span><span class="sxs-lookup"><span data-stu-id="b3d91-194">If the job times out, BITS moves the job to fatal error state.</span></span>

<span data-ttu-id="b3d91-195">Pour plus d’informations sur les États de travail, consultez [**\_ \_ État du travail BG**](/windows/desktop/api/Bits/ne-bits-bg_job_state).</span><span class="sxs-lookup"><span data-stu-id="b3d91-195">For more information on job states, see [**BG\_JOB\_STATE**](/windows/desktop/api/Bits/ne-bits-bg_job_state).</span></span>
