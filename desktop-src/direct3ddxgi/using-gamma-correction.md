---
description: La correction gamma, ou gamma pour Short, est le nom d’une opération non linéaire que les systèmes utilisent pour coder et décoder les valeurs de pixel dans les images.
ms.assetid: 97ACDAE3-514E-4AAF-A27D-E5FFC162DB2A
title: Utilisation de la correction gamma
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1c940db1a94fb41e9babecbeb3075aa9e01b3732
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/06/2021
ms.locfileid: "104552579"
---
# <a name="using-gamma-correction"></a><span data-ttu-id="ed3e8-103">Utilisation de la correction gamma</span><span class="sxs-lookup"><span data-stu-id="ed3e8-103">Using gamma correction</span></span>

<span data-ttu-id="ed3e8-104">La correction gamma, ou gamma pour Short, est le nom d’une opération non linéaire que les systèmes utilisent pour coder et décoder les valeurs de pixel dans les images.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-104">Gamma correction, or gamma for short, is the name of a nonlinear operation that systems use to code and decode pixel values in images.</span></span>

-   [<span data-ttu-id="ed3e8-105">Qu’est-ce que le gamma et à quoi sert-il ?</span><span class="sxs-lookup"><span data-stu-id="ed3e8-105">What is gamma and what is it for?</span></span>](#what-is-gamma-and-what-is-it-for)
-   [<span data-ttu-id="ed3e8-106">Arrière-plan de gamma sur Windows</span><span class="sxs-lookup"><span data-stu-id="ed3e8-106">Background of gamma on Windows</span></span>](#background-of-gamma-on-windows)
-   [<span data-ttu-id="ed3e8-107">Évolution de l’affichage du matériel</span><span class="sxs-lookup"><span data-stu-id="ed3e8-107">Evolution of display hardware</span></span>](#evolution-of-display-hardware)
-   [<span data-ttu-id="ed3e8-108">Fonctionnalités de contrôle gamma dans DXGI</span><span class="sxs-lookup"><span data-stu-id="ed3e8-108">Gamma control capabilities in DXGI</span></span>](#gamma-control-capabilities-in-dxgi)
-   [<span data-ttu-id="ed3e8-109">Définition du contrôle gamma avec DXGI</span><span class="sxs-lookup"><span data-stu-id="ed3e8-109">Setting gamma control with DXGI</span></span>](#setting-gamma-control-with-dxgi)
-   [<span data-ttu-id="ed3e8-110">Pratiques de contrôle gamma</span><span class="sxs-lookup"><span data-stu-id="ed3e8-110">Gamma control practicalities</span></span>](#gamma-control-practicalities)
-   [<span data-ttu-id="ed3e8-111">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="ed3e8-111">Related topics</span></span>](#related-topics)

## <a name="what-is-gamma-and-what-is-it-for"></a><span data-ttu-id="ed3e8-112">Qu’est-ce que le gamma et à quoi sert-il ?</span><span class="sxs-lookup"><span data-stu-id="ed3e8-112">What is gamma and what is it for?</span></span>

<span data-ttu-id="ed3e8-113">À la fin du pipeline graphique, juste où l’image laisse l’ordinateur effectuer son parcours le long du câble du moniteur, il y a un petit morceau de matériel capable de transformer les valeurs de pixel à la volée.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-113">At the end of the graphics pipeline, just where the image leaves the computer to make its journey along the monitor cable, there is a small piece of hardware that can transform pixel values on the fly.</span></span> <span data-ttu-id="ed3e8-114">Ce matériel utilise généralement une table de recherche pour transformer les pixels.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-114">This hardware typically uses a lookup table to transform the pixels.</span></span> <span data-ttu-id="ed3e8-115">Ce matériel utilise les valeurs rouge, vert et bleu qui proviennent de la surface à afficher pour rechercher les valeurs corrigées gamma dans la table, puis envoie les valeurs corrigées à l’analyse à la place des valeurs de surface réelles.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-115">This hardware uses the red, green and blue values that come from the surface to be displayed to look up gamma-corrected values in the table and then sends the corrected values to the monitor instead of the actual surface values.</span></span> <span data-ttu-id="ed3e8-116">Par conséquent, cette table de recherche est une opportunité de remplacer toute couleur par une autre couleur.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-116">So, this lookup table is an opportunity to replace any color with any other color.</span></span> <span data-ttu-id="ed3e8-117">Bien que la table ait ce niveau de puissance, l’utilisation classique consiste à ajuster les images de façon subtile pour compenser les différences dans la réponse du moniteur.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-117">While the table has that level of power, the typical usage is to tweak images subtly to compensate for differences in the monitor’s response.</span></span> <span data-ttu-id="ed3e8-118">La réponse du moniteur est la fonction qui lie la valeur numérique des composants rouge, vert et bleu d’un pixel avec la luminosité affichée de ce pixel.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-118">The monitor’s response is the function that relates the numerical value of the red, green and blue components of a pixel with that pixel’s displayed brightness.</span></span>

<span data-ttu-id="ed3e8-119">C’est ce que ce tableau était destiné, mais les développeurs de jeux ont trouvé des utilisations créatives, telles que le clignotement de l’écran entier en rouge pour l’effet psychologique.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-119">That’s what this table was intended for, but game developers found creative uses for it, such as flashing the whole screen red for psychological effect.</span></span> <span data-ttu-id="ed3e8-120">Dans les applications de jeu modernes, dans le cadre du traitement de chaque trame, nous fournissons généralement d’autres façons d’effectuer ces opérations.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-120">In modern game apps, as part of the post-processing of each frame, we typically provide other ways to do such things.</span></span> <span data-ttu-id="ed3e8-121">En fait, nous vous recommandons de conserver la table gamma seule, car elle peut être utilisée pour étalonner la réponse du moniteur, et les modifications de gros à la rampe gamma entraîneront la destruction de cet étalonnage minutieux.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-121">In fact, we recommend that you leave the gamma table alone because it might be in use to calibrate the monitor’s response, and wholesale changes to the gamma ramp will destroy this careful calibration.</span></span>

<span data-ttu-id="ed3e8-122">La science de la détermination de la correction gamma est complexe et n’est pas présentée ici, sauf pour éclairer l’origine du nom « gamma ».</span><span class="sxs-lookup"><span data-stu-id="ed3e8-122">The science of determining gamma correction is complex, and is not presented here, other than to illuminate where the name “gamma” came from.</span></span> <span data-ttu-id="ed3e8-123">La réponse d’un moniteur CRT (autrement dit, une plus ancienne vitre) est une fonction complexe, mais la physique de ces analyses signifie qu’elles présentent une réponse qui peut être représentée de manière brute par cette fonction d’alimentation :</span><span class="sxs-lookup"><span data-stu-id="ed3e8-123">A CRT (that is, an old-fashioned glass) monitor’s response is a complex function, but the physics of these monitors mean that they exhibit a response that can be crudely represented by this power function:</span></span>

<span data-ttu-id="ed3e8-124">luminosité (entrée) =<sup>gamma</sup> d’entrée</span><span class="sxs-lookup"><span data-stu-id="ed3e8-124">brightness( input ) = input<sup>gamma</sup></span></span>

<span data-ttu-id="ed3e8-125">La valeur gamma est généralement proche de la valeur 2,0.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-125">The gamma value is typically close to a value of 2.0.</span></span> <span data-ttu-id="ed3e8-126">Les moniteurs LCD et toutes les autres technologies plus récentes sont spécialement conçus pour présenter une réponse similaire, de sorte que l’ensemble de nos logiciels et images n’ont pas besoin d’être recalibrés pour ces nouvelles technologies.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-126">LCD monitors and all other newer technologies are specifically engineered to exhibit a similar response so all our software and images don’t have to be recalibrated for those new technologies.</span></span> <span data-ttu-id="ed3e8-127">La norme sRVB déclare que cette valeur gamma est exactement 2,2, et cette valeur est devenue une norme largement implémentée.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-127">The sRGB standard declares that this gamma value is exactly 2.2, and this value has become a widely implemented standard.</span></span>

<span data-ttu-id="ed3e8-128">L’œil humain possède également une fonction de réponse qui inverse approximativement la fonction d’alimentation du CRT.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-128">The human eye also has a response function which approximately inverts the CRT power function.</span></span> <span data-ttu-id="ed3e8-129">Cela signifie que la luminosité perçue d’un pixel augmente à peu près de manière linéaire avec les valeurs RVB dans ce pixel.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-129">This means that the perceived brightness of a pixel goes up very roughly linearly with the RGB values in that pixel.</span></span>

<span data-ttu-id="ed3e8-130">Étant donné qu’une valeur gamma de 2,2 est devenue une norme de facto, nous n’avons généralement pas besoin de se soucier trop de la courbe gamma encodée dans cette table et peuvent la conserver sous la forme d’un mappage de type un-à-un linéaire.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-130">Because a gamma value of 2.2 has become a de-facto standard, we typically don’t need to worry too much about the gamma curve encoded in this table, and can leave it as a linear, one-to-one mapping.</span></span> <span data-ttu-id="ed3e8-131">La correspondance des couleurs appropriée fait évidemment appel à cette fonction, mais cette discussion n’entre pas dans le cadre de cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-131">Proper color matching does of course require exquisite care with this function, but that discussion is beyond the scope of this topic.</span></span> <span data-ttu-id="ed3e8-132">Windows comprend un outil qui permet aux utilisateurs d’étalonner leur affichage à la valeur gamma 2,2, et cet outil utilise le matériel de table de recherche pour dériver une modification subtile soigneusement choisie pour leurs ordinateurs.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-132">Windows includes a tool that lets users calibrate their displays to gamma 2.2, and this tool uses the lookup table hardware to derive a carefully-chosen subtle tweak for their computers.</span></span> <span data-ttu-id="ed3e8-133">Les utilisateurs peuvent exécuter cet outil en recherchant « CALIBRATE Color ».</span><span class="sxs-lookup"><span data-stu-id="ed3e8-133">Users can run this tool by searching for "calibrate color".</span></span> <span data-ttu-id="ed3e8-134">Il existe également des profils de couleurs bien définis pour des analyses spécifiques qui automatisent ce processus.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-134">There are also well-defined color profiles for particular monitors that automate this process.</span></span> <span data-ttu-id="ed3e8-135">L’outil « calibrage des couleurs » peut détecter ces moniteurs plus récents et informer les utilisateurs que l’étalonnage est déjà en place.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-135">The "calibrate color" tool can detect these newer monitors, and inform users that calibration is already in place.</span></span>

<span data-ttu-id="ed3e8-136">Cette notion d’encodage d’une loi d’alimentation en valeurs de couleur est utile ailleurs dans le pipeline graphique, en particulier dans les textures.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-136">This notion of encoding a power law into color values is useful elsewhere in the graphics pipeline too, especially in textures.</span></span> <span data-ttu-id="ed3e8-137">Pour les textures, vous souhaitez une plus grande précision sur les couleurs plus foncées en raison de la réponse logarithmique de l’oeil humain que nous venons de parler.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-137">For textures, you want more precision on darker colors because of the logarithmic human eye response we just talked about.</span></span> <span data-ttu-id="ed3e8-138">Une gestion attentive de gamma dans cette partie du pipeline est importante.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-138">Careful handling of gamma in this part of the pipeline is important.</span></span> <span data-ttu-id="ed3e8-139">Pour plus d’informations, consultez [conversion de données pour l’espace colorimétrique](converting-data-color-space.md).</span><span class="sxs-lookup"><span data-stu-id="ed3e8-139">For more info, see [Converting data for the color space](converting-data-color-space.md).</span></span>

<span data-ttu-id="ed3e8-140">Le reste de cette rubrique se concentre uniquement sur la correction gamma dans cette dernière partie du pipeline, entre les données de la mémoire tampon de trame et l’analyse.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-140">The remainder of this topic focuses only on gamma correction in this last part of the pipeline, between the frame buffer data and the monitor.</span></span> <span data-ttu-id="ed3e8-141">Si vous souhaitez écrire un assistant d’étalonnage ou créer des effets spéciaux dans une application en plein écran où une étape de traitement n’est pas pratique, Voici les informations dont vous avez besoin.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-141">If you want to write a calibration wizard or to create special effects in a full-screen app where a post-processing step is not practical, here is the info you need.</span></span>

## <a name="background-of-gamma-on-windows"></a><span data-ttu-id="ed3e8-142">Arrière-plan de gamma sur Windows</span><span class="sxs-lookup"><span data-stu-id="ed3e8-142">Background of gamma on Windows</span></span>

<span data-ttu-id="ed3e8-143">Les ordinateurs Windows ont généralement une table gamma qui est une table de recherche qui accepte un triple d’octets et génère un triple d’octets.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-143">Windows computers typically have a gamma table that is a lookup table that takes a triplet of bytes and outputs a triplet of bytes.</span></span> <span data-ttu-id="ed3e8-144">Ces triplets sont 768 (256 x 3) octets de RAM.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-144">These triplets are 768 (256 x 3) bytes of RAM.</span></span> <span data-ttu-id="ed3e8-145">C’est parfait lorsque votre format d’affichage contient un triple de valeurs d’octets RVB, mais n’est pas suffisamment expressif pour décrire les transformations que vous pouvez souhaiter lorsque le format d’affichage a une plage supérieure à \[ 0, \] par exemple les valeurs à virgule flottante.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-145">This is fine when your display format contains a triplet of RGB BYTE values but isn't expressive enough to describe the transformations that you might want when the display format has a greater range than \[0,1\], such as floating point values.</span></span> <span data-ttu-id="ed3e8-146">Les API de Windows qui contrôlent la gamma ont suivi une évolution dans la mesure où les formats d’affichage sont devenus plus complexes.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-146">The APIs in Windows that control gamma have followed an evolution as display formats have become more complex.</span></span>

<span data-ttu-id="ed3e8-147">Les premières API Windows pour offrir le contrôle gamma sont [**SetDeviceGammaRamp**](/windows/win32/api/wingdi/nf-wingdi-setdevicegammaramp) et [**GetDeviceGammaRamp**](/windows/win32/api/wingdi/nf-wingdi-getdevicegammaramp)de Windows Graphics Device Interface (GDI).</span><span class="sxs-lookup"><span data-stu-id="ed3e8-147">The first Windows APIs to offer gamma control are Windows Graphics Device Interface (GDI)’s [**SetDeviceGammaRamp**](/windows/win32/api/wingdi/nf-wingdi-setdevicegammaramp) and [**GetDeviceGammaRamp**](/windows/win32/api/wingdi/nf-wingdi-getdevicegammaramp).</span></span> <span data-ttu-id="ed3e8-148">Ces API fonctionnent avec des tableaux de mots de 3 256 entrées, chaque mot encodant zéro, représenté par les valeurs de mot 0 et 65535.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-148">These APIs work with three 256-entry arrays of WORDs, with each WORD encoding zero up to one, represented by WORD values 0 and 65535.</span></span> <span data-ttu-id="ed3e8-149">La précision supplémentaire d’un mot n’est généralement pas disponible dans les tables de recherche de matériel réelles, mais ces API ont été conçues pour être flexibles.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-149">The extra precision of a WORD typically isn’t available in actual hardware lookup tables, but these APIs were intended to be flexible.</span></span> <span data-ttu-id="ed3e8-150">Ces API, contrairement aux autres décrites plus loin dans cette section, n’autorisent qu’un petit écart par rapport à une fonction d’identité.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-150">These APIs, in contrast to the others described later in this section, allow only a small deviation from an identity function.</span></span> <span data-ttu-id="ed3e8-151">En fait, toute entrée de la rampe doit être comprise entre 32768 et la valeur d’identité.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-151">In fact, any entry in the ramp must be within 32768 of the identity value.</span></span> <span data-ttu-id="ed3e8-152">Cette restriction signifie qu’aucune application ne peut activer l’affichage entièrement noir ou une autre couleur illisible.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-152">This restriction means that no app can turn the display completely black or to some other unreadable color.</span></span>

<span data-ttu-id="ed3e8-153">L’API suivante est [**SetGammaRamp**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setgammaramp)de Microsoft Direct3D 9, qui suit les mêmes modèle et format de données que [**SetDeviceGammaRamp**](/windows/win32/api/wingdi/nf-wingdi-setdevicegammaramp).</span><span class="sxs-lookup"><span data-stu-id="ed3e8-153">The next API is Microsoft Direct3D 9’s [**SetGammaRamp**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setgammaramp), which follows the same pattern and data format as [**SetDeviceGammaRamp**](/windows/win32/api/wingdi/nf-wingdi-setdevicegammaramp).</span></span> <span data-ttu-id="ed3e8-154">La valeur par défaut de la rampe gamma Direct3D 9 n’est pas particulièrement utile. Il s’agit d’une rampe de mots initialisée à 0-255, et non à 0-65535, même si l’API est définie en termes de 0-65535.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-154">The default value of the Direct3D 9 gamma ramp is not particularly useful; it is a ramp of WORDs initialized to 0-255, not 0-65535, even though the API is defined in terms of 0-65535.</span></span>

<span data-ttu-id="ed3e8-155">La dernière API est [**IDXGIOutput :: SetGammaControl**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-setgammacontrol).</span><span class="sxs-lookup"><span data-stu-id="ed3e8-155">The latest API is [**IDXGIOutput::SetGammaControl**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-setgammacontrol).</span></span> <span data-ttu-id="ed3e8-156">Cette API a un schéma plus flexible pour exprimer le contrôle gamma, tout comme l’ensemble de formats d’affichage DXGI, y compris dix bits par canal, les formats float de 16 bits et le format de \_ plage étendue XR Bias.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-156">This API has a more flexible scheme to express gamma control, as befits DXGI’s increased set of display formats, including ten integer bits-per-channel, 16-bit float formats and the XR\_BIAS extended range format.</span></span>

<span data-ttu-id="ed3e8-157">Toutes ces API fonctionnent sur le même matériel et modifient les mêmes valeurs.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-157">All of these APIs operate on the same hardware, and change the same values.</span></span> <span data-ttu-id="ed3e8-158">Les API Direct3D 9 et DXGI sont en « écriture seule ».</span><span class="sxs-lookup"><span data-stu-id="ed3e8-158">The Direct3D 9 and DXGI APIs are “write only”.</span></span> <span data-ttu-id="ed3e8-159">Vous ne pouvez pas lire la valeur du matériel, la modifier, puis la définir.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-159">You can't read the value of the hardware, modify it, and then set it.</span></span> <span data-ttu-id="ed3e8-160">Vous pouvez uniquement définir la rampe.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-160">You can only set the ramp.</span></span> <span data-ttu-id="ed3e8-161">En outre, vous pouvez uniquement définir la valeur gamma lorsque l’application est en mode plein écran.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-161">Furthermore, you can only set gamma when the app is full screen.</span></span> <span data-ttu-id="ed3e8-162">Cette restriction est un autre moyen de garantir que le bureau est toujours lisible.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-162">This restriction is another way to guarantee that the desktop is always readable.</span></span> <span data-ttu-id="ed3e8-163">Autrement dit, l’application peut perturber son propre affichage, mais Windows restaurera la rampe gamma précédente lorsque l’application perdra en mode plein écran (par exemple, via ALT-TAB ou Ctrl-Alt-Del).</span><span class="sxs-lookup"><span data-stu-id="ed3e8-163">That is, the app can disturb its own display, but Windows will restore the previous gamma ramp when the app loses full screen (for example, via alt-tab or ctrl-alt-del).</span></span>

## <a name="evolution-of-display-hardware"></a><span data-ttu-id="ed3e8-164">Évolution de l’affichage du matériel</span><span class="sxs-lookup"><span data-stu-id="ed3e8-164">Evolution of display hardware</span></span>

<span data-ttu-id="ed3e8-165">Certaines analyses plus récentes peuvent afficher une large gamme d’intensités.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-165">Some newer monitors can display a wide range of intensities.</span></span> <span data-ttu-id="ed3e8-166">Toutefois, lorsque le format d’affichage peut représenter uniquement des valeurs comprises entre zéro et un, l’affichage doit mapper zéro à sa valeur la plus foncée et l’autre à sa valeur la plus claire.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-166">But, when the display format can represent only values between zero and one, the display must map zero to its darkest value and one to its brightest value.</span></span> <span data-ttu-id="ed3e8-167">Cette valeur la plus brillante peut être trop brillante pour une vue confortable des pages Web avec du texte noir sur un arrière-plan blanc, mais très belle pour des effets spéciaux trop brillants, tels que la visualisation de la lumière du soleil Glittering sur un lac ou une foudre fourche du ciel.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-167">This brightest value might be far too bright for comfortable viewing of Web pages with black text on a white background but is wonderful for over-bright special effects, such as viewing sunlight glittering off of a lake or lightning forking the sky.</span></span> <span data-ttu-id="ed3e8-168">Nous avons donc besoin d’un moyen d’exprimer ces plages plus larges.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-168">So, we need a way to express these wider ranges.</span></span> <span data-ttu-id="ed3e8-169">DXGI 1,1 et ultérieur contient des valeurs de format d’affichage qui permettent à 1,0 de représenter une valeur blanche familière et réserve des valeurs de format d’affichage plus larges pour des effets spéciaux surbrillants.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-169">DXGI 1.1 and later contains display format values that let 1.0 represent a comfortable white value and reserves wider display format values for over-bright special effects.</span></span> <span data-ttu-id="ed3e8-170">DXGI 1,1 prend en charge deux formats d’affichage qui peuvent exprimer ces valeurs plus larges : DXGI \_ format \_ R10G10B10 \_ XR \_ Bias \_ a2 \_ UNORM et 16 bits à virgule flottante.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-170">DXGI 1.1 supports two display formats that can express these wider values: DXGI\_FORMAT\_R10G10B10\_XR\_BIAS\_A2\_UNORM and 16-bit floating point.</span></span> <span data-ttu-id="ed3e8-171">Pour une description complète de ces formats, consultez [Détails du format étendu](/windows-hardware/drivers/display/details-of-the-extended-format).</span><span class="sxs-lookup"><span data-stu-id="ed3e8-171">For a full discussion of these formats, see [Details of the Extended Format](/windows-hardware/drivers/display/details-of-the-extended-format).</span></span> <span data-ttu-id="ed3e8-172">Ensuite, nous examinons la raison pour laquelle l’API gamma [**IDXGIOutput :: SetGammaControl**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-setgammacontrol) de dxgi a besoin de valeurs en pixels supérieures à 1,0.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-172">Next, we look at why DXGI’s [**IDXGIOutput::SetGammaControl**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-setgammacontrol) gamma API needs pixel values greater than 1.0.</span></span>

## <a name="gamma-control-capabilities-in-dxgi"></a><span data-ttu-id="ed3e8-173">Fonctionnalités de contrôle gamma dans DXGI</span><span class="sxs-lookup"><span data-stu-id="ed3e8-173">Gamma control capabilities in DXGI</span></span>

<span data-ttu-id="ed3e8-174">DXGI permet au pilote d’affichage d’exprimer ses contrôles gamma comme une fonction linéaire à l’étape.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-174">DXGI lets the display driver express its gamma controls as a step-wise linear function.</span></span> <span data-ttu-id="ed3e8-175">Cette fonction linéaire à l’étape est définie par les points de contrôle de cette fonction, la plage de valeurs vers laquelle la fonction peut effectuer la conversion, et une opération supplémentaire de mise à l’échelle et de décalage qui peut être appliquée après la conversion.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-175">This step-wise linear function is defined by the control points of this function, the range of values the function can convert to, and an additional optional scale-and-offset operation that can be applied after conversion.</span></span> <span data-ttu-id="ed3e8-176">Une application peut appeler la méthode [**IDXGIOutput :: GetGammaControlCapabilities**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-getgammacontrolcapabilities) pour récupérer toutes ces fonctionnalités de contrôle dans la structure de [**\_ \_ \_ fonctionnalités de contrôle gamma dxgi**](/previous-versions/windows/desktop/legacy/bb173062(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="ed3e8-176">An app can call the [**IDXGIOutput::GetGammaControlCapabilities**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-getgammacontrolcapabilities) method to retrieve all of these control capabilities in the [**DXGI\_GAMMA\_CONTROL\_CAPABILITIES**](/previous-versions/windows/desktop/legacy/bb173062(v=vs.85)) structure.</span></span>

<span data-ttu-id="ed3e8-177">Ce graphique illustre une fonction linéaire avec seulement quatre points de contrôle.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-177">This graph shows a linear function with just four control points.</span></span>

![fonction linéaire de correction gamma](images/gamma-linear-function.png)

<span data-ttu-id="ed3e8-179">DXGI définit les points de contrôle par leur emplacement le long de l’axe des couleurs de surface.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-179">DXGI defines control points by their location along the surface color axis.</span></span> <span data-ttu-id="ed3e8-180">Dans le graphique précédent, les emplacements des points de contrôle sont 0, 0,5, 0,75 et 1,0.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-180">In the preceding graph, the locations of the control points are 0, 0.5, 0.75 and 1.0.</span></span> <span data-ttu-id="ed3e8-181">Ces points de contrôle indiquent que le matériel peut convertir les valeurs de la plage 0 à 1,0.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-181">These control points indicate that the hardware can convert values in the range 0 through 1.0.</span></span> <span data-ttu-id="ed3e8-182">DXGI répertorie ces points de contrôle dans le membre de tableau **ControlPointPositions** des [**\_ \_ \_ fonctionnalités de contrôle gamma dxgi**](/previous-versions/windows/desktop/legacy/bb173062(v=vs.85)) et les déclare toujours dans l’ordre de croissance.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-182">DXGI lists these control points in the **ControlPointPositions** array member of [**DXGI\_GAMMA\_CONTROL\_CAPABILITIES**](/previous-versions/windows/desktop/legacy/bb173062(v=vs.85)) and always declares them in increasing order.</span></span> <span data-ttu-id="ed3e8-183">DXGI remplit uniquement les premiers éléments du tableau **ControlPointPositions** et indique le nombre d’éléments avec le membre **NumGammaControlPoints** des fonctionnalités de **\_ \_ contrôle \_ gamma dxgi**.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-183">DXGI fills only the first elements of the **ControlPointPositions** array and indicates the number of elements with the **NumGammaControlPoints** member of **DXGI\_GAMMA\_CONTROL\_CAPABILITIES**.</span></span> <span data-ttu-id="ed3e8-184">Si **NumGammaControlPoints** est inférieur à 1025, DXGI laisse les autres éléments **ControlPointPositions** non définis.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-184">If **NumGammaControlPoints** is less than 1025, DXGI leaves the rest of the **ControlPointPositions** elements undefined.</span></span>

<span data-ttu-id="ed3e8-185">Le matériel représenté par ce graphique peut convertir les valeurs dans une plage comprise entre 0 et 1,25.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-185">The hardware represented by this graph can convert values to a range of 0 through 1.25.</span></span> <span data-ttu-id="ed3e8-186">Par conséquent, DXGI définit les membres **MinConvertedValue** et **MaxConvertedValue** sur 0.0 f et 1,25 f respectivement.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-186">So, DXGI sets the **MinConvertedValue** and **MaxConvertedValue** members to 0.0f and 1.25f respectively.</span></span>

<span data-ttu-id="ed3e8-187">DXGI définit le membre **ScaleAndOffsetSupported** des [**\_ \_ \_ fonctionnalités de contrôle gamma dxgi**](/previous-versions/windows/desktop/legacy/bb173062(v=vs.85)) pour indiquer si le matériel prend en charge la fonctionnalité de mise à l’échelle et de décalage.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-187">DXGI sets the **ScaleAndOffsetSupported** member of [**DXGI\_GAMMA\_CONTROL\_CAPABILITIES**](/previous-versions/windows/desktop/legacy/bb173062(v=vs.85)) to indicate whether the hardware supports the scale-and-offset capability.</span></span> <span data-ttu-id="ed3e8-188">Si le matériel prend en charge la mise à l’échelle et le décalage, il conserve une table de recherche un-à-un simple, mais ajuste la sortie de la table pour étirer la sortie vers une plage supérieure à \[ 0, 1 \] .</span><span class="sxs-lookup"><span data-stu-id="ed3e8-188">If hardware supports scale-and-offset, it keeps a simple one-to-one lookup table but then adjusts the output of the table to stretch the output to a range greater than \[0,1\].</span></span> <span data-ttu-id="ed3e8-189">Le matériel met d’abord à l’échelle les valeurs provenant de la table de recherche, puis les décale.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-189">The hardware first scales the values that come out of the lookup table and then offsets them.</span></span>

> [!Note]  
> <span data-ttu-id="ed3e8-190">Différentes analyses peuvent être connectées à un même ordinateur.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-190">Different monitors connected to the same computer might have different gamma control capabilities.</span></span> <span data-ttu-id="ed3e8-191">En outre, les capacités de contrôle gamma peuvent en effet changer en fonction du mode d’affichage de la sortie.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-191">Moreover, the gamma control capabilities can in fact change depending on the display mode of the output.</span></span> <span data-ttu-id="ed3e8-192">Par conséquent, nous vous recommandons de toujours appeler [**IDXGIOutput :: GetGammaControlCapabilities**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-getgammacontrolcapabilities) pour interroger les fonctionnalités de contrôle gamma une fois que votre application passe en mode plein écran.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-192">Consequently, we recommend that you always call [**IDXGIOutput::GetGammaControlCapabilities**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-getgammacontrolcapabilities) to query gamma control capabilities after your app enters full-screen mode.</span></span>

 

<span data-ttu-id="ed3e8-193">Vous pouvez utiliser ces valeurs de capacité de contrôle gamma pour dériver des valeurs de contrôle que vous pouvez ensuite définir à l’aide de l’API [**IDXGIOutput :: SetGammaControl**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-setgammacontrol) .</span><span class="sxs-lookup"><span data-stu-id="ed3e8-193">You can use these gamma control capability values to derive control values that you can then set by using the [**IDXGIOutput::SetGammaControl**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-setgammacontrol) API.</span></span>

## <a name="setting-gamma-control-with-dxgi"></a><span data-ttu-id="ed3e8-194">Définition du contrôle gamma avec DXGI</span><span class="sxs-lookup"><span data-stu-id="ed3e8-194">Setting gamma control with DXGI</span></span>

<span data-ttu-id="ed3e8-195">Pour définir des contrôles gamma, vous transmettez un pointeur vers une structure de [**\_ \_ contrôle gamma dxgi**](/previous-versions/windows/desktop/legacy/bb173061(v=vs.85)) quand vous appelez l’API [**IDXGIOutput :: SetGammaControl**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-setgammacontrol) .</span><span class="sxs-lookup"><span data-stu-id="ed3e8-195">To set gamma controls, you pass a pointer to a [**DXGI\_GAMMA\_CONTROL**](/previous-versions/windows/desktop/legacy/bb173061(v=vs.85)) structure when you call the [**IDXGIOutput::SetGammaControl**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-setgammacontrol) API.</span></span>

<span data-ttu-id="ed3e8-196">Vous définissez les membres **Scale** et **offset** du [**\_ \_ contrôle gamma dxgi**](/previous-versions/windows/desktop/legacy/bb173061(v=vs.85)) pour spécifier les valeurs de mise à l’échelle et de décalage que vous souhaitez que le matériel applique aux valeurs que vous recevez de la table de recherche.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-196">You set the **Scale** and **Offset** members of [**DXGI\_GAMMA\_CONTROL**](/previous-versions/windows/desktop/legacy/bb173061(v=vs.85)) to specify the scale and offset values that you want the hardware to apply to the values that you get from the lookup table.</span></span> <span data-ttu-id="ed3e8-197">Vous pouvez définir en toute sécurité la mise à l' **échelle** sur 1 et le **décalage** à zéro (autrement dit, une échelle d’une unité n’a aucun effet et un décalage de zéro n’a aucun effet) si vous ne souhaitez pas utiliser la fonction de mise à l’échelle et de décalage ou si le matériel n’a pas cette fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-197">You can safely set **Scale** to 1 and **Offset** to zero (that is, a scale by one has no effect and an offset of zero has no effect) if you don't want to use the scale-and-offset capability or if the hardware doesn't have that capability.</span></span>

<span data-ttu-id="ed3e8-198">Vous définissez le  membre de tableau GammaCurve [**du \_ \_ contrôle gamma dxgi**](/previous-versions/windows/desktop/legacy/bb173061(v=vs.85)) sur une liste de structures [**\_ RGB dxgi**](/previous-versions/windows/desktop/legacy/bb173071(v=vs.85)) pour les points sur la courbe gamma.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-198">You set the **GammaCurve** array member of [**DXGI\_GAMMA\_CONTROL**](/previous-versions/windows/desktop/legacy/bb173061(v=vs.85)) to a list of [**DXGI\_RGB**](/previous-versions/windows/desktop/legacy/bb173071(v=vs.85)) structures for the points on the gamma curve.</span></span> <span data-ttu-id="ed3e8-199">Chaque **élément \_ RGB dxgi** spécifie les valeurs float qui représentent les composants rouge, vert et bleu pour ce point.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-199">Each **DXGI\_RGB** element specifies the float values that represent the red, green, and blue components for that point.</span></span> <span data-ttu-id="ed3e8-200">La courbe gamma n’utilise pas de valeurs alpha.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-200">The gamma curve doesn't use alpha values.</span></span> <span data-ttu-id="ed3e8-201">Vous utilisez le nombre que vous avez obtenu à partir de **NumGammaControlPoints** de [**\_ \_ \_ fonctionnalités de contrôle gamma dxgi**](/previous-versions/windows/desktop/legacy/bb173062(v=vs.85)) pour remplir ce nombre d’éléments dans le tableau **GammaCurve** .</span><span class="sxs-lookup"><span data-stu-id="ed3e8-201">You use the number that you obtained from **NumGammaControlPoints** of [**DXGI\_GAMMA\_CONTROL\_CAPABILITIES**](/previous-versions/windows/desktop/legacy/bb173062(v=vs.85)) to fill that number of elements in the **GammaCurve** array.</span></span> <span data-ttu-id="ed3e8-202">Chaque élément que vous placez dans le tableau **GammaCurve** correspond à la hauteur de chaque point de contrôle.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-202">Each element that you place in the **GammaCurve** array is the height for each control point.</span></span>

<span data-ttu-id="ed3e8-203">Notez dans le graphique précédent que vous contrôlez maintenant le positionnement vertical de chaque point de contrôle et que vous disposez d’un contrôle distinct pour le rouge, le vert et le bleu.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-203">Notice in the preceding graph that you now have control over the vertical placement of each control point, and you have separate control for red, green and blue.</span></span> <span data-ttu-id="ed3e8-204">Par exemple, vous pouvez définir toutes les valeurs vert et bleu sur zéro et définir les valeurs rouges sur un escalier croissant de zéro à 1.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-204">For example, you can set all of the green and blue values to zero and set the red values to an ascending staircase from zero to one.</span></span> <span data-ttu-id="ed3e8-205">Dans ce scénario, l’image affichée affiche uniquement ses parties rouges, le bleu et le vert apparaissant en noir.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-205">In this scenario, the displayed image shows only its red parts, with the blue and green appearing as black.</span></span> <span data-ttu-id="ed3e8-206">Vous pouvez également définir un escalier décroissant pour toutes les couleurs, ce qui entraîne un affichage inversé.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-206">You can also set a descending staircase for all colors, which results in an inverted display.</span></span> <span data-ttu-id="ed3e8-207">Toute valeur que vous placez dans le tableau **GammaCurve** doit être comprise dans les valeurs que vous avez obtenues à partir des membres **MinConvertedValue** et **MaxConvertedValue** des [**\_ \_ \_ fonctionnalités de contrôle gamma dxgi**](/previous-versions/windows/desktop/legacy/bb173062(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="ed3e8-207">Any value you place in the **GammaCurve** array must be inclusively within the values you obtained from the **MinConvertedValue** and **MaxConvertedValue** members of [**DXGI\_GAMMA\_CONTROL\_CAPABILITIES**](/previous-versions/windows/desktop/legacy/bb173062(v=vs.85)).</span></span>

## <a name="gamma-control-practicalities"></a><span data-ttu-id="ed3e8-208">Pratiques de contrôle gamma</span><span class="sxs-lookup"><span data-stu-id="ed3e8-208">Gamma control practicalities</span></span>

<span data-ttu-id="ed3e8-209">Les contrôles gamma de DXGI s’appliquent uniquement tant que l’application est en mode plein écran.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-209">DXGI’s gamma controls apply only as long as the app is full screen.</span></span> <span data-ttu-id="ed3e8-210">Windows restaure l’état précédent de l’affichage lorsque l’application s’arrête ou retourne en mode fenêtre.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-210">Windows restores the previous state of the display when the app exits or returns to windowed mode.</span></span> <span data-ttu-id="ed3e8-211">Mais Windows ne restaure pas l’État gamma de votre application si l’application entre en mode plein écran.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-211">But Windows doesn’t restore your app’s gamma state if the app re-enters full-screen mode.</span></span> <span data-ttu-id="ed3e8-212">Votre application doit restaurer explicitement son état gamma lorsqu’elle revient en mode plein écran.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-212">Your app must explicitly restore its gamma state when it re-enters full-screen mode.</span></span>

<span data-ttu-id="ed3e8-213">Tous les adaptateurs ne prennent pas en charge le contrôle gamma.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-213">Not all adapters support gamma control.</span></span> <span data-ttu-id="ed3e8-214">Si un adaptateur ne prend pas en charge le contrôle gamma, il ignore les appels pour définir une rampe gamma.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-214">If an adapter doesn't support gamma control, it ignores calls to set a gamma ramp.</span></span>

<span data-ttu-id="ed3e8-215">Les applications qui s’exécutent sous le Bureau à distance ne peuvent pas contrôler le gamma du tout.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-215">Apps that run under remote desktop can't control gamma at all.</span></span>

<span data-ttu-id="ed3e8-216">Le curseur de la souris, s’il est implémenté dans le matériel (le plus souvent), ne répond généralement pas au paramètre gamma.</span><span class="sxs-lookup"><span data-stu-id="ed3e8-216">The mouse cursor, if it is implemented in hardware (as most are), typically doesn't respond to the gamma setting.</span></span>

## <a name="related-topics"></a><span data-ttu-id="ed3e8-217">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="ed3e8-217">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="ed3e8-218">Guide de programmation pour DXGI</span><span class="sxs-lookup"><span data-stu-id="ed3e8-218">Programming Guide for DXGI</span></span>](dx-graphics-dxgi-overviews.md)
</dt> </dl>

 

 
