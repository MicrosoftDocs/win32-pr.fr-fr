---
title: Informations sur le module
description: Un module est un fichier exécutable ou une DLL.
ms.assetid: e15b5e15-ca06-4733-bd0a-705058ba2db8
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1625877832b7e57e68ec6baff79f0c34b4478176
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104382063"
---
# <a name="module-information"></a><span data-ttu-id="446fa-103">Informations sur le module</span><span class="sxs-lookup"><span data-stu-id="446fa-103">Module Information</span></span>

<span data-ttu-id="446fa-104">Un *module* est un fichier exécutable ou une dll.</span><span class="sxs-lookup"><span data-stu-id="446fa-104">A *module* is an executable file or DLL.</span></span> <span data-ttu-id="446fa-105">Chaque processus est constitué d'un ou de plusieurs modules.</span><span class="sxs-lookup"><span data-stu-id="446fa-105">Each process consists of one or more modules.</span></span> <span data-ttu-id="446fa-106">Vous pouvez récupérer la liste des descripteurs de module pour un processus en appelant la fonction [**EnumProcessModules**](/windows/desktop/api/Psapi/nf-psapi-enumprocessmodules) .</span><span class="sxs-lookup"><span data-stu-id="446fa-106">You can retrieve the list of module handles for a process by calling the [**EnumProcessModules**](/windows/desktop/api/Psapi/nf-psapi-enumprocessmodules) function.</span></span> <span data-ttu-id="446fa-107">Cette fonction remplit un tableau de valeurs **HMODULE** avec les handles de module pour le processus spécifié.</span><span class="sxs-lookup"><span data-stu-id="446fa-107">This function fills an array of **HMODULE** values with the module handles for the specified process.</span></span> <span data-ttu-id="446fa-108">Le premier module est le fichier exécutable.</span><span class="sxs-lookup"><span data-stu-id="446fa-108">The first module is the executable file.</span></span> <span data-ttu-id="446fa-109">N’oubliez pas que ces handles de module sont très probablement issus d’autres processus, vous ne pouvez donc pas les utiliser avec des fonctions telles que [**GetModuleFileName**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulefilenamea).</span><span class="sxs-lookup"><span data-stu-id="446fa-109">Remember that these module handles are most likely from some other process, so you cannot use them with functions such as [**GetModuleFileName**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulefilenamea).</span></span> <span data-ttu-id="446fa-110">Toutefois, vous pouvez utiliser les [fonctions PSAPI](psapi-functions.md) pour obtenir des informations sur un module à partir d’un autre processus.</span><span class="sxs-lookup"><span data-stu-id="446fa-110">However, you can use [PSAPI functions](psapi-functions.md) to obtain information about a module from another process.</span></span>

<span data-ttu-id="446fa-111">La procédure suivante décrit comment obtenir des informations de module à partir d’un autre processus.</span><span class="sxs-lookup"><span data-stu-id="446fa-111">The following procedure describes how to obtain module information from another process.</span></span>

<span data-ttu-id="446fa-112">**Pour obtenir des informations de module à partir d’un autre processus**</span><span class="sxs-lookup"><span data-stu-id="446fa-112">**To obtain module information from another process**</span></span>

1.  <span data-ttu-id="446fa-113">Appelez la fonction [**GetModuleBaseName**](/windows/desktop/api/Psapi/nf-psapi-getmodulebasenamea) .</span><span class="sxs-lookup"><span data-stu-id="446fa-113">Call the [**GetModuleBaseName**](/windows/desktop/api/Psapi/nf-psapi-getmodulebasenamea) function.</span></span> <span data-ttu-id="446fa-114">Cette fonction prend un handle de processus et un handle de module comme entrée et remplit une mémoire tampon avec le nom de base d’un module (par exemple, Kernel32.dll).</span><span class="sxs-lookup"><span data-stu-id="446fa-114">This function takes a process handle and a module handle as input and fills in a buffer with the base name of a module (for example, Kernel32.dll).</span></span> <span data-ttu-id="446fa-115">Une fonction associée, [**GetModuleFileNameEx**](/windows/desktop/api/Psapi/nf-psapi-getmodulefilenameexa), accepte les mêmes paramètres que l’entrée, mais retourne le chemin d’accès complet au module (par exemple, C : \\ Windows \\ system32 \\Kernel32.dll).</span><span class="sxs-lookup"><span data-stu-id="446fa-115">A related function, [**GetModuleFileNameEx**](/windows/desktop/api/Psapi/nf-psapi-getmodulefilenameexa), takes the same parameters as input but returns the full path to the module (for example, C:\\Windows\\System32\\Kernel32.dll).</span></span>
2.  <span data-ttu-id="446fa-116">Appelez la fonction [**GetModuleInformation**](/windows/desktop/api/Psapi/nf-psapi-getmoduleinformation) .</span><span class="sxs-lookup"><span data-stu-id="446fa-116">Call the [**GetModuleInformation**](/windows/desktop/api/Psapi/nf-psapi-getmoduleinformation) function.</span></span> <span data-ttu-id="446fa-117">Cette fonction accepte un handle de processus et un handle de module et remplit une structure [**MODULEINFO**](/windows/desktop/api/Psapi/ns-psapi-moduleinfo) avec l’adresse de chargement du module, la taille de l’espace d’adressage linéaire qu’elle occupe et un pointeur vers son point d’entrée.</span><span class="sxs-lookup"><span data-stu-id="446fa-117">This function takes a process handle and a module handle and fills a [**MODULEINFO**](/windows/desktop/api/Psapi/ns-psapi-moduleinfo) structure with the load address of the module, the size of the linear address space it occupies, and a pointer to its entry point.</span></span>

<span data-ttu-id="446fa-118">Si une application requiert des informations de module pour le processus en cours, elle doit utiliser la fonction [**GetModuleFileName**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulefilenamea) au lieu des fonctions de module PSAPI.</span><span class="sxs-lookup"><span data-stu-id="446fa-118">If an application requires module information for the current process, it should use the [**GetModuleFileName**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulefilenamea) function instead of the PSAPI module functions.</span></span> <span data-ttu-id="446fa-119">Cela permet d’obtenir des performances d’application de deux manières : la fonction **GetModuleFileName** est plus efficace que les fonctions de module psapii, et une application peut éviter de charger psapi.dll si elle n’utilise pas de fonctions PSAPI.</span><span class="sxs-lookup"><span data-stu-id="446fa-119">This helps application performance in two ways: The **GetModuleFileName** function is more efficient than the PSAPI module functions, and an application can avoid loading psapi.dll if it does not use any PSAPI functions.</span></span>

<span data-ttu-id="446fa-120">Les fonctions [**GetModuleBaseName**](/windows/desktop/api/Psapi/nf-psapi-getmodulebasenamea) et [**GetModuleFileNameEx**](/windows/desktop/api/Psapi/nf-psapi-getmodulefilenameexa) sont principalement conçues pour être utilisées par les débogueurs et les applications similaires qui doivent extraire les informations de module d’un autre processus.</span><span class="sxs-lookup"><span data-stu-id="446fa-120">The [**GetModuleBaseName**](/windows/desktop/api/Psapi/nf-psapi-getmodulebasenamea) and [**GetModuleFileNameEx**](/windows/desktop/api/Psapi/nf-psapi-getmodulefilenameexa) functions are primarily designed for use by debuggers and similar applications that must extract module information from another process.</span></span> <span data-ttu-id="446fa-121">Si la liste de modules dans le processus cible est endommagée ou n’est pas encore initialisée, ou si la liste de modules change pendant l’appel de fonction suite au chargement ou au déchargement de dll, ces fonctions peuvent échouer ou retourner des informations incorrectes.</span><span class="sxs-lookup"><span data-stu-id="446fa-121">If the module list in the target process is corrupted or is not yet initialized, or if the module list changes during the function call as a result of DLLs being loaded or unloaded, these functions may fail or return incorrect information.</span></span>

 

 