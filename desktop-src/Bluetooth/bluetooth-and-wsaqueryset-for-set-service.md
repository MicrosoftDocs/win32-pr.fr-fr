---
title: Bluetooth et WSAQUERYSET pour set service
description: Utilisation de la structure WSAQUERYSET avec la fonction WSASetService pour inscrire ou supprimer des instances de service dans l’espace de noms Bluetooth (NS \_ BTH).
ms.assetid: e582156d-a298-4d9b-8ed1-4c558fa4f203
keywords:
- Bluetooth et WSAQUERYSET pour set service Bluetooth
- WSAQUERYSET Bluetooth, pour la configuration du service
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 64a632cad2c813856367d4565bc69e0d4baf2eba
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/20/2020
ms.locfileid: "103941075"
---
# <a name="bluetooth-and-wsaqueryset-for-set-service"></a>Bluetooth et WSAQUERYSET pour set service

Bluetooth utilise la structure [**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw) pour faciliter la découverte des appareils et services dans l’espace de noms Bluetooth, NS \_ BTH.

La fonction [**WSASetService**](/windows/desktop/api/winsock2/nf-winsock2-wsasetservicea) utilise la structure [**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw) pour inscrire ou supprimer des instances de service dans l’espace de noms Bluetooth. Le tableau suivant répertorie les valeurs de membre dans la structure **WSAQUERYSET** .

| Membre                      | Valeur requise (entrée)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Output                                                                                                                                                                                                                                                                                                                                                                                                                           |
|-----------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **dwSize nul**                  | Doit être défini sur **sizeof**([**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw)). Utilisé comme mécanisme de contrôle de version.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Aucun                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **dwOutputFlags**           | Non utilisé.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Aucun                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **lpszServiceInstanceName** | Cette étape est facultative mais recommandée. Utilisé pour construire l’attribut Bluetooth ServiceName.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Aucun                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **lpServiceClassId**        | Obligatoire. GUID correspondant à la classe de service. Cette valeur doit correspondre à un GUID du document des numéros attribués Bluetooth pour les profils connus, ou un UUID unique généré par l’application pour les applications qui ne sont pas basées sur un profil. Utilisé pour construire une séquence d’attributs ServiceClassIdList avec ce seul membre.                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Aucun                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **lpVersion**               | Non utilisé.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Aucun                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **lpszComment**             | Optionnel. Utilisé pour construire l’attribut Bluetooth ServiceDescription.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Aucun                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **dwNameSpace**             | Espace de noms dans lequel limiter le service. Doit être NS \_ BTH.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Aucun                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **lpNSProviderId**          | Non obligatoire.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Aucun                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **lpszContext**             | Non utilisé.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Aucun                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **dwNumberOfProtocols**     | Non utilisé.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Aucun                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **lpafpProtocols**          | Non utilisé.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Aucun                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **lpszQueryString**         | Non utilisé.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Aucun                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **dwNumberOfCsAddrs**       | Nombre d’adresses à inscrire. Doit être égal à 1.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Aucun                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **lpcsaBuffer**             | Obligatoire si **lpBlob** n’a pas été rempli avec un flux SDP brut. Pointeur vers une structure d' [**\_ informations CSADDR**](/windows/desktop/api/nspapi/ns-nspapi-csaddr_info) avec son membre **LocalAddr. lpSockaddr** pointant vers l' [**sockaddr \_ BTH**](/windows/desktop/api/Ws2bth/ns-ws2bth-sockaddr_bth) où le serveur écoute les connexions. La fonction [**GetSockName**](/windows/desktop/api/winsock/nf-winsock-getsockname) peut être utilisée pour retourner la **structure \_ BTH sockaddr** pour un socket lié. Les informations contenues dans le membre **lpcsaBuffer** sont utilisées par le système pour construire l’attribut SDP Bluetooth ProtocolDescriptorList. Le protocole et le port fournis dans **lpcsaBuffer** doivent être uniques (pas précédemment inscrits) et sont utilisés pour indexer l’enregistrement pour les appels suivants à supprimer. Utilisé pour construire l’attribut Bluetooth ProtocolDescriptorList de l’enregistrement SDP. | Aucun                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **lpBlob**                  | Optionnel. Pointeur vers une structure d' [**objet BLOB**](/windows/desktop/api/nspapi/ns-nspapi-blob) qui pointe vers une structure de [**\_ \_ service d’ensemble BTH**](/windows/desktop/api/Ws2bth/ns-ws2bth-bth_set_service) , permettant au client de fournir une structure spécifique à Bluetooth contenant un enregistrement SDP binaire construit par l’application. Si **lpBlob** est fourni à la fonction [**WSASetService**](/windows/desktop/api/winsock2/nf-winsock2-wsasetservicea) , tous les autres membres de la structure [**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw) , à l’exception de **dwSize nul** et **dwNameSpace** , sont ignorés. Pour plus d’informations, consultez [Bluetooth et objet BLOB](bluetooth-and-blob.md) . L’envoi d’un enregistrement SDP binaire est nécessaire dans de nombreux cas, car un nombre limité d’attributs SDP peut être converti à partir de la structure **WSAQUERYSET** , et les chaînes sont converties uniquement en encodage UTF-8 en langue par défaut.           | Si les structures de service de l' [**objet BLOB**](/windows/desktop/api/nspapi/ns-nspapi-blob) facultatif et de l' [**\_ ensemble \_ BTH**](/windows/desktop/api/Ws2bth/ns-ws2bth-bth_set_service) ont été fournies en entrée, ainsi que la version ulong et les valeurs de handle qui doivent être référencées par le **\_ \_ service d’ensemble BTH**, la version est mise à jour pour contenir la \_ \_ valeur de la version SDP de BTH pour le fournisseur Windows Sockets Bluetooth et le descripteur est requis pour supprimer l’enregistrement. |



 

> [!Note]  
> Pour supprimer un service, les seuls membres nécessaires de la structure de [**\_ \_ service de BTH**](/windows/desktop/api/Ws2bth/ns-ws2bth-bth_set_service) sont les membres **pSdpVersion** et **pRecordHandle** .

 

## <a name="related-topics"></a>Rubriques connexes

<dl> <dt>

[Bluetooth et WSAQUERYSET pour la consultation des appareils](bluetooth-and-wsaqueryset-for-device-inquiry.md)
</dt> <dt>

[WSAQUERYSET pour la recherche de service et Bluetooth](bluetooth-and-wsaqueryset-for-service-inquiry.md)
</dt> <dt>

[Bluetooth et objet BLOB](bluetooth-and-blob.md)
</dt> <dt>

[Bluetooth et WSASetService](bluetooth-and-wsasetservice.md)
</dt> <dt>

[**OBJET BLOB**](/windows/desktop/api/nspapi/ns-nspapi-blob)
</dt> <dt>

[**BTH \_ Set \_ service**](/windows/desktop/api/Ws2bth/ns-ws2bth-bth_set_service)
</dt> <dt>

[**\_informations CSADDR**](/windows/desktop/api/nspapi/ns-nspapi-csaddr_info)
</dt> <dt>

[**getsockname**](/windows/desktop/api/winsock/nf-winsock-getsockname)
</dt> <dt>

[**SOCKADDR \_ BTH**](/windows/desktop/api/Ws2bth/ns-ws2bth-sockaddr_bth)
</dt> <dt>

[**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw)
</dt> <dt>

[Windows Sockets](/windows/desktop/WinSock/windows-sockets-start-page-2)
</dt> </dl>

 

 